Three main analytical steps were adopted in sequence to estimate the excess risks of the association between AT and mortality in a nested caseecontrol study. All analyses were performed using STATA 10 and R 2.12.0. Step 1: Identifying the best lagged day of AT effects in the elderly cohort First, we used an incidence density sampling approach to generate risk sets for cases which were defined as subjects who died from all causes, cardiovascular or respiratory diseases (Richardson, 2004) . Each risk set included all subjects who were alive with the same length of follow-up as the case. The cases and controls were matched by the same month and year to account for effects of trends and seasonality. We then selected four controls at random from each risk set. The ratio of four controls for each case is recommended as the increase in power diminishes when there are more than four controls (Woodward, 2005) . Second, we quantified associations between mortality and daily mean AT at different lag days by conditional logistic regression adjusting for sex, smoking status, physical activity level, education level, housing type, health status, day of the week, influenza epidemics, and the 2003 severe acute respiratory syndrome (SARS) epidemic as categorical variables and age, body mass index (BMI), and PM 10 concentrations as continuous variables. Finally, we selected the best lagged day based on the model with the lowest Akaike's information criterion (AIC). The AT of single lag days from the same day (lag 0) to lag 6 days (lag 6) and cumulative lag days from the average AT of lag 0 and 1 days (lag 0e1) to the average of lag 0 to lag 6 days (lag 0e6), and the average of seven days between lag 7 and lag 13 days (lag 7e13) were examined. Step 2: Determining thresholds of AT for cold and heat effects on elderly mortality in the general population We used generalized additive Poisson regression allowing for over-dispersion in the model to determine the shape of the AT-mortality relationship in the general elderly population of Hong Kong (Wood, 2006) . Variations in trends and seasonality were fitted with natural cubic splines. We chose 5 degrees of freedom (df) per year for smoothing function of the time trends and 3 df for AT. Dummy variables were used to control the variations for days of the week, holidays, influenza epidemics and SARS epidemic. PM 10 concentrations were controlled for using a linear term in the model. The model which had the lowest AIC in Step 1 was selected to obtain the best lag to describe the AT-mortality relationship. We examined models with different lag days to identify thresholds for detecting effects of cold and heat stress due to their distinct patterns of the lag effects. The use of different lags to identify thresholds for cold and heat effects according to their distinct lag patterns could help to avoid underestimation of thermal stress effects (Braga et al., 2001; O'Neill, 2003) . Days with AT below the threshold for cold effects were identified as cool days and days above the threshold for heat effects were classified as hot days. Step 3: Assessing effects of AT on cool and hot days in the elderly cohort After identifying the thresholds of AT for cool and hot days obtained in Step 2, we divided cases and controls into two groups for cool and hot days, with cases defined as those who died on days in which mean AT exceeded the thresholds. We fitted conditional logistic regression models to estimate the effects on all-cause, CVD and RD mortality associated with every 1 C change in daily mean AT for each group. Same individual and environmental variables mentioned in step 1 were adjusted. To examine whether sex and BMI acted as effect modifiers in the association between AT and mortality, the dataset was further stratified according to categories of these factors. BMI of the subjects were categorized into three levels (kg/m 2 ): underweight (less than 18.5), normal weight (18.5e24.9) and obesity (equal to or higher than 25.0) for the stratified analysis based on the classification of weight by BMI for Asians (World Health Organization, 2000) . We estimated the excess risk of mortality for every 1 C change in AT for each subgroup separately. To enhance the accuracy and reliability of the estimates, we generated 100 different sets of controls for analysis of each model. Mean of estimated excess risks from the 100 samples were reported as the final results. Ethics approval for our study was obtained from the ethics committee of the University of Hong Kong and Hospital Authority Hong Kong West Cluster. 


Section:statistical methods