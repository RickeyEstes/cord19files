Simulations of transmission chains based on a known negative binomial offspring distribution were used to verify our ability to detect changes in R eff ( Figure S1 ). Each simulation produced a distribution of chain sizes for a pair of R eff and k values. Pairs of simulations having different values of R eff were identified according the methods in Section 2.2 of the main text. As data become more plentiful, the power to detect smaller differences in R eff increases. The power decreases slightly as k decreases from 1 to 0.25 because a higher degree of transmission heterogeneity (i.e. lower k) results in wider confidence intervals for the inferred value of R eff [15] . Figure S1 : Power of detecting a difference in R eff . Results from comparing two sets of simulations of chain size distributions that differ in the true value of R eff . The number of observed chains in each simulation varied as indicated by the x-axis. A baseline simulation always had R eff = 0.1 and k = 0.25 (left panel) or k = 1 (right panel). The comparison simulation had an R eff that was greater than the baseline by the amount indicated by the color bar. The y-axis denotes the power to detect a difference in R eff , or the proportion of simulation pairs for which a significant difference in R eff was detected (i.e. the best-fitting model had different R eff ). The curves have been smoothed to improve legibility. To ensure that our statistic for detecting a difference in R eff (as described in the methods section of the main text) was not overly sensitive (resulting in a high probability of Type I errors), we also compared simulations which had identical R eff ( Figure S2 ). Consistent with our expectations, comparisons of simulations having the same R eff show that we failed to reject the null hypothesis with 95% confidence. number of observations type I error in testing for differences in R eff 0.2 0.8 R eff Figure S2 : Type I error. Results from comparing two sets of simulations of chain size distributions that had the same true value of R eff . The true value of R eff is indicated by the color bar. The simulations all had k = 0.25 (left panel) or k = 1 (right panel). The y-axis denotes the type I error, or the proportion of simulation pairs for which a difference in R eff was falsely detected (i.e. the best fitting model had different R eff , or all of them did if there were multiple best-fitting models). The curves have been smoothed to improve legibility. 


Section:simulation-based validation of the method