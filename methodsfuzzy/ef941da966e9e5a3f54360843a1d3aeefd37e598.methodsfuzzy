Sequencing and assembly Total RNA was sequenced without an amplification step. Illumina (San Diego, CA, USA) Hi-seq (2 × 100) pair-end sequencing was carried out by TGAC (The Genome Analysis Centre) and at the University of Exeter on four samples from Highfield et al. (2009) ; Late June, Early October and Late October from GD1, and early October from GD2 (Supplementary Table  S1 ). The samples were originally collected from Devon in the southwest of England (Highfield et al., 2009) . Twenty asymptomatic bees were pooled for each sample before RNA extraction. RNA extractions were prepared as in Highfield et al. (2009) followed by a complementary DNA amplification step before sequencing. A Bioinformatics pipeline was developed to accommodate the large amount of variation found within the DWV species complex. First, the quality of the raw reads was verified using FastQC (Babraham Bioinformatics, Cambridge, UK). Samples were then converted from fastq to fasta using the fastq_to_fasta script that is part of the FASTX-toolkit (Hannon Lab) (http://hannonlab.cshl.edu/fastx_ toolkit/). To isolate the DWV complex sequence reads from the host and other contaminating sequences, the BLASTn (Altschul et al., 1990) tool was used. The reads were searched against a custom BLAST database containing the DWV, VDV-1 and KV genomes, with an e-value of 10e − 5. BLAST was carried out against Read 1 of the Illumina data. The ncbi-blast-parser perl script (http://www.bioinfor matics-made-simple.com/2012/07/ncbi-blast-parserextract-query-and.html) was then used to parse and read the top hit of the BLAST output. Next, 'sed' and 'awk' scripts were used to delete empty lines and the reads that contained 'nohits'. The corresponding BLAST hits were extracted from the Read 2 raw reads using QIIME (Caporaso et al., 2010) . The paired reads were balanced using a custom script written in R version 3.2.0 (R Core Team, 2015). Finally, the balanced DWV family reads were assembled using the Vicuna assembler that was developed to generate consensus assemblies from genetically heterogeneous populations, specifically RNA viruses. (Yang et al., 2012) . Vicuna contigs 4200 bp in length were imported into Geneious (Version 7.04, created by Biomatters, Auckland, New Zealand) and the 'Map to Reference tool' was used to align the contigs with the DWV and VDV-1 reference genomes. For several of the samples the Vicuna assembly yielded full-length contigs that covered the whole genome, whereas for others consensus scaffolds were created from two or more contigs. The ends of the contigs were then trimmed of any assembly or sequencing artefacts. A second novel variant was also assembled by Vicuna. In order to create a consensus sequence of the novel variant, the contigs from three samples were realigned against the DWV genome. Any contigs containing sequence other than the novel variant were removed. If a contig contained the novel variant as well as sequence belonging to the type A DWV genome because of recombination or in silico recombination, the type A DWV regions were trimmed and deleted. A consensus genome of the novel variant was created from these sorted and trimmed contigs. Accordingly, the same steps were carried out on the type A sequence in order to assemble the type A genome consensus from Devon. The DWV scaffolds were then aligned with fulllength genome sequences from the NCBI (National Center for Biotechnology Information) database using the MUSCLE alignment tool (Edgar, 2004) within Geneious and the full-length genome was obtained. Full genome comparisons were visualised in mVISTA (Frazer et al., 2004) . To quantify the number of reads attributed to each DWV variant using BLAST (Supplementary  Table S1 ), the novel Type C variant genome sequence was added to the custom DWV family database and the BLAST for each sample was carried out a second time. This allowed the Type C variants to be categorised correctly by BLAST rather than attributed to the closets hit to the three other reference genomes. To validate the quantification of reads attributed to each variant, the balanced read 1 and 2 BLAST hits were aligned competitively to three reference genomes using the 'Map to Reference Tool' within Geneious. Consensus genomes of type A and Type C were translated using the 'live annotation' tool within Geneious. Because of repetitive regions in the genome, assembly error took place in several sites, leading to an incomplete open reading frame. These assembly errors were corrected by using the Vicuna analysis tool to pull out individual reads covering these regions, and the correct sequence was determined. Finally, the RDP4 programme (Martin et al., 2010) was used to determine whether any recombination took place between the sequences. Assembled genomes are available from the European Nucleotide Archive under the accession numbers ERS657948 (type A) and ERS657949 (Type C). 


Section:materials and methods