To obtain the effective population size for the metapopulation model, we adapted the results of Wakeley & Aliacar [34] and Wakeley [35] assuming haploidy and the propagule-pool model [41] for colonization (equation (3.1)). To model changes in metapopulation dynamics over time, we used simple SI, SIS and SIR compartmental models (figure 1). For parameter estimation, we made the simplifying assumption that co-infection is negligible. In the case of the SI and SIS models, we were able to obtain analytical solutions for the effective population size using the following closed-form solutions for the proportion of susceptible hosts, S, as a function of time. For the SI model, For the SIS model, S ¼ b 1 S 0 À g þ gð1 À S 0 Þe Àðb 1 ÀgÞt b 1 S 0 À g þ b 1 ð1 À S 0 Þe Àðb 1 ÀgÞt ; I ¼ 1 À S: ð5:2Þ All parameter definitions are summarized in the electronic supplementary material, table S1. For the SIR model, a solution for S cannot be obtained analytically. However, assuming that the number of recovered individuals is initially zero gives the relationship This simplifies the system of differential equations in the SIR model to a single ordinary differential equation that can be solved numerically: dS dt ¼ b 1 Sð1 À SÞ þ gS logðSÞ: ð5:4Þ In the coalescent with demographic growth, the pairwise coalescence rate is the inverse of the effective population size, and calculation of the probability density of a genealogy under the coalescent model requires the calculation of the integrated coalescence rate [13] : ð5:5Þ (elsewhere we suppress the dependency on time to avoid cluttered notation). Assuming no co-infection (b 2 ¼ 0), we can write this integral as a differential equation dL dt ¼ 1 N e ¼ ð1 À S 0 þ g logðS 0 Þ=b 1 ÞS N 0 S 0 (1 À S þ g logðSÞ=b 1 ) : ð5:6Þ Because the effective population size is dependent on S, equations (5.4) and (5.6) define a system of differential equations to be solved together. We implemented this as an extension to BEAST [36] in JAVA using a fifth-order Cash -Karp Runge -Kutta method with adaptive stepsize control [47] . We also reimplemented the logistic growth function in BEAST because our parametrization for the SIS model uses N 0 , the effective population size at the present, rather than the carrying capacity. Example XML code and details of the Bayesian analysis are provided in the electronic supplementary material, text S1. 


Section:methods (a) epidemiological and coalescent models