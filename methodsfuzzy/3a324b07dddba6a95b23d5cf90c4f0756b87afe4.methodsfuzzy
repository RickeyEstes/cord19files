Rates of invasive pneumococcal disease were calculated using demographic data for Philadelphia County from the year 2000 US Census, as well as 2006 population estimates from the Bureau of the Census, with linear interpolation and extrapolation used to generate estimates for population by age and sex in other years [17] . We evaluated the seasonality of disease occurrence through construction of periodograms and autocorrelograms [15, 22] for weekly case counts. As yearly periodicity was observed, we estimated seasonal and year-on-year trends in IPD occurrence using Poisson regression models that incorporated sine and cosine oscillators, with 52 week (annual) frequencies (i.e., incorporated fast Fourier transforms) [7, 22] . Using these parameters, the expression for the expected number of case counts for a given week, E (Y) is given by: where cases is an autoregressive model term reflecting the cumulative case count in the month prior to case occurrence, (i.e., cases = ). The phase-shift of the composite waveform generated by combining sine and cosine components of the above equation can be approximated as the arctangent of β 2 /β 3 , and can be used to estimate the timing of peak disease incidence [22] . We also included model terms that controlled for longer term trends in incidence of invasive pneumococcal disease, which may have reflected the initiation of surveillance, the introduction of public funding for conjugate pneumococcal vaccination [12] , changes in medical diagnostic practices, or other long-term changes in real or apparent pneumococcal epidemiology. As yearon-year trends in disease occurrence reflected a non-linear increase in disease risk, we used models that incorporated both linear and quadratic yearly terms. The quadratic model term was statistically significant, but is difficult to interpret, thus we present our final Poisson model with separate linear yearly terms for the period from 2002 to 2003, and the period from 2004 to 2007 [23] . We evaluated the impact of environmental exposures on weekly IPD incidence by incorporating exposure variables into Poisson models both individually, and using a backwards elimination algorithm (with variables retained for P < 0.2 [24] ). To explore the possibility of effect modification by subject characteristics, we evaluated stratum-specific estimates of effect for age categories and genders. Heterogeneity of effects across strata was assessed using meta-analytic techniques, including both graphical inspection and calculation of meta-analytic Q-statistics [25] . We further explored the sources of between-stratum heterogeneity through construction of meta-regression models that estimate the contribution of group-level covariates to between-stratum variation in effects [25] . We used a case-crossover approach to evaluate acute (i.e., daily) associations between environmental exposures and IPD occurrence. This approach provides a means for evaluating the association between brief, transient exposures and rare outcomes. The design is characterized by "self matching", in that cases serve as their own controls. In the context of environmental epidemiology, a "case" is a day on which a case occurred, while a "control" is an appropriately selected day on which a case did not occur [6] . We used a time-stratified 2:1 matched case-crossover design in which hazard periods were defined as the reported date of IPD onset from Philadelphia County public health. Beginning on January 1, 2002 the person-time at risk was divided into three-week time strata. Control periods were chosen by matching the hazard period by day of the week within the stratum, and could both precede, both follow, or straddle the hazard period [26, 27] . Random directionality of control selection was used in order to avoid biases that can occur with unidirectional or uniform bidirectional control selection [26] . The 1-3 day incubation period of S. pneumoniae was used to estimate the lag days between acute environmental occurrence and case onset, or plausible effect period [28] . We also evaluated effects during the period immediately preceding incubation (i.e., 4-6 day lags) to evaluate the possibility that environmental conditions might affect risk via enhanced transmission of S. pneumoniae. We evaluated the effects of both raw environmental exposures, and quantile ranks within time strata through construction of conditional logistic regression models [24] . Analyses were performed using SAS version 8.01 (SAS Institute, Cary, NC) and Stata version 9.1 (Stata Corporation, College Station, TX). Both spectral decomposition and construction of autocorrelograms identified annual periodicity of infection, with peak incidence in mid-February (phase = 6 weeks) (Figures 1 and 2) . Strong statistical evidence for seasonal oscillation was obtained from Poisson regression models (P for seasonal oscillation < 0.001). A significant annual increase in incidence was seen throughout the study period, though this was more marked prior to 2004 (IRR per year 1.34, 95% CI 1.08 to 1.66) than subsequently (IRR 1.22, per year 95% 1.16 to 1.34) (Figure 3 ). We found no clear trends in the incidence of IPD or case-fatality in individual age groups, and no significant heteroge- 


Section:statistical methods