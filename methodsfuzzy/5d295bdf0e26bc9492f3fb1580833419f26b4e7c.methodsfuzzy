Our goal is to derive the critical surfaces of Eqs (2)-(4) from the equation driving the dynamics of the system, namely Eq (1). We do that by starting from a simpler scenario, and incrementally adding features, up to the full model. Specifically, the first step consists in solving the model with no differential degradation (ρ = 1), no contact heterogeneity, and with only one segmented variant (v = 1). In the second step we generalize the result to a generic v, and in the third one we allow for heterogeneous contacts. In the last step we add differential degradation. A numerical validation of the critical surfaces is carried out in S1 Text. ⌜wt⌟ and ⌜all⌟ are the only infectious compartments, with prevalence x 1 and x 2 , respectively. With neither differential degradation nor contact heterogeneity, Eq (1) reduces to By summing these equations, we find that the equation for the total prevalence This also follows from noticing that for v = 1 the total prevalence is also the total wt prevalence (see S1 Text). This means that the total prevalence behaves as a standard SIS, for which we know the epidemic threshold T 1 = {λ = μ}, and the equilibrium above it. In addition, we know that just above T 1 we are in the wt-phase. Hence, we have (z wt = 1 − μ/λ, x 2,eq = 0). Studying the stability of this equilibrium gives us T 2 . Since the equation for z decouples from x 1 and x 2 , it is convenient to study the system in (z, x 2 ). Studying the sign of the eigenvalues of the Jacobian matrix reduces to studying @ _ x 2 =@x 2 < 0 calculated in the equilibrium. This gives T 2 = {λ = 2μ/(1 + μ)}. The details of the calculation are reported in the S1 Text. We now generalize the previous result to an arbitrary v, while still assuming that all hosts have the same contact rate, that we can set to one with no loss of generality. Eq (1) simplifies to whose Jacobian matrix is where Λ ν(βσ) = Λ νβσ + Λ νσβ . Firstly, we note that for v > 1 the total prevalence, now defined as z = ∑ ν x ν , no longer behaves like an SIS, due to the presence of the compartment ⌜seg⌟. Indeed, one can show that, when summing over ν in Eq (1), the terms with Λ cancel out, as they pertain to interaction exclusively among infectious compartments, which by definition cannot change the total prevalence, and so all the contributions must cancel out. This is not the case however for the terms with Γ, so that the final equation is _ z ¼ ð1 À zÞ P b ðGxÞ b À mz, which does not decouple from x ν . Interestingly, despite this breaking of the SIS symmetry, which was crucial to solve the v = 1 model, we can still prove that the values of T 1 , T 2 found for v = 1 generalize to an arbitrary number of variants. We start from the first critical surface (T 1 ). We compute the Jacobian matrix of Eq (6) in the dfs, i.e., x β = 08β. We get J (dfs) = Γ − μ. We now argue that Γ, and therefore the Jacobian matrix, is upper triangular, thanks to the specific ordering of the compartments that we introduced. Γ νβ is the rate at which a susceptible becomes a ⌜ν⌟, upon contact with a ⌜β⌟. For this to happen (Γ νβ > 0), ⌜β⌟ must contain at least all the viral species ⌜ν⌟ contains. Hence, either β = ν (diagonal term), or β > ν. By the same reasoning, the diagonal terms are Γ ββ = λ φ(β) , where φ(β) is the number of viral species in ⌜β⌟, e.g. φ(⌜wt⌟) = 1, φ(⌜all⌟) = v+ 1. From these considerations, the spectrum of J (dfs) is {λ φ(β) −μ;8β}. Keeping in mind that λ < 1, we recover the first critical point: T 1 = {λ = μ}. Just above T 1 , ⌜wt⌟ is the only compartment with prevalence different from zero, hence it behaves like a standard SIS. Thanks to that we can compute Eq (6) in the wt-phase, and its spectrum. From that we find that the second critical surface is the same as for v = 1. The details of the calculation are in S1 Text. We now build on the previous results, by adding heterogeneous contact rates. We work in the widely-used degree-block approximation [41] [42] [43] [44] 57] , assuming the contacts among agents are represented by an annealed network in which we assign each node a degree sampled from a power-law distribution with exponent γ: p γ (k) = C γ k −γ , where C γ is the normalization factor. As customary, we assume γ > 2, so that the average degree is defined in arbitrary large populations. In the framework of annealed networks it makes sense to interpret k as a discrete number; one could also interpret it as a (continuous) coupling potential (either choice does not change the result found). We now directly compute the Jacobian of Eq (1), reported in Eq. (S.16) of S1 Text. The Jacobian is a matrix acting on a space which is the tensor product of the space of compartments, spanned by the Greek indices, and the space of degrees, spanned by the Latin indices. We can study its spectral properties on each space separately, using the previous results for the space of compartments. The full derivation is reported in the S1 Text. Differential degradation ρ > 1 changes the matrices Γ, Λ, as reported in the S1 Text. The derivation is then similar to the case with ρ = 1. Our model assumes that the transmission probability of one variant does not depend on the coinfecting variants. In reality, however, the number of viral particles a cell can produce in time is limited, and they are known to often spread in superinfection units. In S1 Text we investigate these aspects using a simple assumptions. We show that despite altering the specific values of the critical surfaces, they do not impact the qualitative behavior of the model. Data in Fig 3 are produced through stochastic spreading simulations. Starting with a population of N = 6000, we infected the hosts with wt and both segments (⌜all⌟ for v = 2), and let the virus spread. We used an adaptation of the Gillespie algorithm [58, 59] , to model both contacts among hosts, and contagion and recovery events. For each parameter configuration, we carried out 5000 simulations and kept only those reaching an endemic state other than the disease-free state, in order to discard instances of stochastic extinction, and focus only on the metastable equilibria which represent the attractors of the equations. We then used those simulations to compute prevalences and occurrence probabilities. Supporting information S1 Text. Detailed explanation of calculations and simulations. We provide a thorough explanation of the analytical findings. We start from only one segmented variant (v = 1) in Section 1, then generic v (Section 2), and subsequently incorporate contact heterogeneity (Section 3). In Section 4 we include differential transmissibility of segmented variants. In Section 5 we analytically derive the total prevalence of the wild-type form. In Section 6, we provide a numerical validation of the critical surfaces in the phase space. In Section 7, we derive the critical surfaces when accounting for limited viral production by host cells. Finally, in Section 8 we consider simple corrections to our model accounting for nonhomogeneous recovery rates, and nonindependent transmission probabilities. (PDF) 


Section:materials and methods