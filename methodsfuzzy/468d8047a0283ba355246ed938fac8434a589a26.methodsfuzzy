All molecular dynamics simulations used the program CHARMM (44) and classical interactions used the Charmm 36 all atom forcefield (45, 46) . Classical MD simulations took advantage of the CHARMM interface with OpenMM (47) . Initial structures for simulations of human Usb1 were based on the crystal structures solved here. The Usb1-UU starting model was created by aligning the WT structure bound to UMP (PDB ID: 5V1M) to the Usb1-H208Q structure bound to 5 -UU-3 and removing the UMP and Usb1-H208Q protein coordinates. The initial model for the Usb1-'UA(syn)' simulation was created by aligning the UA-bound H208Q structure with the wt-AMP structure, in which the adenosine is in the syn conformation and removing the coordinates for the 3 U and Usb1-H208Q protein. The starting model for the 'UA(anti)' simulation was generated from in silico integration of an adenosine onto an equilibrated structure derived from the Usb1-UU structure described above. H120 was modeled to be singly protonated and H208 was modeled as doubly protonated. The systems were initially equilibrated using classical MD, after which our general procedures for QM/MM simulations followed those we have used in our other recent studies of enzymes catalyzing phosphate cleavage (48, 49, 50, 51) . The systems were treated using the Generalized Solvent Boundary Potential (52) with a 25Å inner region. QM/MM link atoms were added to the sidechains of residues in the QM region (Supplementary Figure S2) . The QM region was treated at the DFTB3/3OB level (53, 54, 55, 56) and the MM region was treated with the same force field as the classical MD simulations. A FIRES potential (57) prevented exchange of QM and MM water molecules during the MD simulations. The total system had ca. 7000 atoms, nearly all of which were in the inner region; the QM region contained 137 atoms and a total charge of -1. 1-, 2-and 3D free energy surfaces (FESs) were calculated through multi-walker metadynamics simulations using the program PLUMED (58) interfaced with CHARMM. Metadynamics parameters differed slightly for different sampling goals, but in general, Gaussians of height 0.1 kcal/mol and width 0.1Å were deposited once every 200 timesteps (100 fs). For the 'classic' mechanism, three order parameters were subject to biasing potentials; these were the three antisymmetric stretches corresponding to: (i) O2 -H2 -NE2 H120 ('Nucleophile Deprotonation'), (ii) O2 -P-O5 ('Phosphoryl Transfer') and (iii) NE2 H208 -HE2 H208 -O5 ('Leaving Group Protonation'). For the 'triester-like' mechanism, the nucleophile deprotonation coordinate was replaced with the coordinate (59) to bias the center of excess charge, where 2 -O was the donor, a non-bridging oxygen was the acceptor and NE2 H120 served as a proton shuttle. The other two coordinates were unchanged. Various trajectories ('walkers') to sample these coordinates were spawned either from equilibrium simulations or from other metadynamics simulations. For example, walkers for the three-dimensional (3D) metadynamics were taken from preliminary 1D and 2D simulations. The 3D simulations typically used 300-500 walkers, each of which was sampled for 0.5-1 ns. The final 3D PMFs, therefore, are the result of ca. 0.1-0.2 s of QM/MM sampling (0.2-0.4 × 10 9 timesteps) and constructed from ca. 10 6 Gaussians. Solvent isotope effects were calculated using a path-integral free energy perturbation method (60) . Additional details of all methods are available in the Supplementary Data. 


Section:computational methods