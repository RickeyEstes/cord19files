For comparison of bottleneck estimates with existing methods we implemented the exact version of the beta-binomial inference scheme of Leonard et al. [12] . The likelihood function for site i was defined as where N T is the bottleneck size, P beta-bin is the beta-binomial probability mass function, x A;SL i;minor is the number of recipient observations for the minor allele at site i, N A;SL i is the total number of recipient observations for site i, i.e. N A;SL i ¼ x A;SL i;minor þ x A;SL i;major , P bin is the binomial probability mass function, and q B;SL i;minor is the donor frequency for the minor allele at site i. We note that the beta-binomial is undefined for j = 0 and j = N T and define j = 10 −10 and j = N T −10 −10 respectively in these cases. The original authors did not discuss this further. We did not make use of the cumulative version of the likelihood function as we avoided the problem of variant calling by fixing the number of required polymorphic loci when simulating data. The total likelihood for each bottleneck value was computed as where n sites is the number of variant loci. Bottleneck inference was defined as the bottleneck associated with the largest likelihood value. 


Section:implementation of leonard et al. method