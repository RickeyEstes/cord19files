Sample acquisition. Samples were obtained during a 2009 expedition of Sorcerer II detailed by Dupont et al. (19) . Briefly, 200 liters of seawater was collected, prefiltered (using a 200-m-pore-size Nytex net), and serially filtered using 3.0-, 0.8-, and 0.1-m-pore-size impact filters. Virus-sized samples were obtained through concentration of the water produced from 0.1 m-pore-size filters via tangential flow filtration (Pellicon Maxi Cassette; Millipore) (50 kDa). Filters were stored in DNA extraction buffer with RNAlater (Life Technologies, Inc.). Viral concentrates (VCs) had 20% molecular grade glycerol added. All samples were frozen onboard and transferred on dry ice. DNA isolation and preparation of sequence libraries. For detailed methods describing DNA extraction from GOS-derived filters, see reference 92. For details of the preparation of viral DNA from VCs for sequencing using 454 GS FLX titanium sequencing platform, see the methods described by William-son et al. (9) . Briefly, environmental genomic DNA was sheared using a Covaris instrument and size selected to 500 to 800 bp. Linkers were ligated to DNA fragments, and amplification was performed using 15 cycles in triplicate. Sequencing adaptors were ligated to the amplified products and purified using AMPure beads prior to sequencing using a 454 GS FLX titanium sequencing platform. Viral metagenomic sequences were trimmed for both the linker and adaptor. Artificial replicates were screened for and removed using the approach described by Gomez-Alvarez et al. (93) . To screen for cellular contamination, viral particles were subjected to DNase treatment (3ϫ) and RNase treatment (1ϫ) followed by PCR using universal primers for 16S ribosomal DNA (rDNA). Once sequencing was complete, metagenomic data were screened to identify genome equivalents using hidden Markov model (HMM) searches of conserved genes (most of which were single-copy genes; see reference 32 for more information on bacterial genome equivalents). Metagenomic viral library assembly. Sequences from virus-size samples (0.1 m to 50 kDa) derived from 454 metagenomic sequence libraries were assembled together using a Newbler assembler (Roche). Prior to assembly, sequences of low complexity were identified and removed using DUST (82) . The sequences were first assembled using Newbler with default parameters, including the minimum identity (-mi) set at 86 and the -rip option, which outputs each read into only one contig. Following the initial assembly, downsampling or bioinformatics normalization was performed as previously described by Allen et al. (83) . Briefly, areas of the genome with high coverage were randomly reduced to within 2 standard deviations (SDs) of the average contig coverage. These methods were implemented to increase assembly metrics, i.e., fewer contigs, greater length, and greater N50 scores. Metagenomic sequence annotation. Sequencing reads from the filters were processed as previously described. Virus-size fractions were first processed through FragGeneScan (84) for open reading frame (ORF) calling using the 454-10 train file, given an approximate error rate of 1%. Taxonomic profiles were generated using the Automated Phylogenetic Inference System (APIS), which generates phylogenetic trees from top BLASTp hits (E value, Յ1eϪ9) from PhyloDB. Subsequently, the closest relative becomes the taxonomic lineage for the query (environmental) sequence annotation. The use of APIS for metagenomic sequences has been previously described (9, 85) . Additional functional information was derived from HMM, KEGG, and GOS cluster searches. Photosystem genes were identified using BLAST (E value, Յ1eϪ3) against a boutique database consisting of cyanophage reference sequences from PhyloDB for psaA, psaB, psaC, psaD, psaE, psaE, psaF, psaJ, psaK, psbA, and psbD. PhyloDB Total mRNA transcriptome libraries were made with a ScriptSeq v 2 RNA-Seq kit (Illumina Inc., San Diego, CA) using subtractive hybridization of rRNAs with antisense rRNA probes (94) recovered via PCR using 0.1-, 0.8-, and 3.0-M-pore-size filters and a mixture of DNA obtained from the thirteen Baltic sampling stations comprising this study. A 250-ng volume of total community RNA was used for subtractive hybridization. Multiple rounds of subtractive hybridization of rRNAs were used to obtain at least 30 ng of rRNA-depleted total RNA. The quality of the rRNA-depleted total RNA was analyzed on a 2100 Bioanalyzer with Agilent RNA 6000 Pico kits (Agilent Technologies, Santa Clara, CA). A 5-ng volume of rRNA-depleted total RNA was used as an input for a SciptSeq v 2 RNA-Seq kit (Illumina Inc., San Diego, CA) following the protocol of the manufacturer. A total of 10 7 copies of ArrayControl RNA spikes (Life Technologies, Inc., Carlsbad, CA) were added to each sample prior to ScriptSeq amplification. AMPure XP beads (Beckman Coulter, Inc.) were used for cDNA and final library purification. Library quality was analyzed on a 2100 Bioanalyzer with Agilent high-sensitivity DNA kits (Agilent Technologies, Santa Clara, CA). The resulting libraries were subjected to paired-end sequencing via the use of an Illumina HiSeq system. For poly(A) mRNA transcriptomes, 0.8 g of total community RNA and 2 ϫ 10 9 copies of ArrayControl RNA spikes (Life Technologies, Inc., Carlsbad, CA) were amplified using TruSeq RNA library preparation kit v 2 (Illumina), following the protocol of the manufacturer with minor adjustments. Specifically, the fragmentation time was modified according to RNA quality. Library quality was analyzed on a 2100 Bioanalyzer with Agilent high-sensitivity DNA kits (Agilent Technologies, Santa Clara, CA). The mean size of the libraries was around 400 bp. The resulting libraries were subjected to paired-end sequencing via the use of an Illumina HiSeq system. Transcriptome assembly. Reads were trimmed for quality and filtered to remove primers, adaptors, and rRNA sequences using Ribopicker v.0.4.3 (86) . De novo assembly of Illumina HiSeq reads into contigs was accomplished with multiple rounds of assembly using CLC Assembly Cell (CLC bio) clc_novo_assemble. Samples were individually assembled, and ORFs were predicted on contigs using FragGeneScan (84) . Read counts for each ORF per each sample were obtained by mapping reads to predicted ORFs using CLC Assembly Cell (CLC bio) clc_ref_assemble_long. Transcriptome annotation. ORFs were annotated de novo for function via KEGG, KO, KOG, Pfam, and TIGRfam assignments. Taxonomic classification was assigned to each ORF using the reference data set PhyloDB (see "PhyloDB" above). Sequences from both the poly(A)-and random hexamer-derived libraries were pooled at the annotation step for site and size class. Further, pathogen annotation was conducted using literature searches of the best species/strain hit for evidence of infectivity of fish, shrimp, human, plant, or insect species. Virus-to-bacterium ratio and host diversity. Annotated metagenomic sequences were taxonomically binned into groups of viruses that infect bacteria based on similarity to known bacteriophage and bacteria using APIS. node50 is a measure of taxonomic richness derived from the distribution of core genes in a sample assigned to nodes in a reference tree and is calculated as the number of the most abundant nodes that account for 50% of the reads assigned to core genes in each sample. The mean pairwise distance (MPD) was calculated from a phylogenetic placement 16S rDNA tree (see reference 87 for methods), where MPD is the tree distance between all pairs of hits within a sample. To account for sample size, a normalized MPD (the standardized effect size MPD [sesMPD]) metric was used for determinations of bacterial diversity (88) (89) (90) . The sesMPD value represents the number of standard deviations (SDs) by which a value for a sample deviates from the average for samples of the same size taken from the entire fraction. The calculation for determining sesMPD is as follows: sesMPD ϭ [(observed MPD) Ϫ (mean randomized MPD)]/(SD of randomized MPD). One limitation of the MPD metric is that some samples have many more hits within the bacterial tree and, thus, more pairs; therefore, MPD can be skewed by sample size. The sesMPD is used to attempt to normalize these numbers by comparing the MPD of a sample with the average MPD from randomized subsampling (100ϫ for these data) of the same size taken from all the samples mixed together. All correlation coefficients were calculated using cor.test (R; http://www.R-project.org) using the Spearman method and one-sided P values. For cyanobacteria/cyanophage comparisons (Fig. 3) , bootstrap analysis (1000 iterations) was performed to confirm that the positive and negative correlations were within the 90% confidence interval. Accession number(s). The metatranscriptomic data were deposited at NCBI GenBank SRA under BioProject accession no. PRJNA320636. The metagenomic libraries were deposited in iMicrobe under project code CAM_P_0001109. 


Section:materials and methods