Samples and marker viruses for spiking samples. Marker viruses for spiking samples (Table S1 of Supplementary material 1) were obtained from the CSIRO-Australian Animal Health Laboratory and the Elizabeth Macarthur Agricultural Institute. All virus stocks were stored at −80 °C. Human stool samples collected from 3 children aged 3 months (sample ST4), 18 months (ST5) and 4 years (ST6) from Geelong were also used to test the optimised method. The study involving these samples here were performed in accordance with relevant guidelines and regulations and was deemed negligible or low risk by the Barwon Health Human Research Ethics Committee and therefore exempt from full committee review (project no: 17.119). The MUD faecal sample was selected for spiking with the marker viruses. A non-spiked MUD sample acted as control for the optimisation of the best protocol for metagenomics of viruses. All faecal samples were then processed according to the optimised protocol without any spiking. The detailed steps of the final optimised protocol are given in the supplementary material (Supplementary material 3) . However, the steps in the protocol are briefly described below. Real-time polymerase chain reaction (PCR) assays for marker viruses. We initially optimised real-time PCR assays for the marker viruses to detect and quantify them during the virome detection and characterisation protocol development. Virus-specific quantitative assays were either developed or retrieved from the literature (see Table S2 of Supplementary material 1 for details), and quantity required to spike the faecal samples assessed based on these assays. All quantitative assays for RNA viruses were carried out using Power SYBR ® Green RNA-to-CT ™ 1-Step kit (Thermofisher Scientific) using the following conditions: 48 Virus enrichment from samples. Removing other impurities such as host cells, bacteria, food particles and free nucleic acids from the faecal samples and enriching for virus particles followed by nucleic acid extraction is the first step in metagenomics of viruses. For this purpose, we tested different enrichment techniques using various biophysical methods 6, 37, 38 . Six method variations from A to F with a different combination of virus enrichment techniques using various biophysical methods were carried out (Fig. 1 ) on the spiked MUD faecal sample. We took the already tested protocol called the NetoVIR 6 as our starting method for virus enrichment and designated it as 'variation C' . We used the MUD faecal sample and incorporated two additional potential enrichment steps to this method, being detergent treatment (variation A & B) and ultracentrifugation (variation A, D & F) and also tested filtration using 0.45 µm filters (variation E & F) as described, but not recommended as optimum on their mock community, by the authors of NetoVIR 6 . This enabled us to evaluate, compare and develop an optimised protocol for virus community analysis from a biological sample. The combination of biophysical enrichment techniques that maintained the maximum number and levels of marker viruses was selected to proceed for cDNA synthesis, amplification, library preparation and NGS. The method which then gave the maximum number and obtained high-quality NGS reads of the marker viruses was then selected as the final method to conduct metagenomics of project samples for the detection of viruses. Sample preparation. A 1:10 dilution of the bird and human faecal samples were prepared using sterile phosphate buffered saline (PBS). The samples were vortexed thoroughly prior to downstream processing. Homogenization (During method optimisation stage). A volume of 2 mL of the faecal samples were taken for variations involving ultracentrifugation, while for other variations only 500 µL was taken to maximise handling efficiency and protect virus nucleic acid during extraction. Homogenization was carried out using TissueLyser II homogenizer (Qiagen) at 25 Hz for 2 min. Homogenization (After method optimisation). A volume of 2 mL of the faecal samples were taken for homogenization. After homogenization, the sample was divided into two, one tube containing 1725µL which was processed according to Variation D and another containing 250 µL which was processed according to Variation C. Detergent Treatment. To the homogenised sample of variation A and B, 0.25% (vol/vol) Nonidet P-40 detergent was added. It was centrifuged at 10,000 rpm for 30 min at 4 °C, and the supernatant was collected and processed downstream. Centrifugation. The samples were centrifuged at 17,000 g for 3 min at room temperature, and the supernatant was collected for downstream processing. Filtration. The samples were filtered through 0.8 µm polyethersulfone (PES) spin filters at 17,000 g for 1 min or until all of the sample had passed through the filter. The filtrate was taken and processed downstream. During method optimisation stage, the spike MUD faecal sample under variation E and F were then filtered through 0.45 µm PES syringe filters, and the filtrate processed downstream. Ultracentrifugation. The samples of variation A, D and F were then ultracentrifuged using a Beckman Coulter Airfuge Ultracentrifuge at 178,000 g for 1 hour (30 psi for 1 hour) at room temperature. The supernatant was discarded, and the pellet was suspended in 130 µL of sterile 1XPBS. Nuclease treatment. To 130 µL of the sample, 7 µL of 20 × buffer (1 M Tris (pH8), 100 mM calcium chloride, 30 mM magnesium chloride), 2 µL of benzonase nuclease (Purity > 90%, Millipore) and 1 µL of micrococcal nuclease (New England Biolabs) was added. After mixing gently, the sample was incubated at 37 °C for 2 h. The nuclease reaction was stopped by adding 3 µL of 500 mM ethylenediaminetetraacetic acid (EDTA). Virus nucleic acid extraction. Virus nucleic acids were extracted using the QIAamp Viral RNA Mini Kit (Qiagen), importantly without adding any carrier RNA. Both DNA and RNA virus nucleic acids were extracted using this kit. The quantity of the isolated nucleic acids was determined using Nanodrop and in selected cases a Bioanalyzer, however, the quantity of extracted nucleic acids was as expected found to be very low after the enrichment and nuclease treatment process. Next-generation sequencing. Virus nucleic acids extracted from the spiked MUD faecal sample that undergone variations C, D, E and F were processed downstream as these methods showed presence or detection of all spiked marker viruses. Other samples were also processed as described below. Extracted virus nucleic acids were subjected to cDNA synthesis, amplification and primer removal using SeqPlex RNA Amplification Kit (Sigma) from all the samples according to the kit instructions. An initial RNA denaturation step of 95 °C for 3 min followed by placing the sample in −20 °C cold ethanol was carried out just before cDNA synthesis to ensure the denaturation of the nucleic acids of any double stranded RNA viruses. The quantity and quality of the amplified product were checked using the Bioanalyzer. Library preparation was carried out using Ion Plus Fragment Library Kit (Thermo Fisher Scientific), Ion Xpress Barcode Adapters 1-96 Kit (Thermo Fisher Scientific), Agencourt AMPure XP kit (Beckman Coulter) and Ion Library TaqMan ™ Quantitation Kit (Thermo Fisher Scientific). A volume of 20 µL of the cleaned product was used for end repair using the end repair enzyme in Ion Plus Fragment Library Kit. The sample was then purified using Agencourt AMPure XP kit at a 1.8X sample to bead ratio and eluted in 25 µL of Low TE buffer. Following elution, barcoded libraries were prepared using Ion Plus Fragment Library Kit and Ion Xpress Barcode Adapters 1-96 Kit as per the kit instructions. A 1.5X sample to bead ratio of the Agencourt AMPure Kit was used to purify the library. Then it was eluted in 20 µL of Low TE buffer. Quantification of unamplified libraries was performed as per the protocol from Ion Library TaqMan ™ Quantitation Kit using QuantStudio ™ 6 Flex Real-Time PCR System. Based on the concentration estimated, the dilution that resulted in a concentration of ~100 pM was then calculated and made. Libraries were then pooled prior to loading onto Ion 530 Chips using the Ion Chef Instrument. Following template preparation, the chips were run on the Ion Torrent S5XL System (Thermo Fisher Scientific) as per company protocols. NGS and associated reactions were performed at the Geelong Centre for Emerging Infectious Diseases (GCEID), Geelong, Victoria, Australia. We ran NGS for the spiked MUD faecal sample for the variations C to F only once and generated around 3.4 million reads. Approximately 4 million reads were generated for the non-spiked MUD faecal samples on the first run during which it partly acted as a control, and 7 million reads generated for the MAD faecal sample. For further analysis, the MUD and MAD faecal samples were rerun, and about 9.5 and 7.1 million reads were generated respectively. However, NGS for the human samples were run only once as it was a demonstration of the optimised protocol only and about 7.1 million reads were generated. Next generation sequence analyses. Although the NGS data provided an insight into the virome of the bird faecal samples, we narrowed our focus to virus sequences that were somewhat similar to already known viruses, in most cases had good quality and quantity NGS reads, could serve as examples of the utility of the method, and/or were of interest from a virological point of view. All available virus sequences were downloaded from the NCBI GenBank genetic sequence database (May 2017), and a local BLAST database created. Bacterial plasmid sequences were downloaded from the NCBI Reference Sequence Database (RefSeq) repository and 16 S, 18 S, 23 S 25 S, 5 S and 5.8 S ribosomal sequences were downloaded from GenBank. These were used to create plasmid and ribosomal BLAST databases respectively. Virus sequences from the NCBI RefSeq database were downloaded and queried against the plasmid and ribosomal RNA databases using a megablast query and an e-value cut-off of 1 × 10 −10 . Any virus sequences which matched either plasmid or ribosomal sequences were removed, and the remaining virus sequences used to create a reference sequence virus BLAST database. The BLAST package version 2.6.0 from NCBI was used to create the local databases and perform the database queries. A BLASTN query was performed on the reads from each sample against the initial virus database with an e-value cut-off score of 1 × 10 −3 . A BLASTN query against the virus reference sequence database was performed with an e-value cut-off of 1 × 10 −10 . A TBLASTX query against the virus reference sequence database was performed with an e-value cut-off of 1 × 10 −10 . BLAST query results files were converted into spreadsheet files, sorted by virus matches, and a list of potential virus targets created for each sample. The list was then manually inspected to identify viruses of interest. Mapping of sequence reads was performed against reference genomes of the viruses of interest using TMAP plugin on the Ion Torrent server. The full or partial consensus sequences of the viruses were obtained from TMAP using Integrative Genomics Viewer software (IGV) (Broad Institute, MA, USA). Consensus sequences were generated from mapped sequences with a mapping quality score of 20 or higher and a coverage depth of at least 3. AssemblerSPAdes 5.6.0 plugin on the Ion Torrent Server was used to generate contigs from the sequence reads of each sample. The contigs were queried against the virus reference sequence database using BLASTN and TBLASTX to identify virus sequences as described above. Contigs were then used as references in TMAP and trimmed to regions with a mapping quality of 20 or higher and a coverage depth of at least 3. The contigs of deltacoronavirus from the MAD faecal sample and selected viruses from the human samples were then selected for more in-depth analysis using MEGA software 63 Phylogenetic analysis of selected virus sequences. Among the identified viruses, 10 viruses which provided good quality and coverage of the NGS reads mapped to NCBI virus genomes as references and also covered the different virus genome types (dsRNA, ssRNA, dsDNA and ssDNA viruses) were selected for more detailed analysis. For these viruses, NGS reads were further analysed using MEGA software 63 as previously described in our laboratory 64, 65 . To understand phylogenetic relationships among the virus sequences, they were compared to the NCBI database using nucleotide BLAST (Basic Local Alignment Search Tool) 66, 67 and aligned using Clustal-W 68 and some cases using Clustal-W (Codons) or Muscle using the MEGA 6 or 7 software 63, 69 . Then the sequences were manually trimmed to put them in frame. Maximum Likelihood phylogenetic analyses were conducted using the MEGA 6 or 7 software 63, 69 , and the best model for generating a phylogenetic tree was determined (data not shown). The robustness of different nodes was assessed by bootstrap analysis using 1000 replicates for nucleotide alignments and 500 replicates for amino acid alignments. The distance between the branches based on the number of nucleotide differences was calculated using the same software. The "ribosomal activity microbiome" detection. Reads  


Section:materials and methods