The multi-scale analysis of TIPs and HIV-1 is built upon previous data-driven models [12, 19] and is composed of three constituent ordinary differential equation models describing dynamics at different hierarchical scales: (i) among a population of host individuals ('population level') (ii) within host individuals ('individual patient') (iii) within infected host cells ('intracellular'). The multi-scale model specifies mechanistic links between each scale and the next scale of organizational complexity (intracellular R in vivo R population level). The population-level TIP model is a simplified version of a riskstructured model constructed from UNAIDS field-data collected from antenatal clinics in Malawi [12] , which includes a riskstructure formulation with four distinct sexual-activity classes (SACs) and which we refer to as the 'Baggaley model'. Individuals are classified as susceptible (S), HIV infected (I), susceptible to HIV but infected with TIP (S t ), dually infected with HIV and TIP (I d ), as an AIDS patient with wild-type virus (A w ), or as a dually infected AIDS patient (A d ). Individuals in all disease-states are divided into SACs in accordance with field data (indicated by subscript i), except that all individuals in the A w class are assumed (as in [12] ) to have sexual contacts at the rate corresponding to the lowest risk group (SAC 4) owing to their poor health. The model equations are as follows: Parameter definitions, values, and corresponding references are shown in Table S1 in Text S1. The transmission probabilities per partnership are denoted b Y X where Y represents the disease state of the source of the infection, and X represents the viral strain (which is wild-type HIV, denoted X = W, for the vaccine model). The perpartnership transmission probability b I W (describing transmission of wild-type HIV by individuals in the I disease state) is set to agree with the weighted average of the Baggaley model [12] and b A W is the per-partnership probability of wild-type HIV infection originating from an AIDS patient, and is set following the Baggaley model [12] . Consideration of alternative parameterizations of the viral load transmission curve did not qualitatively affect the results (see Text S1). The parameters b I W and c 1 are static parameters that represent the transmission probability and the duration of the asymptomatic phase of individuals infected with only wild-type virus. In contrast, to describe quantities that depend on the specific design of the TIP, such as: (i) transmission probabilities, and (ii) the duration of the asymptomatic period, functions are used in place of parameters. These functions are calculated based on measured correlations between transmission, disease progression, and viral load [25, 26] where viral load is predicted from the in vivo TIP model (see Text S1). For example, the transmission probabilities in the presence of TIP and the duration of the asymptomatic phase in dually-infected individuals in the TIP population models are represented by functions of steady-state viral load (i.e. viral set point) as predicted by the in vivo model (see Table S3 in Text S1 for a description of the transmission-probability functions). The function c 2 V รฐ ร is used to compute the duration of the asymptomatic phase in duallyinfected individuals, and is also calculated in Text S1. Contacts between individuals in the TIP population model are weighted by statistically independent transmission probabilities (b) which are calculated from steady-state HIV and TIP viral loads from the in vivo model (see Text S1 section: 'Calculation of Transmission-Rate Function'). There are six distinct transitions between infection classes in the TIP population model (see Table  S3 in Text S1 for details). Briefly, contact between two individuals is represented by a contact function that considers asymmetric mixing of individuals among the four SACs: This contact function describes an individual in disease state X (and SAC i) becoming infected by an individual in disease state Y. The subscript j denotes SAC j, c j is the average number of sexual partners per year in SAC j, and N j is the sum of all sexually active individuals in SAC j. In the contact function, e is the degree of assortative mixing with e~1 corresponding to entirely assortative mixing and e~0 corresponding to entirely random mixing. The first term inside the brackets of the contact function describes assortative mixing in which infected individuals are encountered in proportion to their prevalence in SAC i. The second term describes random contacts in which infected individuals are encountered in proportion to their contribution to all of the sexual contacts being made in the entire population. We set the mixing parameter e equal to 0.37, as estimated in [12] . Simulation of the TIP population model is conducted as follows: the Baggaley model is allowed to reach steady-state and then a TIP is introduced to 1% of all individuals without any targeting to high-risk classes. Similar benefits were obtained using much more restrictive initial conditions (e.g. utilizing TIP as a therapy and targeting TIP to ,1% of only I and A w individuals in the least active SACs-SAC 3 and SAC 4-generates similar results to Figure 2 ). Behavioral disinhibition is simulated as in [49] by increasing the contact rates c for all SACs and number of AIDS deaths averted by the vaccination campaign is defined as: AIDS deaths averted = (AIDS deaths during 100 years of epidemic without treatment) -(AIDS deaths during a 50 year epidemic followed by 50 years of treatment). Vaccine and ART models use the same risk structure as above and are presented in Text S1. A complete list of model parameters and state variables are presented in Tables S1, S2, S3, S4, S5, S6, and S7 in Text S1. All numerical simulations were performed in Mathematica 7.0. 


Section:materials and methods