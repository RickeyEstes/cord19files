Due to the huge number of available binding site comparison algorithms [5] , a large-scale analysis of all methods is beyond the scope of this article. We have therefore restricted the evaluation to a small, but still diverse subset of promising algorithms. These were derived from an analysis of successful applications within medicinal chemistry projects [5] . A comparison of web server-based tools became infeasible due to the number and size of analyzed data sets, so we restricted our evaluation to standalone tools. The methods analyzed herein and their fields of utilization are summarized in Table 1 . Intriguingly, the success of nearly all of those studies resulted from the use of binding site comparison as part of a workflow combining different Table 1 . Summary of the methods analyzed in the present work and their respective fields of successful application. residue-based Cavbase [20, 21] protein-ligand interactions [32] , virtual screening [33] , evolutionary relationships [34] , drug repurposing [35] available from the CCDC (https://www.ccdc.cam.ac.uk/) RAPMAD [31] (similar to Cavbase, histogram-based) available from the CCDC (https://www.ccdc.cam.ac.uk/) FuzCav [36] protein-ligand interactions [37] upon request (http://bioinfo-pharma.u-strasbg.fr/labwebsite/ download.html) PocketMatch [24] function prediction [38] , polypharmacology [39] , evolutionary relationships [40] download (http://proline.physics.iisc.ernet.in/pocketmatch/) SiteAlign [18] protein-ligand interactions [37, 41] upon request (http://bioinfo-pharma.u-strasbg.fr/labwebsite/ download.html) SMAP (based on SOIPPA [42] ) [43] polypharmacology [44] , drug repurposing [45, 46] download (http://compsci.hunter.cuny.edu/~leixie/smap/smap. html) TM-align [27] drug repurposing [47] download (https://zhanglab.ccmb.med.umich.edu/TM-align/) surface-based ProBiS [48] function prediction [49] , off-target prediction [50] download (http://insilab.org/probis-algorithm/) VolSite/Shaper [23] protein-ligand interactions [37] upon request (http://bioinfo-pharma.u-strasbg.fr/labwebsite/ download.html) SiteEngine [51] protein-protein interactions [52] download (http://bioinfo3d.cs.tau.ac.il/SiteEngine/) SiteHopper [25] evolutionary relationships [53] OpenEye, available to academic users (https://www.eyesopen.com/sitehopper/) A closer examination of the Spearman's Rho correlation coefficients (Table 4) shows that the SMAP and SiteHopper scoring schemes are best suited to correlate the degree of physicochemical dissimilarity with the final score. For the interaction-based methods, KRIPO led to the clearest correlation between the number of substitutions and the score. Consequently, the application of these tools might offer an opportunity to correlate ligand affinities with binding site similarities, e.g. for protein kinases [68, 77, 78] . A clear differentiation between minor dissimilarities is an essential necessity for such analyses and the abovementioned tools might be helpful to reliably rank binding sites according to their similarities. However, if a robust method is needed that should not be influenced by minor dissimilarities, one of the other tools should be used. A potential application is the elucidation of unobvious binding site similarities, as for example shown for SiteAlign [41] , ProBiS [49] , and KRIPO [57] . Examples for such unapparent similarities are given in the last Results section. Taken together, the results indicate that several residue-based, surface-based tools and the interaction-based tool KRIPO are best suited to accurately score similarities between binding site pairs with minor modifications. Depending on the desired outcome (identification of minor dissimilarities or the identification of only moderately similar sites), the most suitable method should be chosen with care. Kahraman data set. A commonly analyzed data set for the evaluation of binding site comparison algorithms is the data set of Kahraman and co-workers [63] . It contains several different cofactor sites and small molecule binding cavities (S7 Table) . The structures were originally assembled to assess the assumption that ligand shape and binding site shape are related. It was concluded that differently shaped binding sites bind the same ligand, but that shape complementarity might be a significant driver for ligand recognition. We used this data set to find out about the impact of binding site features, interaction patterns, and binding site shape on the recovery of protein binding site pairs binding to identical ligands. One problem with this data set occurs during comparisons. Some of the tools failed to process the much smaller phosphate binding sites due to the low number of interactions or binding site residues involved. To analyze the impact of these binding sites on the final outcome, two evaluation steps were conducted: the analysis of 100 vs. 100 structures (S8 Fig) and the analysis of 80 vs. 80 structures (with excluded phosphate binding sites, Fig 8) . IsoMIF, Site-Hopper, and KRIPO significantly outperform most of the remaining tools. This tendency is less obvious when omitting the phosphate binding site from the analysis. Even similarities between the phosphate binding sites can be identified based on common geometric binding site properties and a high number of positively charged residues (Fig 8) . While the performance of residue-based tools is poor, that of surface-and interaction-based methods looks more promising. The interaction-based method KRIPO clearly outperforms all residue-and surface-based methods except SiteHopper and shows a high early enrichment. The early EFs of IsoMIF and KRIPO are the highest for all interaction-based methods if all 100 structures are considered (S8 Fig). Together with SiteHopper, IsoMIF is also the tool with the highest AUC for the binding site pairs of this complete set. This is not unexpected as the tool was validated on and probably optimized for these structure pairs (S1 Table) . A preliminary conclusion that can be drawn from this analysis is that a combination of surface-and interaction-based methods might be the key for the detection of binding site similarities between otherwise unrelated proteins. The similarity matrix of the all-against-all comparison for IsoMIF and SiteHopper underlines this finding (Fig 9) . Both methods do not only successfully differentiate between active and inactive pairs, but they are also suitable for clustering binding sites according to the bound ligands. Barelier data set. A recent publication by Barelier and co-workers [64] focused on similarities and differences between binding sites of unrelated proteins binding to identical ligands (in one case similar ligands). The authors screened the PDB for identical ligands, but included some pre-filtering steps: cofactors as well as ligands found in at least 15 complexes, with a molecular weight above 500 g/mol, or less than 10 non-hydrogen atoms were excluded. The resulting 62 pairs of protein-ligand complexes were classified and divided into three classes according to the similarities of ligand interactions: similar interactions of the ligands with similar protein functionalities (class A), similar interactions of the ligands with different protein functional groups (class B), and different functional groups of the ligands interacting with the proteins (class C). The calculation of per atom van der Waals and electrostatic interaction energies per ligand atom and their subsequent normalization enabled this detailed comparison of ligand-site interactions. Protein-ligand complexes of class A were used as active pairs in our analysis of all 62 binding site pairs. Due to the small number of protein pairs, EFs for 1.6%, 8.1%, 16.1%, 32.3%, 48.4%, 64.5%, and 80.6% of screened data set were calculated. The results are given in Fig 10. The ROC curves indicate a random ranking of active and inactive pairs for all methods analyzed herein. A significant differentiation between the tools' AUC values is only possible in a few cases (S25 Table) and the data set size precluded the decision for a suitable tool. The performance improvements using more appropriate scoring measures are also negligible for this data set. Based on the per atom score analysis of Barelier et al. [64] , one might expect that the ligands nicely overlay for high scoring pairs of binding sites. The underlying binding site alignments of class A pairs were therefore analyzed for tools with a high early enrichment and enable the visualization of the underlying match (Cavbase, SMAP, TM-align, ProBiS, and VolSite/ Shaper). Fig 11 shows the binding site alignments for some high-scoring site pairs. The bestscored Cavbase match reflects an acceptable overlay of captopril bound to angiotensin-converting enzyme and leukotriene A4 hydrolase. The match between these binding sites was also the highest-scoring of all active pairs for TM-align. A good superposition of the bound identical ligands could be achieved. The second highest ranked true positive match yielded a superposition with poorly aligned ligands. The SMAP alignment of the class A pair with the highest score does not superpose the ligands in a satisfactory manner. Nevertheless, it is obvious that the tool was able to identify residue-based binding site similarities. A closer look shows that the residues taken into account for comparison are rather broadly distributed across the proteins providing a possible explanation for the unsatisfactory superposition. Only one significant (according to the expectation values) match was found by ProBiS for the binding sites of the abovementioned captopril binding proteins with a good agreement of the ligand atom positions in the alignment. Shaper-derived alignments also do not provide perfect alignments of ligand atoms for the best-scored hits, although ligand moieties with a similar physicochemical nature overlap. These results indicate that a visual inspection of the best ranked binding site pairs is a crucial step to assess the significance of the identified matches. Binding site similarity can only be a reasonable explanation for the binding of identical or similar ligands if the corresponding ligand atoms overlap in the superposition. Sturm and co-workers analyzed the chemical nature of promiscuous ligands. Based on an analysis of the sc-PDB [65] the authors named quinone (PDB ligand-id QUE) as a super-promiscuous ligand [37] . As depicted in Fig 11D, each ligand interacts mainly via hydrophobic interactions with various cavity residues. In the binding site of the structure with the PDB ID 4hki, the ligand is engaged in two additional hydrogen bond interactions with the protein backbone. Given these observations, the question arises whether binding site comparison is the method of choice for such predominantly hydrophobic cavities. As cofactors and ions were taken into account for the comparison of interactions by Barelier et al. [64] , we included them to assess their impact on binding site comparison. The final outcome did not lead to significant changes in the obtained results ( S9 Fig and S31 Table) . According to our results, the only acceptable match out of all available class A pairs was that between the captopril binding sites of the proteins with the PDB IDs 2x8z and 4dpr. Some further class A pairs were assigned high scores, but the alignment of the corresponding binding sites did not correctly superpose the counterpart ligand atoms, but physicochemically similar ligand moieties (Fig 11D) . Some results can be explained by the way similar binding site pairs were extracted. Sometimes, the ligand atoms "observe" similar interaction partners, but the 3D orientation of these atoms is rather different as presented in S8 Table. Nevertheless, this does not thoroughly explain the final outcome. The question arises whether different parts of the binding site are insufficiently dissimilar to be clearly distinguished (promiscuous ligand binding sites). A binding site analysis of the structures involved in the different similarity classes and druggable sites of a sequence-culled sc-PDB [65] subset led to the results presented in Fig 12. While the hydrophobicity and aromaticity of the binding sites in the benchmark set is higher than that for the sc-PDB [65] pockets, the number of hydrogen bond donor and acceptor atoms is lower. This underlines the finding that binding site similarity does not always imply a similar binding mode adopted by the ligands. For rather hydrophobic and aromatic ligands, multiple binding modes are possible irrespective of the underlying binding site alignment. Moreover, the generation of an accurate superposition is hampered by the fact that for highly hydrophobic binding sites a broad variety of acceptable cavity alignments can be obtained. We conclude that the generation of a similar data set-taking into account only druggable binding sites with a broad range of interaction types-might be more valuable in the evaluation of the performance of binding site comparison methods. Data set of successful applications. The last data set was created from known binding site similarities that have been summarized in literature [5] . Cavities with known similarities were included in a sequence-culled sc-PDB [65] derived cavity subset. Their recovery within the best ranked pairs was analyzed. As compared to the previous data sets, the active pairs represent realistic binding site similarities that should be found and respectively scored by all comparison methods. Besides obvious similarities between binding sites of one protein family (e.g. protein kinases), similar pairs of binding sites in unrelated proteins are included. The outcome of this analysis is shown in Fig 13 and puts the results obtained for all above analyzed data sets into perspective. The differences between the different types of binding site comparison tools cancel each other out for this data set. In most cases, there are only minor differences in the AUC values for the methods and most of these differences are not significant (S33 Table) . All tools show a good performance in terms of AUC as well as in terms of early enrichment. Most residue-based methods outperform the surface-and interaction-based tools, which were the best among all tools for the data set of Kahraman and co-workers. TM-align-a tool which cannot be used to score minor physicochemical binding site differences and aligns residues exclusively based on geometric criteria-is the one with the highest AUC and the highest early enrichment. This underlines a specific challenge for binding site comparison. Although Cavbase [20, 21] PDB files with more than 80 characters per line. Some large protein structures were not properly processed and had to be excluded. SiteEngine comparisons depend on ligand-defined cavities and its use is restricted to protein binding sites with bound ligands. The distance cut-off can be manually adjusted to define the binding site. SiteHopper initially creates binding site patches. This step failed for some protein-ligand complexes. Furthermore, the tool was not able to process residues with missing backbone atoms. These residues were therefore excluded for the comparisons after ensuring that they are not part of the binding site of interest. SiteHopper relies on ligand defined binding sites, but the cut-off radius can be adjusted. For small ligands, an additional flag had to be set during protein-ligand splitting (-min_atoms). This flag was set to 0 to process phosphate binding sites and to 1 for the remaining data sets. SMAP (version 2.0) comparisons worked for nearly all structures after providing the PDB files in an appropriate manner. In some cases, the tool was highly sensitive with respect to the provided structures (including REMARK lines). The binding site definition can be modified using a distance threshold. The tools TIFP and Grim (as tools of IChem version 5.2.6) are based on interaction fingerprints. Only ligand-occupied cavities can therefore be compared. The tool pdbconv of the IChem toolbox must be applied to extract proper binding sites and interaction fingerprints. Problems also arose when the ligand of interest giben in the PDB format was not in the predefined template files. Input structure preparation therefore included a PDB to MOL2 conversion with the CSD Python API 1.3 [90] to obtain more reliable fingerprints. Consequently, we applied two analyses (with PDB and MOL2 files). The same holds true for FuzCav, Shaper, and VolSite/Shaper. The algorithm underlying TM-align relies on a given residue sequence alignment. Binding site atoms within 10 Ã… of the bound ligand were used to ensure a meaningful comparison. As the tool relies on an initial sequence alignment of cavity residues, a small number of residues prevents the alignment of the residues of interest. 


Section:brief introduction to binding site comparison methodologies
Section:method application (note) availability (url)
Section:residue-based methods
Section:method scoring schemes