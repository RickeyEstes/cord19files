Study areas. We collected data from two districts in northwest Tanzania: Serengeti, inhabited by multi-ethnic, agro-pastoralist communities and high-density dog populations, and Ngorongoro, a multiple-use controlled wildlife area, inhabited by low-density pastoralist communities, predominantly Maasai, and lower-density dog populations (Figure 1 ). Attributes of the dog populations in these districts are presented in Table 3 . Wildlife populations also differ in the two districts, but domestic dogs are the focus of this study because they are the only maintenance population of rabies in the area [18] . Incidence data. Data on patients with animal-bite injuries from hospitals and dispensaries, case reports of rabid animals from livestock offices, and community-based surveillance activities were used as primary sources [18] . Visits were made to investigate incidents reported in 2002 to 2006 involving suspected rabid animals. Cases were mapped at the site of the incident (wherever possible) and villagers interviewed to evaluate the status of the biting animal, determine its case history, and identify its source of exposure and subsequent contacts (if known). The same procedure was exhaustively followed for all associated exposures/cases. Interviews were conducted with veterinary officers, local community leaders, and livestock field officers in attendance, resulting in an active reporting network. Cases were diagnosed on epidemiological and clinical criteria, adapting the ''six-step'' method through retrospective interviews with witnesses [37] . Rabies was suspected if an animal displayed clinical signs [37] and either (a) disappeared or died within 10 days, or (b) was killed, but had a history of a bite by another animal or was of unknown origin. Additional clinical criteria for wild carnivores (;10% of human exposures were caused by wild animals and ;10% of inferred transmission events involved rabid wildlife) included tameness, loss of fear of humans, diurnal activity (for nocturnal species), and unprovoked biting of objects and animals without feeding. When multiple incidents involving suspected rabid wildlife were reported on the same/consecutive days within neighbouring homesteads, we assumed a single animal was involved. Brain samples were collected and tested for confirmation wherever possible, but despite efforts to obtain diagnostic samples, most cases reported here were suspected rather than confirmed. Inadequate sample preservation such as storage at room temperature and long intervals between sample collection and testing (during which samples underwent repeated freeze-thaw cycles) probably caused specimens to deteriorate. Composite samples of each brain necessary to achieve the highest test reliability were also rarely available. Nevertheless, a high percentage of samples from suspected cases of rabies were confirmed by laboratory diagnosis (;75%) suggesting that use of epidemiological and clinical criteria is justified and reliable [18] . Researchers are encouraged to contact the authors regarding data availability. Vaccination data. Dog vaccination campaigns in Serengeti district in 2000 resulted in low and patchy vaccination coverage (35-40% estimated from post-vaccination household surveys). Annual campaigns conducted from 2003 onwards in a 10-km zone adjacent to the western border of Serengeti National Park achieved higher coverage levels of between 40 and 80%. In 2004, the Tanzanian government conducted vaccinations in villages in Serengeti district beyond the 10-km zone reaching 55% coverage across the remainder of the district, but in subsequent years, campaigns were less systematic and conducted in fewer villages. Vaccination in Ngorongoro was restricted to small-scale localised campaigns in the district town centre until 2004, whereupon widespread annual vaccinations were implemented with overall coverage exceeding 80% [9] . Data on the number of dogs vaccinated in each village and on each campaign date were collected from 2003 onwards. Parameter estimation. The incubation period and duration of infectiousness were estimated for rabies in domestic dogs from records of when individual dogs were bitten, developed clinical signs, and were killed or died. Gamma distributions were fitted to these data using maximum likelihood with interval censoring to account for cases where the relevant data were only approximately known ( Figure  2 and Table 1 ). To estimate the probability distribution of the generation interval, G(t), an incubation and an infectious period were drawn from their respective distributions, a ''time-to-bite'' deviate was drawn from a uniform distribution over the interval of the infectious period, and the two intervals were summed. There was a significant correlation between the length of the infectious and incubation periods, but significance was entirely due to a single data point; we therefore treated the distributions as independent. The spatial infection kernel K(d) was estimated by fitting a gamma distribution to the distances between known source cases and animals that they contacted. Many contacts occurred within the same, or neighbouring, homesteads. In these cases, the precise distance was not always recorded, but we assumed it was less than 100 m. We therefore replaced the probability of a contact within 100 m by the probability distribution averaged over the range 0-100 m. The basic reproductive number R 0 . (1) Direct estimates from infectious histories. Using maximum likelihood, we fitted a negative binomial distribution to data on biting behaviour of rabid dogs ( Figure 3A ). The probability of developing rabies following a bite (P rabiesjbite ) was estimated, excluding bitten animals that had previously been vaccinated, or that were either killed or vaccinated immediately after the bite, and binomial confidence intervals were calculated. R 0 was estimated as the probability P rabiesjbite multiplied by the average number of bites per rabid dog and confidence intervals were calculated using a resampling procedure. Dogs that were removed (killed or tied up) before causing secondary cases in other dogs (even if they bit people) were excluded from this calculation, as were suspect rabid dogs that either disappeared before biting other dogs or that were of unknown origin and were killed before being observed to bite other dogs ( Figure 3A ). We pooled data from both districts for this estimate because insufficient complete case-histories of rabid dogs (after excluding cases with interventions) were traced to accurately estimate R 0 for Ngorongoro (35 versus 477 in Serengeti). We also estimated R 0 directly from the distribution of secondary cases per rabid dog. Dogs that were bitten by rabid animals but did not develop rabies because of interventions (previous vaccination or being killed/vaccinated immediately after the bite) were multiplied by P rabiesjbite and added to observed secondary cases, giving an expected number of secondary cases per rabid dog in the absence of intervention and a similar estimate of R 0 (1.14, CI: 1.03-1.25) ( Figure  S1 ). (2) Epidemic tree reconstruction. We used an algorithm for probabilistically constructing epidemic trees based on the location of cases in space and time [38] . For each suspected case (i), we chose a progenitor ( j) at random with probability p ij from all n cases preceding that case, where: Gðt ik ÞKðd ik Þ G is the distribution of generation times, t ij is the length of time (in days) between the occurrence of case i and its potential progenitor j (G(t) ¼ 0 for t , 0), K is the spatial infection kernel, and d ij is the distance (in km) between the locations of case i and its potential progenitor j (using the average probability when distance ,100 m, see above). Because the dates that some individuals were bitten or developed rabies were only approximately known, 1,000 bootstrapped datasets were generated with the dates drawn randomly from a uniform distribution over the window of uncertainty and a consensus tree of the most probable links was determined and used to generate secondary case distributions illustrated in Figure S1 . Because transmission of rabies from livestock is recorded extremely rarely, we did not allow livestock progenitors, which considerably improved the match between known and assigned links compared to an algorithm where all species could be assigned as progenitors. All detected cases in carnivores (including domestic cat and wildlife cases) were included in the tree reconstructions using the spatial infection kernel and generation interval parameters estimated for domestic dogs. The contribution of nondomestic dog carnivores to the overall epidemic was small, and estimates of within-and between-species transmission are described elsewhere [18] . When known links between primary and secondary cases were not retained in the trees, they were correctly assigned in more than 60% of cases in both districts, indicating that probabilistic reconstruction was effective. The average number of secondary cases putatively produced from each primary case was calculated from the bootstrapped trees. R 0 was estimated as the average number of infections caused per rabid dog that was infectious during the period of exponential epidemic growth. Determining the period of exponential growth is somewhat subjective; for consistency between methods, we used the interval that gave the median R 0 value for time series regression estimates (see below). The choice of interval caused more variance in R 0 estimates for this reconstruction technique than for other methods because it averages the heterogeneous behaviour of a small number of individual animals that spark an epidemic. Thus inclusion or exclusion of particularly infectious individuals has a large effect on R 0 . (3) Inference from the epidemic curve. A single infection will cause future cases distributed according to the probability distribution of the generation interval. Therefore the number of cases arising in any given interval is the result of those cases that occurred at times in the past whose secondary cases occur in this interval and is determined by the probability distribution of the generation interval. This intuitive description is formalized by the Euler-Lotka equation, adapted for an infection process [25] and an expression for R 0 can be obtained: GðsÞe Àrs We estimated the initial growth rate of the epidemic (r) by fitting an exponential curve to incidence data using a generalized linear model. We compared Akaike's Information Criterion values to determine the appropriate error structure (Poisson or negative binomial). The choice of which part of the epidemic curve the model should be fit to was subjective, therefore the model was fit to all possible sections of the epidemic curve (using a minimum of nine consecutive months) and the median, the 2.5th and the 97.5th percentile of the R 0 estimates are presented in Table 1 . Figure 3B (inset) shows that the estimate of R 0 was robust to the interval chosen for fitting the curve. We used the same method to estimate R 0 from data that we had compiled on outbreaks of canine rabies from elsewhere in the world. For these time series, we fitted exponential curves to the intervals between the first recorded case and the month (or week) with highest rabies incidence (Table 2 ) and converted the estimated growth rates to estimates of R 0 using the serial interval distribution data gathered by contact tracing in Tanzania. For partly vaccinated populations, we corrected our R 0 estimates by dividing by the fraction of dogs which were vaccinated prior to the outbreak [12] . For all the outbreaks considered, including those in Tanzania, some localized and individual control measures may have been instituted (such as tying up or killing infected animals), and therefore our R 0 estimates should be regarded as lower bounds. However simulations also revealed that for very low values of R 0 (,1.2), estimates from the epidemic trajectory can be slightly biased upwards ( Figure S2 ). This is probably because at very low levels of R 0 , most introductions do not initiate further cases and therefore a small number of individuals with higher than average biting behaviour are needed to trigger epidemics, thus biasing trajectories. The effective reproductive number R. The effective reproductive number R measures the average number of secondary cases per primary infection once an epidemic is underway. R changes through space and time depending upon the implementation of control measures, the depletion of susceptibles and the build-up of local correlations in the spatial distribution of infected and susceptible individuals. Numbers of secondary cases per rabid dog (inferred from the epidemic tree reconstructions) were calculated monthly and averaged across bootstrapped trees to give a time-varying estimate of R ( Figure 3C ). Although R declined through time in both districts, there was no apparent temporal trend in the biting behaviour of rabid dogs ( Figure S3 ), suggesting that domestic dog vaccination was the main factor responsible for reducing transmission. Domestic dog demography. To calculate vaccination coverage and the decline in herd immunity due to population turnover and waning of vaccine-induced immunity, it was necessary to estimate the size of the domestic dog populations (N) and their rates of growth (r dogs ). We projected human population sizes in both districts using 2002 national census data [39, 40] , and we calculated human:dog ratios from household questionnaires conducted in 1994, 2003, and 2008 in Serengeti district and in 1994 and 2004 in Ngorongoro district. We then estimated dog populations from the projected human population sizes and the human:dog ratios and calculated the rate of increase of the dog population in each district (r dogs ¼ log(N t /N 0 )/t) ( Table 3 ). An alternative estimate of the rate of domestic dog population growth was derived from demographic data collected using household questionnaires. The death rate of dogs (d) was calculated using a Cox proportional hazards model of survival from longitudinal data (n ¼ 802). When pups (dogs under 3 months of age) were excluded from the model, neither age nor sex significantly affected survival. The percapita birth rate (b) was assumed to be the product of the sex ratio (q), the average litter size (l), and frequency (/) and pup survival (s) (b ¼ ql/s). These demographic parameters were estimated from crosssectional data (309 litters) and the rate of increase was calculated (r dogs ¼ b -d). Pup survival was estimated from a subset of puppies that remained in the household, because of the unknown fate of puppies that were given away or sold. We suspect that mortality of female puppies is greater than males. However, obtaining reliable data to accurately estimate pup survival is difficult, and the result of assuming equal mortality rates is an estimate of r dogs that is more conservative with respect to vaccination coverage (i.e., results in lower population-level immunity). This estimate of r dogs (0.088 dogs/y) was similar to other estimates from the region [41, 42] and close to those calculated directly from population sizes (r Serengeti ¼ 0.090 dogs/ y, r Ngorongoro ¼ 0.102 dogs/y) ( Table 3) . A comparison of the stable age distribution (calculated from cross-sectional data assuming a roughly constant rate of population growth) was consistent with age distributions predicted from the estimated demographic parameters. Analysis of the impacts of intervention. To evaluate whether the predicted level of vaccination coverage required to control rabies (P crit ¼ 1 -1/R 0 ) was sufficient in practice [20] , we plotted the size of village-level outbreaks (an outbreak was defined as at least two cases not interrupted by an interval of more than one month) against vaccination coverage in that village at the time of the case that initiated the outbreak. Vaccination coverage was modeled by susceptible reconstruction using demographic parameters described above (we show the results from using the largest estimate of r dogs (0.10 dogs/y) because this gives the most conservative predictions of the impacts of vaccination, but results are very similar using the lower r dogs estimates). We assumed coverage was approximately 20% in January 2002 and that the duration of vaccine-induced immunity (1/m) was approximately 3 y (http://www.intervet.co.uk/Products_Public/Nobivac_Rabies/ 090_Product_Datasheet.asp). Numbers of vaccinated and susceptible animals within a village were adjusted according to the doses of vaccine used at village vaccination stations on each campaign date (sufficient vaccine was provided such that all animals brought to the station could be vaccinated). A time series of cases in a village and the associated susceptible reconstruction are shown in the inset of Figure 4A . To predict the expected size of outbreaks given the observed variability in transmission, we simulated outbreaks in a starting population of 500 dogs (similar to the domestic dog population size in an average village); this choice had little effect on our results. We used our parameter estimates (Table 1) to randomly assign secondary cases and corresponding generation intervals. Each realization was seeded by a single animal and the starting population was initialized with vaccination coverage generated from a binomial distribution. For comparison with the outbreak data we conditioned each realization upon .1 secondary case ( Figure 4A ). Demographic parameters were incorporated, and 10,000 runs were completed for each starting condition. We also calculated the probability of an outbreak of a particular size or larger being seeded by one infectious case to evaluate the coverage needed to prevent outbreaks with different degrees of certainty ( Figure 4C and Figure S4 ). If V and N denote numbers of vaccinated individuals and the total population size respectively, then vaccination coverage can be expressed as a proportion P ¼ V/N. The number of vaccinated dogs declines following a campaign as individuals die and as vaccineinduced immunity wanes (V t ¼ V 0 e -(dþm)t , where d is the death rate and 1/m is the duration of vaccine-induced immunity), whereas the total population grows at the rate of population increase (N t ¼ N 0 e rt ). To prevent sustained endemic transmission, vaccination coverage must be maintained above P crit (such that R is held below 1). From our estimates of demographic parameters and R 0 , we calculated the proportion of the population that needs to be vaccinated, P target , to prevent vaccination coverage falling below P crit during the interval, T, between campaigns: P target ¼ e (mþdþr)T P crit . This formulation for estimating the coverage needed to interrupt endemic transmission given turnover in the domestic dog population assumes that immunity from vaccination lasts an average of 1/m time units and declines exponentially. In reality, vaccine-induced immunity is likely to be closer to a fixed duration, and thus fewer dogs would be expected to lose immunity during the 1-y interval between campaigns than under the exponential model. This indicates that our estimate of P target may be slightly overestimated, although this is an important area for further investigation. Supporting Information Figure S1 . The distributions of R 0 estimates from fitting curves to simulated epidemic trajectories generated from biting behaviour described by a negative binomial distribution (black) with mean and variance equal to observed biting behaviour or by a poisson distribution (red) with the same mean. The range of R 0 estimates from simulations spans the range of estimates from compiled outbreak data from around the world ( collection and analysis, decision to publish, or preparation of the manuscript. 


Section:materials and methods