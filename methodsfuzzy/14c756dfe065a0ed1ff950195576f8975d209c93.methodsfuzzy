A generalized additive model (GAM) with a log link function and Poisson error was fitted to the weekly numbers of deaths. The Poisson model has been widely applied to the estimation of influenza associated disease burden and recently been validated by an empirical dataset of laboratory confirmed influenza cases [19] . First, long-term trends and seasonal patterns of causespecific mortality counts, as well as environmental factors including temperature and relative humidity, were adjusted for as confounders by building a core model: Here y t denotes the number of deaths at week t. ns(t), ns(temp t ), and ns(humd t ) denote the natural cubic spline smoothing functions of time, weekly average temperature and relative humidity. The natural spline smoothing function was used to remove the small variation while maintaining the major trend of each variable, i.e. to make them smoother. The aim of smoothing was to increase the efficiency in estimating the model coefficients [20] . Given the high correlation between temperature and vapor pressure, the smoothing function of vapor pressure was not added in order to avoid collinearity between the variables. The adequacy of this core model was evaluated by the absence of any obvious pattern in partial autocorrelation functions of its residuals (Additional file 1: Figure S1 ). Second, the weekly proportions of specimens positive for influenza A or B were then added into the core model as a variable for influenza virus activity to obtain a main effect model. The main effects of influenza have been presented elsewhere [21] . To explore the effect modification of environmental factors on influenza associated mortality, we added into the core model the product terms of influenza proportion variable and dummy variables for periods of normal and extreme (high or low) weather conditions as interaction terms between virus activity and environmental factors. For example, the interaction model for temperature and influenza mortality was: where Lowtemp i = 1 for the periods within low temperature ranges and 0 for otherwise, and Midtemp t and Hightemp t are similarly defined as the dummy variables for the middle and high temperature periods. The smoothing function of temperature ns(temp t ) was kept in the model in order to adjust for the association of temperature and mortality. It is reasonable to assume that the cutoff point of extreme weather may differ across cities as people may adapt to prevailing climates. We used the first (25%) and third quartiles (75%) of weekly average temperatures (or humidity) as the cutoff points to define the low, middle and high temperature (or humidity) periods [22] . The presence of effect modification by environmental factors was evaluated using likelihood ratio tests between the interaction and main effect models. To measure the effects of influenza on mortality, we computed the percentage change of mortality counts associated with 1% increases of influenza virus activity for the low, middle and high periods. The formula for the low temperature period is Here Î² 1 was obtained from the above interaction model. To test whether our results were robust to various definitions of periods, we chose two sets of extra cutoff points: 20th and 80th, 30th and 70th percentiles of weekly average data in each city. Although we removed the autocorrelation and seasonal trends within mortality data, there are still concerns that such adjustment was inadequate and the remaining uncontrolled seasonal factors may cause interaction terms of environmental factors and virus activity to appear significant in our models. To rule out this possibility, we used accidental deaths that were expected to be unrelated to influenza infection as a control mortality group to show that our findings are unlikely the spurious results of under-adjustment of seasonal confounding factors in modeling. Some previous studies used the anomalies to assess the effects of meteorology factors on influenza [11] .We therefore conducted a sensitivity analysis by defining the strata by anomalies, instead of absolute values of meteorology factors. The anomalies were defined as the deviations of observed metrological data from a seasonal curve with a constant and a sinusoidal pair fitted to these observed data. All the analyses were performed using the mgcv package of R software (version 2.5.1.) [23] . 


Section:statistical methods