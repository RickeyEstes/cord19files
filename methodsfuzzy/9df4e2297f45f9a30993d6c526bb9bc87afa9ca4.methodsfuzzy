Materials. We analyze three virus datasets with different characteristics: rabies, coronavirus, and influenza A virus, to see if consistent results related to the relative performance of alignment, alignment-free, and machine learning based approaches can be obtained. The rabies virus dataset from Streicker et al. 5 . The rabies virus is a single-stranded RNA virus and has a wide host range. We first investigate the rabies virus dataset from Streicker et al. 5 consisting of 372 rabies virus samples from 23 bat host species. Among them, 148 viruses have complete N gene (1,353 bp) sequenced. In this paper, we concentrate on the study of these 148 viruses. The accession numbers of the complete genomes and N gene of the viruses were provided in Streicker et al. 5 and the corresponding gene sequences can be downloaded from NCBI genbank database using their accession numbers at https://www.ncbi.nlm.nih.gov/genbank/. The coronavirus dataset from Tang et al. 10 . Tang et al. 10 developed a SVM based method using mono-and di-nucleotide sequences to predict the host of coronavirus. We use the same data as in Tang et al. 10 consisting of 724 coronavirus samples from 6 host species (human, porcine, bovine, bat, murine and avian). Among them, 392 samples have complete genome sequenced, and 326 samples only have their spike genes sequenced. We extract the spike gene sequences from the complete genomes by checking the coding sequence annotation in NCBI and obtain additional 381 extracted spike gene sequences. Together with the original 326 sequences, we have a total of 707 all spike sequences and we focus on the investigation of these 707 spike sequences. Influenza A virus dataset from the Influenza Research Database 19 . Finally, we investigate the host of influenza A virus as in Kargarfard et al. 11 . We collect the avian influenza A virus from the Influenza Research Database 19 and exclude those sequences with ambiguous host species such as chicken, duck, avian, and gull, and also those host species with less than 200 virus sequences in the database. We restrict the samples to the same taxonomic rank, and choose the level as "species" in the taxonomic hierarchy. The prediction can surely be easier for more general categories. There are six remaining avian host species: American Black Duck Anas rubripes, Blue-Winged Teal Anas discors, Green-Winged Teal Anas carolinensis, Northern Pintail Anas acuta, Northern Shoveler Anas clypeata, and Ruddy Turnstone Arenaria interpres, for further study. For each host species, we randomly choose 200 virus sequences in our study. Computational methods. Calculate the pairwise distance/dissimilarity matrix of viruses. We compare the performance of alignment-based, alignment-free, and machine learning based approaches for inferring the hosts of viruses. For the alignment-based method, we first use the software "Clustal Omega" 20 for multiple sequence alignment using the default parameters and then use the software "Phylip" 21 and choose the "F84" evolutionary model to calculate the pairwise distance using the alignment results as input. We also investigate several alignment-free methods for calculating the distances/dissimilarities between viral sequences using the CAFE package 15 and these include Chebyshev, Euclidean, Manhattan, CVTree 22 13 , etc. The definitions of these distances/dissimilarities were given in Lu et al. 15 . Our objective is to evaluate if alignment-free approaches have similar accuracies in predicting the hosts of virus sequences, but with much high computational efficiency. Visualize the distance/dissimilarity matrix. To empirically see if viruses from the same host tend to be more similar to each other than those from different hosts, we first use MDS 23 to project the virus sequences onto two-dimensional Euclidean space. MDS is a non-linear dimensionality reduction method that can reduce the pairwise distance matrix to lower dimensional space, while best recapitulating the original distance matrix. We also use hierarchical clustering with average linkage to visualize the relationship among the viruses, and intuitively assess whether the viruses infecting the same hosts are indeed closer than those infecting different hosts. Predict the host of a virus. We apply KNN 24 method based on the pairwise distance matrix for both alignment-based and alignment-free distances for predicting the host of the virus. The alignment-free distance measures include Chebyshev (Ch), Euclidean (Eu), Manhattan (Ma), CVTree (CVT), d 2 , ‚Åé d 2 and d S 2 with various k-mer sizes. For each virus, we choose the K viruses that are closest to the virus from the pairwise distance matrix, and then count the frequency of the hosts of the K viruses. We use the most frequent host as the predicted host of the virus. For machine learning based prediction, we use SVM based on mono-and dinucleotide frequencies (3 mononucleotide frequencies and 16 dinucleotide biases 10 ). R package e1071 was used for SVM analysis with "C-classification" as the model type and "Radial" as the SVM kernel 10 . We use LOOCV 25 and N-fold cross-validation to evaluate the prediction accuracy. We implement this process for all the viruses and then compare the predicted host with its true host to obtain the prediction accuracy. Investigate the impact of sample size on prediction accuracy. The number of known sequences for each host can significantly affect the prediction accuracy. In order to quantify the effects of sample size on prediction accuracy, we randomly choose a certain number of sequences and then apply the KNN and SVM approaches to the set of sequences to obtain the prediction accuracy as described above. We repeat this process for a series of sample sizes to see how the prediction accuracy changes with sample size. We let the sample size change from 70 to 145 with a step size of 5 for the rabies virus dataset, from 100 to 700 with a step size of 50 for the coronavirus, and from 200 to 1100 with a step size of 100 for the influenza A virus dataset. For each sample size, we randomly choose 10 sets of sequences and calculate the prediction accuracy for each dataset. Data availability. All data are publicly available online and can be found based on the information provided in Materials and Methods part. 


Section:materials and methods