Three methods were used to extract the viral nucleic acids: QIAamp Viral RNA Mini Kit (Qiagen, Hilden, Germany), Maxwell 16 Viral Total Nucleic Acid Purification Kit (Promega, Madison, WI, USA), and Trizol Reagent (Life Technologies, Grand Island, NY, USA). For Qiagen column and Maxwell bead extraction, viral nucleic acids were purified according to the manufacture's instruction. For Trizol extraction, viral RNA and DNA were isolated separately following the manufacture's protocol. The elution volume was 60 l of nuclease free water. Three NGS library preparation methods were tested using Nextera XT DNA Sample Preparation Kit (Illumina, San Diego, CA, USA), TruSeq RNA Sample Prep Kit v2 (Illumina, San Diego, CA, USA), and ScriptSeq v2 RNA-Seq Library Preparation Kit (Epicentre, Chicago, IL, USA) according to the manufacture's protocols with minor modifications. The DNA input for Nextera library preparations was either the RT and Klenow DNA polymerase dsDNA products or that same product following PCR amplification products (Table 2 ). For TruSeq library preparation, the same pre-amplification products nucleic acids were used as input DNA. For ScriptSeq library preparation, 10 l of extracted viral nucleic acids were used directly as input and recommended PCR cycles were increased to 25 and 35 to obtain sufficient products for sequencing. The quality of the libraries was assessed by 2100 Bioanalyzer (Agilent Technologies, Santa Clara, CA, USA) and the quantification was estimated by KAPA Library Quant Kit (Kapa Biosystems, Wilmington, MA, USA) real time PCR following the manufacturer's instructions. To investigate the method reproducibility, three treatment groups in which samples were independently processed in the same manners were compared (Table 3) . Technical replicates were not performed for every combination of variables in Table 2. Out of the 150,000 raw sequence reads, the method N1 and its two replicates, N3 and its one replicate, and N5 and its two replicates had similar percentage of usable and target viral reads ( Fig. 1 and Table 3 ). The N1/N230/N231 group identified an average of 6.3 viruses (range 4-8), N3/N227 group identified an average of 12 viruses (range 11-13) and N5/N232/N233 group identified an average of 15.6 viruses (range 15-17) ( Table 3 ). The genome coverage of the recovered viruses was also analyzed. The read numbers and genome coverage for human herpes virus 3 (HHV3) and rotavirus (RVA) are shown (Fig. 2) , as these viruses were detected in all of the libraries with relatively high number of reads and represent a large dsDNA genome and a small ssRNA genome). RVA read numbers and genome coverage was higher and more reproducible than HHV3 (Fig. 2) . The performance of three extraction methods using either Qiagen silica columns, Maxwell silica coated magnetic beads and Trizol (guanidinium thiocyanate-phenol-chloroform) on recovering viral sequence reads were compared (Table 3 ). The N5 method detected the highest percentage of the target virus reads (Fig. 1) and largest number of target viruses (n = 20) (Table 3) . It also generated the highest genome coverage for both HHV3 and RVA (Fig. 2) . Silica columns N5 and magnetic beads N1 had similar numbers of HHV3 reads (1600 vs. 1533) but the genome coverage differed greatly (70 vs. 5%) with the magnetic bead-extracted nucleic acids producing reads with considerable overlaps covering the same limited genomic regions (Fig. 3) . Different DNA library preparation kits are available commercially. Three such kits (Table 3) . Nextera (N227) and TruSeq (N221) used as input pre-amplified DNA were compared. ScriptSeq used viral nucleic acids directly (without pre-amplification) with either 25 (N225) or 35 (N227) PCR cycles during the ScriptSeq library generation. All input nucleic acids were identically treated (without filtration and nuclease digestion). These four experiments generated 39%, 36%, 46% and 35% of usable reads. The target virus reads accounted for 45%, 32%, 11% and 10% of the usable reads ( Fig. 1 ). Both ScriptSeq experiments (N225 and N226) detected 20 viruses, while Nextera (N227) and TruSeq (N221) identified 11 and 14 viruses respectively (Table 3) . ScriptSeq also generated higher genome coverage using fewer virus reads for both HHV3 and RVA (Fig. 2) . Thus, despite the lower number of viral reads, ScriptSeq methods were superior in retrieving target viruses and acquiring large segments of their viral genomes. TruSeq slightly exceeded Nextera in virus detection and genome coverage. 


Section:extraction methods
Section:ngs library preparation methods
Section:method repeatability
Section:library preparation methods