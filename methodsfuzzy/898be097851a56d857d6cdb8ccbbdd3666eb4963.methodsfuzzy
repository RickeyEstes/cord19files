Vsfold5 uses pointers to map the secondary structure, and handles and a lookup table of exit tags to link different segments of secondary structure together to form different parts of the pseudoknot. There are other formal mapping methods [23] , but for the problems that are addressed here, the approach explained in this work appears to be more applicable. Here we define the indices and i j represent residues (base i and base j ) in the RNA sequence with and the indexing runs successively from the 5' end to the 3' end of the sequence. A base pair (bp) that is formed between base and base i j < i j is indicated by the ordered In this approach, the pointer maps the next major position of the secondary structure and any previous position that is present in the structure. The pointer consists of the current position , a tag classifying the type of secondary structure located at , a forward link (labeled "forward" in For example, Fig. S7a shows a stem with a pointer located at a base pair . The tag at is 'S', the forward pointer (green arrow labeled "forward") aims at the head of the stem and the reverse pointer (brown arrow labeled "reverse") aims at the tail of the stem . When the pointer is located at in the stem (same Figure) , it points to the next secondary structure and back to the tail of itself at . In Figure S7 , the next secondary structure is a hairpin (tag 'H') and the pointer points forward to itself at . Figure S7b shows a triangle diagram representation of the secondary structure and the respective coordinates for a stem terminated by a loop (known as a "stem-loop"). In Figure S8a , is located at the head of stem , indicated also by the green oval. The secondary structure is an internal loop (tag 'I') and the forward pointer aims at the tail of the next stem located at ; this is also shown in Fig. S8b as a triangle diagram. Like the hairpin loop, the reverse pointer indicates the tail at . (The subscript index is used for notation purposes here. The pointers at each position are sufficient to fully index all necessary information.) In Figure S9a , the pointer is at a multibranch loop (tag 'M') at (green oval). Here, a single pointer is insufficient to indicate the branching of the stem and an array of pointers is applied at to map out the branches at and : , ( t t q p forward 1 and forward 2 respectively. The reverse pointer aims at whose tag is 'S'. The pointers are also shown in Fig. S9b with a labels "(f1)" and "(f2)" indicating the forward pointers (green arrows), and "(r)" indicating the reverse pointer (brown arrow). 00 ) , ( t t q p (p t ,q t ) 00 (p h ,q h ) 00 (p t ,q t ) 11 (p h ,q h ) 11 (p t ,q t ) 12 (p h ,q h ) 12 (p t ,q t ) 00 (p t ,q t ) 00 (p t ,q t ) 11 (p h ,q h ) 11 (p t ,q t ) 12 (p h ,q h ) 12 and forward "f1" and "f2" pointers (green arrows) and a reverse pointer "r" (brown arrow). This information is regularly updated with each construction of the map or section of the map. A summary of the secondary structure pointers is shown in Tab. S1. For RNA secondary structure, this information is sufficient to map a complete structure and assess the relationship of a given secondary structure at to other secondary structure in other regions of the map. The ) , ( j i modeling provides more immediate structure information than traditional methods. Currently, most of the secondary structural considerations in vsfold5 are limited to the local region in the vicinity of where the main focus is on the persistence length and stem formation. However, with pseudoknots (next section), global search methods were required because the configuration information about other parts of the structure aid in deciding the stability of any potential structure. Modules are easily added to expand this functionality further. Table S1 . List of pointers used in the secondary structure maps: (ss_name) a tag indicating the secondary structure, (ss_link) the forward link,  In the search for PKs, the heuristics first looks for contacts that are significant in magnitude to warrant further testing. If a potential contact is found where 2 kcal/mol dG < âˆ’ , a stem melting module will try to melt part of the structure in the root domain to see if better contact can be achieved. Occasionally, this delivers a true edit. However, because the free energy of stems are of similar order of magnitude, most of the time, it appears that no gain is achieved. At the same time these local stem-melting methods are testing the minor rearrangements around the neck of the root domain and the linkage stem, the heuristics also continually build up a structure starting at the 5' end and moving progressively toward the 3' end searching for the best structure. While the main structure is building up, a "leading edge" of sequence ranging from 7 nt to 20 nt ahead of the currently built up structure (also called the dwell region) is tested on this existing structure for possible pseudoknots. This we refer to as a "hot lead" because the process resembles melting the leading edge strand onto the existing structure. When the folding catches up with this already tested structure, the free energy built by the secondary structure construction methods at the same region is then compared with the free energy generated by the pseudoknot test. If the pseudoknot turns out to be more stable than the structure generated by the secondary structure construction methods, then the PK is selected. This latter effect is generally far more drastic and appears to be the most effective. A 3D structure will also be affected by entanglement issues [8, 9] . However, vsfold5 only considers the thermodynamically most-probably folding pathway in the calculation. Entangled structures represent alternative and less favorable structures. Hence, the entanglement issues are completely circumvented. Therefore, although a genuine issue, we need not monitor these or assign any cost function for them; nor should we, unless we intentionally wish to build them. Moreover, whatever cost could be derived would have to take into account base triples and probably other tertiary structure interactions. Since there is virtually no context dependent thermodynamic data for base triples, it is difficult to make more than a qualitative estimate of the stability of such structures at the present time. 


Section:s2.2. vsfold5 mapping methods
Section:s2.4.7. general folding methodology