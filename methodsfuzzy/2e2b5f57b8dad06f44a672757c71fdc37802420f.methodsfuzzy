Sequential maximum a posteriori expectation maximization (sMAPEM), was introduced to ET recently to compensate for the missing wedge effects [12, 13] . The method assumes Poisson distribution to model the image to be reconstructed and median filter (median root prior, [11] ) to regularize the iterations. Instead of using one constant regularization parameter value, the method used a sequence of these in the decreasing order. At each regularization stage, predefined number of iterations was performed with constant regularization parameter value. The initial stages with high values of regularization parameters provided a rough but robust estimate of the image for the following stages by highly suppressing the noise. The regularization parameter value was decreased to enhance the resolution and contrast of the final reconstructed image. This sequential method was consistently superior to the conventional reconstruction methods, weighted back-projection (WBP) and a simultaneous iterative reconstruction technique (SIRT), in terms of accuracy and noise suppression due to its capability of filling the missing wedge [12] . However, sMA-PEM has some parameters, which affect the final resolution, the final contrast, and the visual impression of the reconstruction result. The number of regularization stages, the number of iterations 0º Fig. 1 . The projection geometry. The volume is divided into x-z slices which are reconstructed independently. v b is proportional to the probability that an incident electron is scattered inside the bth pixel of the x-z slice image. It is modeled by a Poisson distribution with mean λ b . p d is the dth projection data. per each stage, and the regularization parameters need to be set properly by the user according to the data and the application. Moreover, the method requires a long computation time. The strength of the penalization depends on the regularization parameter value and the filter size relative to the reconstructed image size. sMAPEM method used a sequence of regularization parameter values in the decreasing order to weaken the penalization filter sequentially [12] . In this way, noise was highly suppressed in the reconstruction in the first regularization stages to have coarse but robust estimate of the structure. In the following stages, the regularization parameter value was decreased to enhance the resolution and contrast of the estimate. In addition to changing the regularization parameter value adaptively to control the noise penalization, adaptive multiresolution MAPEM (amMA-PEM) reconstruction method changes the reconstruction image size while keeping the filter size constant. In our experiments, we fixed the window size of the filter to its smallest value (3 Â 3) in order to minimize the loss of resolution due to filtering (The reader may refer to [11] for the effect of different filter sizes on MRP regularization). The same size of filter affects the small size image more strongly than the large one. With amMAPEM method, the strength of the penalization filter is weakened by increasing the image size stage by stage sequentially. The advantage of this approach is its computational efficiency. The flow diagram of the amMAPEM method is given in Fig. 2 for single x-z slice of the reconstructed volume. The method is initialized with a uniform image of size 4 Â 4 so that 3 Â 3 median filter can fit in properly. At each resolution stage, adaptive regularization is applied using the binned projection data and rescaled reconstruction grid. The result of each regularization stage is scaled up by a factor of 2 using bilinear interpolation. The scaled image initializes the following regularization stage. The binning factor of the projection data is also decreased throughout the stages. With this method, the averaging effect of binning operation decreases the noise contamination together with the median filter employed inside the iterations of adaptive regularization. Decreasing the number of binned pixels step by step improves the resolution of the reconstruction. The final image is obtained at the last stage using the result of previous stages and the original projection data P. The method is implemented in MATLAB (MathWorks Inc., MA, USA) and the code is available together with the data related to this study at http://www.cs.tut.fi/sgn/m2obsi/m2obsiWWW/de mos/amMAPEM/amMAPEM.html. 


Section:sequential mapem reconstruction method
Section:adaptive multiresolution mapem reconstruction method