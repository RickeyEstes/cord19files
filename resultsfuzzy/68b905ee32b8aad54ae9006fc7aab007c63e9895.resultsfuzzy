The fragments are generated by first determining amplicons in which the forward and reverse primers are conserved among all the input genomes. If no restriction digest is to be applied, then an amplicon must differ in length among the input genomes. With restriction digest, the distribution of fragment lengths after cutting the amplicon with restriction enzymes must differ among the genomes. The parameter num_restriction_enzymes may be set equal to 0, 1, 2, or 3, as will be described below. Length variation must be detectable by electrophoresis, since there is a limit to the precision to which lengths can be determined. Here, if all the fragments in each of the genomes are less than 50 bases long, or if there are no differences in fragment lengths among any of the genomes that are at least precision bases, then the amplicon+enzyme combination is not considered to be sufficiently variable. In order to find candidate regions for PCR-RFLP variation, sequence fragments that may contain a PCR-RFLP marker are selected from the conservation gestalt. These are chosen to be just over the max_amplicon_length, to have at least one variable position (a dot in the gestalt file), and are chosen using a sliding window moving at least jump bases from the start of the previous window. If jump is too large, PCR-RFLP sites may be missed, and if jump is too small, the same insertion/deletion variation may be counted more than once if it is contained within more than one pair of primers. However, all instances of count-ing the same variable site will appear within the same haploblock, so a simple examination of the markers within a given haploblock sorted by position should indicate those that query the same site as a result of using too small a value for the jump parameter. The software may also be run several times with different values of jump, and the largest value of jump that still provides the greatest discrimination among genomes may be selected. Second, conserved primer pairs are selected from these fragments using MIT's primer3 software with user-specified parameters. Third, genomes are searched for an exact match to each primer pair on both the plus and minus (reverse complemented) strands, and those primer pairs are discarded in which 1) one or both primers are absent from any of the genomes, 2) one or both primers occur more than once in any of the genomes (with no mismatches), or 3) the forward and reverse primers are too far apart to reliably generate an amplicon in one or more of the genomes. In the analyses here, it is assumed that any distance longer than 1200 bases is too long for amplification, which is reasonable if a short elongation time in the PCR thermocycle is to be used. This value can be changed in the source code. Amplicons can be cut by 0, 1, 2 or 3 enzymes simultaneously (or sequentially before being run through electrophoresis), as a user-specified option num_restriction_enzymes. Simulated cutting is performed computationally using the regular expression pattern matching function in Perl, and it is assumed that cuts occur in all locations where a given enzyme sequence occurs (that is, the DNA is exposed to the enzyme for a sufficient duration to cut at all the sequence-specific sites). If the number of restriction enzymes is set to 0, then in the output files the restriction enzyme is indicated as "NONE", and the PCR amplicons must vary in length among the sequences without any restriction digest. If num_restriction_enzymes = 1, then a given PCR product may be digested by only one enzyme at a time before electrophoresis or other empirical measurement of fragment lengths. That is, digestion of the original PCR products with many alternative enzymes may be performed as long as each digestion is followed by its own fragment length measurement. The final solution guiding how to discriminate all the input sequences may involve a number of different enzymes. But when num_restriction_enzymes = 1, digestion is always done only with one enzyme at a time before fragment lengths are measured. If num_restriction_enzymes = 2 or 3, then digestion can occur with combinations of 2 or 3 enzymes, respectively, before the measurement of fragment lengths occurs after each digestion with a given combination of enzymes. Enzyme combinations should be examined by the user to make sure the buffers and reaction conditions are compatible for all the enzymes in the combination, as the software does not assess enzyme compatibility. Although setting num_restriction_enzymes = 2 or 3 is allowed, it is not clear that users ever need to use these options, since with num_restriction_enzymes = 1, many different enzymes may contribute to the total solution of discriminating all the input genomes, as long as they are not applied simultaneously. All results reported here were computed using num_restriction_enzymes = 1. The restriction enzymes to be considered are specified by the user. Currently, the software is not implemented for non-palindromic restriction enzymes, although this could be added as a minor modification if required. 


Section:pcr-rflps a pcr-rflp variation occurs if pcr amplicons or the fragments that result after restriction digest of such amplicons have a different length distribution among the input genomes. fragment length distributions differ if they have different numbers of fragments or if any of the fragments differ in length.