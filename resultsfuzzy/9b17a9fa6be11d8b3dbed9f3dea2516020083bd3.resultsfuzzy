We applied kallisto to index five databases of different sizes and calculated the running time of the indexing step. Figure 1 shows that indexing time increases linearly with the size of the reference databases, 5 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/196998 doi: bioRxiv preprint and for the largest reference database of 2 GB, kallisto took 3 hours and 38 minutes to generate the index file. To examine how running time changes with sample size, we created seven data sets with 1, 3, 5, 10, 20, 30, and 40 million reads respectively from the data described in Lee et al. [14] and applied FastViromeExplorer, ViromeScan, and Blastn. As Blastn took too long to run on large data sets, we run Blastn on only three data sets of size 1, 3, and 5 million reads respectively. Two databases, one containing all NCBI RefSeq viral genomes and the other containing 125,842 mVCs from Paez-Espino et al. [18] , were used as the reference databases, to also examine the effect of reference databases on running time. Figure 2a shows the running time using the NCBI database as reference. FastViromeExplorer has the shortest running time for all the seven data sets. For the data set with 5 million reads FastViromeExplorer took only seven minutes, compared to 12 minutes for ViromeScan, 31 minutes for Blastn. The speedup of FastViromeExplorer compared to ViromeScan became much more pronouced when a larger reference database was used. Figure 2b shows that when we used the larger reference database, for a data set with 5 million reads, FastViromeExplorer took 17 minutes, compared to 53 minutes for ViromeScan, and 4 hours and 40 minutes for Blastn. So FastViromeExplorer ran 3 times faster than ViromeScan and 16 times faster than Blastn. For the largest data set with 40 million reads, FastViromeExplorer took 2 hours and 27 minutes, a 2.5x speedup compared to ViromeScan that took 6 hours and 23 minutes. Taken together, when using NCBI virus and phage database as reference, FastViromeExplorer takes on average about 1 minute to process one million reads; when using a larger database (125,842 mVCs, 2GB), FastViromeExplorer takes 3-4 minutes to process one million reads, a 2-3x speed up compared to ViromeScan. Note that the indexing time (for both FastViromeExplorer and ViromeScan) was not counted in the running time shown (Figure 2 ) as indexing is only one time process. Once the index file is generated, it can be used to annotate any metagenomic data. Simulated datasets were initially used to compare the annotation performance of FastViromeExploree with Viromescan and Blastn. Sinces viruses mutate fast, even if it is the same viral species, the viral sequences in the metagenomic data might not be exactly the same as their sequences in the reference database, it is therefore important to examine the performance of an annotation tool taking into account 6 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/196998 doi: bioRxiv preprint Figure 2 : Comparison of running time among FastViromeExplorer, ViromeScan, and Blastn for seven data sets with 1, 3, 5, 10, 20, 30, and 40 million reads, respectively (a) against a reference database containing 8,957 NCBI RefSeq viruses, (b) against a reference database containing 125,842 mVCs virus' high mutation rate. We therefore simulated four data sets with different mutation rates (3%, 5%, 7%, and 10%) from the references and applied FastViromeExplorer, ViromeScan, and Blastn. Figure 3 shows the F1 score (recall and precision are given in supplementary file 1). All the tools have high precision (99%) across all the data sets. But as mutation rate becomes higher, the number of mapped reads reduces and recall becomes lower for all the tools. In terms of F1 score, Blastn has the best score, FastViromeExplorer has similar but slightly lower score, and ViromeScan has the lowest score. For the data set with the highest mutation rate 10%, the F1 scores for Blastn, FastViromeExplorer and ViromeScan are 0.79, 0.7, and 0.43 respectively. But FastViromeExplorer took 2 minutes compared to Blastn 8 minutes. Therefore, for these simulated data sets and using all eukarytoic viruses as the reference database, FastViromeExplorer runs four times faster than Blastn while maintaining a similar F1 score to Blastn. As viruses are known to have fast mutation rates, Blastn and its variants (e.g., Blastp) are considered the "gold standard" approach to annotate viral sequences in metagenomic data but very time-consuming, having similar performance yet running much faster is highly desired for an annotation tool. To examine the annotation performance of FastViromeExplorer on real data, we applied FastViromeExplorer to the fecal metagenomic samples collected from Lee et al. [14] . Lee et al. followed the dynamics and consequence of fecal micriobial transplantation (FMT) by examining the metagenomics data from a donor's and recipients' preFMT and postFMT samples. They constructed 92 bacterial metagenomeassembled genomes (MAGs) from reads of the donor samples and examined the occurrence of the MAGs in the recipient samples. They found that the bacterial MAGs that were present in the donor samples and also colonized the recipient samples after FMT mostly belonged to the order Bacteroidales. Here we examined the dynamics of viruses/phages to see whether it is consistent with the finding of Lee et al. [14] . From the annotation result of FastViromeExplorer using the 8,957 NCBI RefSeq viral genomes as reference, we observed that only three viruses (Human endogenous retrovirus K113, Glypta fumiferanae ichnovirus segment C10, and Lactococcus prophage bIL311) were found in all four donor samples, with human endogenous retrovirus K113 being the most abundant for samples 1, 3, and 4, and Lactococcus prophage bIL311 the most abundant in sample 2. For the recipient, 30 viruses were found in the preFMT sample whereas only five were found in the two postFMT samples. Among the five viruses, only Lactococcus prophage was also found in one donor sample. But as this prophage was also present in the preFMT sample, we cannot conclude that the virus was transferred from the donor to the recipient. Overall, the annotation result reveals no clear evidence of virus/phage transfer from the donor to the recipient. Figure 3 : F1 score of FastViromeExplorer, ViromeScan, and Blastn when using NCBI eukaryotic viruses as the reference database and four simulated data sets of 1 million reads each with mutation rate 3%, 5%, 7%, and 10% respectively. We also applied ViromeScan to the fecal samples with its default reference database containing 4,370 eukaryotic DNA/RNA viruses. ViromeScan identified 847 viruses in all the samples. Compared to ViromeScan's reference database, ours is two times bigger and it is thus surprising that ViromeScan identified a lot more viruses than FastViromeExplorer. Analysis of the ViromeScan result shows that the most abundant virus, Encephalomyocarditis virus, has all the reads mapped to a repeat region of its genome (see supplementary figure 3 ), indicating that the annotation is likely false positive. In fact, Encephalomyocarditis virus was also present in the initial result produced by FastViromeExplorer, but was discarded after the first filtering step. To further examine the effect of our three filtering criteria, we applied them to the ViromeScan result. Figure 4 shows that most of the viruses were filtered out and only Human endogenous retrovirus K113 and Glypta fumiferanae ichnovirus remained, both of which were also present in the final result of FastViromeExplorer. The finding here shows the importance of the filtering criteria in removing viruses that might be annotation artifacts caused by repeats, low coverage, and small genome sizes. Since the annotation of the fecal samples using the default NCBI viral database did not reveal anything meaningful about fecal microbiota transplantation from the donor to the recipient, we tried FastViromeExplorer again using the 125,842 metagenomic viral contigs (mVCs) collected from Paez et al. [18] as reference. These mVCs are mostly unknown partial or complete viral genomes but have been predicted/annotated for their possible hosts. Therefore, the host information of the mVCs can be used to examine the annotation result. Figure 5 shows the relative abundance of host bacteria across all donor and recipient samples. The order Bacteroidales is more abundant than the order Clostridiales in all donor samples. For the recipient, prior to FMT, the order Clostridiales clearly dominated the microbiota, however, after the transplantation, the abundance of the order Bacteroidales increased dramatically and the abundance of the order Clostridiales decreased greatly. This result indicates that due to the transplantation, phages with host bacteria from the order Bacteroidales were transferred from the donor to the recipient. For example, in donor samples, "SRS049900 LANL scaffold 14438" is one of the most abundant mVC, being the most abundant in donor samples 1 and 2, and the second most abundant in samples 3 and 4. This mVC was not present in the recipient's preFMT sample but was highly abundant in the postFMT samples, suggesting the successful transferring of the mVC from the donor to the recipient. As the host of this mVC is from the order Bacteroidales, this suggests the successful colonization of bacteria from the order Bacteroidales from the donoor to the recipient. Therefore, our result on phage transfer following the FMT is consistent with the observation on bacterial colonization following the FMT shown in the original study [14] . The detailed annotation result is given in supplementary file 2. Figure 4 : Number of viruses from ViromeScan result before applying any filter, after applying criterion 1, after applying criteria 1 and 2, and after applying all three criteria. Consequently, when we applied FastViromeExplorer to the samples using a larger reference database, a much clear correlation between our results and the biological results reported in the original paper emerges, 9 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/196998 doi: bioRxiv preprint which indicates the importance of of having a fast annotation and quantification tool that can easily handle bigger and more complete reference databases. 


Section:results and discussion