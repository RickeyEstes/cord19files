In this section, we present more detailed technical results relevant to the methods applied to our multitype branching process. As in the main text, we denote byG ¼ ðG 1 ; G 2 ; . . . ; G m Þ the vector of typespecific offspring distribution PGFs. First, we make the reasonable assumption that our process is never singular. Singular processes are those in which every individual has exactly one offspring (Harris 1963) , and are often excluded from analyses. Results for multi-type branching processes are usually stated for indecomposable processes, in which 'each type of individual eventually may have progeny of any other type' (Haccou et al. 2005, p. 26) , also known as irreducible processes (Mode 1971) . Such a process can be identified from the expectation matrix, M: the process is indecomposable if, for every pair of types (i,j), there exists a positive integer n such that M n (i,j) . 0; or equivalently, there is a non-zero probability of producing at least one type j in generation n, given that the process starts with one type i (Mode 1971; Haccou et al. 2005 ). If n is independent of the types (i,j), the process is called positively regular (Mode 1971) . Only periodic processes are indecomposable, but fail to be positively regular (Mode 1971) ; however, a periodic process can be represented by a non-periodic process through a transformation of time scale (Haccou et al. 2005) . Thus, from here on, we take indecomposable to mean positively regular. In our model, whenever mutation is reversible and all types are transmissible, we have an indecomposable process. On the other hand, we may be dealing with a decomposable process, in which there are 'distinct groups of types that do not produce types in other groups' (Haccou et al. 2005, p. 27 ). In our model, whenever mutation is irreversible, the mutation matrix U is upper triangular; hence, the expectation matrix M and any positive power M n are also upper triangular and we have a decomposable process. We also encounter decomposable processes whenever there are nontransmitting types, leading to an all-zero row in M. We say that extinction of the process occurs when the population of every type reaches zero at some generation. Analogously to the single-type case, there is a threshold theorem for multi-type processes stating when non-extinction is possible; now, the threshold parameter is the dominant eigenvalue r of the expectation matrix M. In the indecomposable case, extinction occurs with probability one from any starting type if and only if r 1 (Harris 1963; Mode 1971; Athreya & Ney 1972; Allen 2003; Haccou et al. 2005) . In the decomposable case, we must consider classes of types that communicate, i.e. any type within a class can give rise to any other type in the class after some number of generations (Harris 1963; Mode 1971) . Then, provided there is no type that produces in the next generation exactly one offspring in its class with probability one, the threshold theorem continues to hold in the decomposable case (Harris 1963; Mode 1971) . We will assume that this condition, which is Evolutionary emergence of pathogens H. K. Alexander and T. Day 1471 essentially an extension of the definition of nonsingularity (Mode 1971) , always holds in processes we consider. Applying this theorem to our model, clearly the possibility of non-extinction requires that some type is supercritical in isolation, i.e. R 0,i . 1 for some i. When mutation is irreversible, the eigenvalues of M are simply given by the entries on the main diagonal, and assuming that the final strain m is best adapted, the dominant eigenvalue is R 0,m . Thus, the process is guaranteed to go extinct from every initial type if and only if R 0,m 1. Otherwise, there is a positive probability that the process does not go extinct, at least from some initial type. In fact, any initial type will suffice, provided the probability of forward mutation is positive and every strain is transmissible. For reversible mutation, again assuming strain m is best adapted, having R 0,m . 1 is a necessary, but not sufficient, condition to obtain a positive probability of nonextinction (cf. figure 3) . Finally, if any type is non-transmissible (as we sometimes consider with hub-and-spoke schemes), clearly a process initiated by such a type is guaranteed to go extinct. Starting from any other type, we can simply ignore any production of non-transmissible types to define a process fitting into one of the aforementioned cases. Let q i denote the extinction probability of a multitype branching process initiated by one type i individual. It is a well-known result for an indecomposable process thatq ¼ ðq 1 ; . . . ; q m Þ is a fixed point of the vector equationGðqÞ ¼q, i.e. G i ðqÞ ¼ q i , 8i (Harris 1963; Athreya & Ney 1972; Kimmel & Axelrod 2002; Allen 2003; Haccou et al. 2005) . However, the argument for reaching this conclusion in fact applies to any branching process (Mode 1971) ; some further deductions depend on irreducibility. First note that1 (the vector of length m containing all ones) is always a fixed point ofG; there may be other solutions too. For an indecomposable process,q is the smallest non-negative fixed point ofG: if r 1, thenq ¼1, as guaranteed by the threshold theorem; while if r . 1 (the supercritical case), 0 q i , 1, 8i (Harris 1963; Mode 1971; Athreya & Ney 1972; Kimmel & Axelrod 2002; Allen 2003; Haccou et al. 2005) . Furthermore, the only solutions to the fixed-point equation with 0 s i 1, 8i, are1 andq, and fixed-point iteration beginning with anys (0 s i , 1, 8i) converges toq (Harris 1963; Mode 1971; Athreya & Ney 1972) . This suggests a simple way to compute extinction probabilities to arbitrary accuracy, and is indeed the method we use for our numerical results ( §3.3). For a decomposable process, the threshold theorem again implies thatq ¼1 if r 1. However, for a supercritical process (r . 1), the uniqueness of fixed-point solutionss =1 does not necessarily hold, nor must every q i be less than one even whenq =1. For any situation we consider, we can argue (see below) that our computational method finds the 'right' solutionq representing the probability that the entire process (i.e. every type) goes extinct; see also Reluga et al. (2007) for interpretations of multiple solutions. We first assume that all types are transmissible, so M has no all-zero row. Suppose mutation is irreversible and hence M is upper triangular. This implies that G i ðsÞ is in fact independent of s j for all j , i. Thus, we can solve for any fixed points by working backwards through types m, m 2 1, . . . , 1, substituting solutions for those s i already found and leaving an equation in one variable only. Assuming type m is supercritical (R 0,m . 1), according to results for single-type branching processes, G m (s m ) ¼ s m has two solutions: s m ¼ 1 and s m ¼ q m , 1 (the extinction probability of the process initiated by a type m). We can then solve for s m21 in each case. G m21 (s m21 , 1) is the PGF for the number of type m 2 1's produced by a type m 2 1, defining a single-type branching process. In most cases we consider, R 0,m21 , 1, and hence this will be a subcritical branching process, yielding a unique fixed point on [0, 1], s m21 ¼ 1. Occasionally (e.g. figure 8 ), we will consider a case where R 0,m21 . 1 and the process may be supercritical; in this case, we obtain two fixed points, s m21 ¼ 1 and s m21 ¼ q m21 , 1. On the other hand, G m21 (s m21 , q m ) is an increasing, concave-up function satisfying G m21 (0, q m ) . 0 and, assuming m m21,m . 0 (i.e. G m21 ðsÞ is not independent of s m ), G m21 (1, q m ) , 1; therefore, there is a unique solution q m21 , 1 satisfying G m21 (q m21 , q m ) ¼ q m21 . The argument proceeds identically as we continue to work backwards through types. To summarize, in most cases, we will have R 0,m . 1 and R 0,i , 1 8i = m; this yields two solutions to the vector fixed-point equation:s ¼1 ands ¼q, the extinction probability, where q i , 1, 8i. Furthermore, fixed-point iteration beginning with anys with all components ,1 will converge to the latter solution, since iteration of G m (s m ) converges to q m . In the occasional case that we have more than one supercritical type, there will be more than two solutions, corresponding to different subsets of types persisting in the case of non-extinction (Reluga et al. 2007) . However, only one solutionq will have all components ,1, and this can readily be identified as the vector of probabilities that the entire process (every type) goes extinct, based on arguments presented above. Again, this is the solution that will be reached by fixed-point iteration beginning withs such that s i , 1, 8i, which is the method we apply in computations. In more complicated mutational schemes (not considered here), for instance if certain pathways are reversible and others are not, classes in a decomposable process may consist of more than one type; here we can write M in a block triangular form and apply results from Mode (1971) to make similar arguments. If any type i is not transmissible, its corresponding PGF is clearly G i ðsÞ ¼ 1, with unique fixed point s i ¼ 1. Substituting this solution into all other equations yields PGFs that effectively neglect any production of type i, and we can then proceed as described above. Finally, recall that the probability of extinction starting from a generation 0 infective of type i, chosen uniformly at random with respect to degree, is given by g(1 2 T i þ T i P j¼1 m m ij q j ) ; g i ðqÞ. This probability is less than one if and only if q j , 1 for some j for which m ij . 0, simply meaning that extinction is guaranteed in this process if it is guaranteed in the processes initiated by later-generation infectives of types accessible by mutation. If the branching process escapes extinction, we may be interested in the complement of types present in the long term. In indecomposable processes, all types will persist, and their populations grow asymptotically at a geometric rate r (Haccou et al. 2005) . However, this is not necessarily the case in decomposable processes. A simple inductive argument can be used to show that only supercritical types can persist if mutation is irreversible; so, in most cases we consider, 'emergence' means that only type m is present in the long term. More detailed limit theorems can be found in Mode (1971) . 


Section:appendix d. technical results for multi-type branching processes