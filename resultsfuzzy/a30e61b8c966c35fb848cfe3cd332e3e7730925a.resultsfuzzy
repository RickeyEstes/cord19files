To implement the automatic virus identification strategy with the probe depletion approach, we developed a signal processing and data analysis algorithm. The algorithm was implemented with MATLAB software using built-in functions and commands. Fig. 3 illustrates the flow of the procedure. Shannon-Nyquist sampling theorem [13] and Savitzky-Golay low-pass filtering [14] were employed to down-sample the electropherogram. Baseline correction was employed to have better quantification of the peak area, peak height, and for peak alignment. Parameters for peak detection were defined prior to the detection and included minimum peak height, minimum peak width, and sampling frequency. After peak detection, the peaks of the electropherogram were aligned with the blank control electropherogram containing peaks of the 15 virus probes. The aligned peaks were further attended to fit the first-order Gaussian distribution. By calculating the peak areas of the fitted curves, we are able to tell which peaks are diminished and unravel the identity of the corresponding viruses (refer to Supplementary Data for more details). To facilitate visual identification, the peak area is pseudocolor encoded. To verify the automated virus identification algorithm, we used nine samples each containing one virus and three samples each containing two viruses to test virus identification in single and double viral infections. The 12 samples were denoted by x 1 to x 12 and the 15 virus probes were denoted by y 1 to y 15 , respectively. Altogether, 180 peak areas are shown in Fig. 4 . By excluding the statistical outlier, i.e., the diminished peak, the software program calculated the mean and standard deviation of each electropherogram. The program identified the diminished probe and its corresponding virus by 95% confidence interval. The outputs are displayed in a numerical format as x i and y j coordinated values, where i = 1,. . .,12 and j = 1,. . .,15. The diminished peaks: (1, 7) , (2, 8) , (3, 9) , (4, 10) , (5, 11) , (6, 12) , (7, 13) , (8, 14) , (9, 15) , (10, 8) , (10, 12) , (11, 13) , (11, 14) , (12, 7) , and (12, 10) are presented by the heatmap in Fig. 3 . With the pseudocolor heatmap, one can easily identify the diminished peaks which appear in blue. All 12 samples were processed with one-step RT-PCR and capillary gel electrophoresis to demonstrate that the method works for both DNA and RNA virus identification. Depending on the coverage of viruses needed for an identity screen, the number of probes may be extended by a multi-channel capillary electrophoresis instrument to have more virus probes in one run. The number of probes can be increased by two ways, by labeling the probes with up to 4 different fluorophores and/or increase the number of probes of different lengths. The high resolution of capillary gel electrophoresis allowed discriminating probes difference in length by one base, e.g., the 64mer probe for SARS and the 65mer probe for DENV1. Therefore, it permits using tens of fluorescently labeled probes for virus identification. The number may go beyond a hundred if more than one fluorophores are used. The number of sample per run is limited by the capacity of the DNA sequencer and is up to 96 samples at a time with an ABI 3730xl DNA analyzer. It is known that samples run in different capillaries vary in migration time and signal intensity. With the aforementioned algorithm, we were able to align and adjust the retention time of the peaks. To assess the variation of peak area in different capillaries, we used a blank control and 7 different quantities of SARS virus ranging from 10 to 5000 copies of virus genome to go through the one-step RT-PCR process. The 8 samples were run in separate capillaries by the ABI 3100 genetic analyzer. The results are shown in Fig. S1 in the Supporting Information. The peak area data fit virus quantity data on logarithmic scale with a coefficient of determination, r 2 = 0.97. The data present in the plot were performed in triplicates to determine the standard deviation. For 10 copies, the mean peak area was 175 and the standard deviation was 14; for 50 copies, the mean was 140 and the standard deviation was 6. By 95% confidence interval, i.e., with 1.96-fold standard deviation, the method is able to detect virus down to the order of 10 copies and resolve virus quantity by order of magnitude. Based on this quantification study and the PCR conditions described in Section 2, it took 10 5 copies of SARS virus to have completely diminished peak. 


Section:results and discussion