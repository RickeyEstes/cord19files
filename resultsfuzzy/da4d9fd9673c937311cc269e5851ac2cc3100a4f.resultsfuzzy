When the simulated population size was small, there was substantial error between simulated establishment success of the invading strain, and the branching process approximation; however, as population size increased beyond 500, the error between these quantities reduced ( Fig. 8 ) . This behaviour was robust to variations in k , and to R r 0 ( Fig. 7 ) . The most substantial difference was that, particularly at smaller population sizes, the invader had some chance to become established even when R i eff was 1.0; and this was more likely for more heterogeneous individual reproductive capacity distributions. One possible explanation for this is that the empirical distribution of transmissibility in a (small) finite population may not match the generating distribution (and, in particular, the average transmissibility of the invader may be substantially greater than expected). Intuitively, this could occur when the initial invading individual was a 'superspreader' (i.e., an individual with high individual reproductive capacity). Alternatively, the resident strain could fluctuate substantially from the average quasi-stationary behavior (even to the point of being at risk of extinction without the influence of the invader), which would provide windows of opportunity for the invader to establish. Similar phenomena were observed by Humplik et al. (2014) , wherein the resident strain Data : N, k, R r 0 , R i 0 , η, γ = 1 , T max Result : Produces an exact simulation of the epidemic process. initialise: t = 0 ; end U r ← sort (U r ) ; // Existing infectious individuals at time 0 must recover between time 0 and 1, uniformly. Algorithm 1: Algorithm to simulate the full epidemic process. Note that queue () creates an empty queue data structure, push (X , y ) adds element y to the end of queue X , peek (X ) looks at the first value in X (without removing it), and pop (X ) removes the first value in X , and returns it. For simplicity we do not include initialising the first I i individual in this description; it is introduced at time 1, with a transition from a susceptible individual, and its death time and individual reproductive capacity replace the first element in U i and V i , respectively. Comparison between the branching process approximation for invader establishement success, and empirical invader establishment success in simulations of a full epidemic process. The process was simulated for a range of values of k , R r 0 , and R i eff (i.e., R i 0 /R r 0 ), as the total population size, N varied from 100 to 1,0 0 0. The red line indicates the branching process approximation solution. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.) Fig. 8 . Error between the branching process estimate of invader establishment probability, and establishment success in simulations of size N . R r 0 is fixed at 2.0 in these simulations. Error is calculated as 5 R eff =1 ˆ q s (R eff ) − q (R eff ) , where ˆ q s (R eff ) is the proportion of simulations in which establishment was successful at the given R eff level. could become naturally extinct within the lifetime of the invading strain, even without the heterogeneity in reproductive capacity considered here. More broadly, the interactions between N, k , the reproductive capacity of the resident strain, and the effective reproductive capacity of the invader have complex impacts on the correspondence between the branching process approximation and simulation results ( Fig. 8 ) . For intuition around the accuracy of the branching process approximation, we can consider two key drivers. • The size of the population of susceptibles available to the invading strain, early in its outbreak. A remark of Ball and Donnelly (1995) suggests that, in the case they consider, the epidemic grows like a branching process until approximately N 1/2 of individuals in the population are infected. While the process we consider is not the same, we can use this as a heuristic. Rather than the full population, we are interested in the population of susceptible individuals, given the circulation of the endemic disease in the population. We denote this S 0, and note that it is approximately N R r 0 . We observe that for small values of N , the growth of the process can only be approximated by a branching process up to very small outbreaks, e.g., until 7 or fewer infected individuals when N = 100 . • The capacity of the resident strain (or the invader) to persist in the population. In small populations, it is possible for the resident strain itself to become extinct quickly, due to the stochastic nature of disease transmission. As heterogeneity in individual reproductive capacity increases, this becomes more likely to occur, particularly at smaller values of R 0 ( Fig. 10 ). As such, when the invader is introduced, it becomes impossible to distinguish success of the invader strain from natural extinction of the resident; or failure of the invader from successful establishment followed quickly by its natural extinction. In short, the branching process approximation is definitely to be avoided for small population sizes, but can produce reasonable results as population size increases (particularly under conditions when the endemic disease is capable of persisting for substantial time periods). We advise caution, and, where necessary, verifying results through simulation. that, when R i eff is 1.0, or k is 0.1, the branching process approximation underestimates the success of the invader; but when R i eff is large, its success is overestimated, particularly when R r 0 is small. Fig. 10 . Simulated extinction times for the endemic disease process (initiated in equilibrium at time 0), in the absence of the invader strain. Note that the simulation was truncated at time t = 100 , and so outbreaks that persisted at that time, were assigned that extinction time. Lines show median values, error bars indicate 25% and 75% quantiles. 


Section:a1. simulation study results