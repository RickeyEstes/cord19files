For each search example, we present a list of solutions that are ranked highest according to the value of the match score (detailed below). These solutions represent the proteins that are recognized to be most similar to the query. Below, we describe the calculation of the RMSD, which provides some measurement for the quality of the results obtained. In the absence of an overall fold or sequence similarity between the proteins, assessing the correctness of the obtained results is not straightforward. In these cases, there is no exact definition for the similarity between two binding sites. A query-binding region may contain features that are not essential for the binding, which may differ in proteins with exactly the same function. The absence of an exact definition of the pattern we are looking for makes the evaluation of such partial solutions even more complicated. Considering the superimposition between the ligands obtained by an alignment between unrelated proteins can also be misleading. Similar binding sites may accommodate ligands that differ in their size and shape and it is not clear what should be the correct superimposition between them. Figure 8(a) presents an alignment between the ATP ligands of the hexamerization domain of N-ethylmaleimide sensitive factor (1nsf) and cAMP-dependent protein kinase (1atp) obtained by the alignment of the corresponding binding sites. As can be seen in the Figure, the superimposition of the ligand molecules achieves a good alignment between the ribose parts of the ATP molecules while the orientation of the adenine moieties is different. However, when the binding sites are artificially superimposed using the transformation that aligns the adenine moieties, the distance between the phosphate tails of the ATP molecules is approximately 20 Å and only six pseudocenters are identified to be similar (as opposed to nine Figure 8 . Alignment between the ligands induced by the alignment of the binding sites. (a) Alignment between the ATP ligands of hexamerization domain of N-ethylmaleimide sensitive factor (1nsf) and cAMP-dependent protein kinase (1atp) obtained by the alignment of the corresponding binding sites. The colored spheres represent the centers of interaction recognized by the program. The coloring of the spheres is as in Figure 2 . The spheres of 1nsf are smaller. It can be seen that the solution provides a good alignment between the ribose parts of the two ATP molecules at the expense of the alignment between the adenine moieties. (b) Alignment between the NAD and ATP ligands of lactate dehydrogenase (9ldt) and hypothetical protein MJ0577 (1mjh) obtained by the alignment of the corresponding binding sites. The solution provides a good alignment between the ribose parts of the NAD and ATP ligand molecules. However, the adenine ring of ATP is aligned to a nicotinamide ring of NAD, and not to its adenine ring as expected. As can be seen, the resulting alignment provides a superimposition of 13 functional groups, that are depicted as balls. Moreover, it provides an alignment of two conserved residues His40 and Val142 of 1mjh (colored cyan) and His195, Val32 of 9ldt (colored blue) that are located in similar spatial locations. pseudocenters identified by SiteEngine). Therefore, it is not straightforward to identify which solution is the correct one, especially due to the fact that the adenine moiety is known to exhibit two different binding modes. 10 Figure 8 (b) presents an alignment between the NAD and ATP ligands of lactate dehydrogenase (9ldt) and the hypothetical protein MJ0577(1mjh) obtained by the alignment of the corresponding binding sites. Once again, the alignment between the binding sites of the proteins provides an alignment between the ribose parts of the NAD and ATP ligand molecules. However, the adenine ring of the ATP is aligned to the nicotinamide ring of NAD (and not to an adenine ring as expected). This solution provides the alignment of 13 similar centers of interaction shared by these binding regions. Moreover, there are two residues (1mjh, His40, Val142; 9ldt, His195, Val32) that are present in both binding sites and have the same spatial locations as well as identity of the amino acid. Since SiteEngine is a software tool it recognizes regions that maximize the similarity; however, it cannot assess the biological significance of the obtained predictions. These need to be further verified by physical experiments and human expertise. In this section, we compare the results obtained on the two datasets used in this work. The ASTRAL and the benchmark datasets are constructed for different purposes and contain structures with different PDB codes. The benchmark dataset was constructed for the purpose of a thorough evaluation of the method on a set of well-studied examples. Consequently, it contains redundancies that are important for the verification of the consistency and for the analysis of falsenegatives. On the other hand, the ASTRAL dataset contains no proteins with similar sequences and structures. Applying the method to such a representative dataset is important to show the largescale applicability of the method. However, in many cases the proteins of our benchmark dataset were not selected as representative structures and therefore were not included in the ASTRAL dataset. One such example is the set of proteins that are complexed with estradiol. There are 12 such proteins in our benchmark dataset and only one in the ASTRAL. Representatives that are selected for the same protein families do not necessarily bind estradiol, since they may contain mutations that can influence the functional region and can interfere with the binding. This has an impact on the obtained ranking and on our ability to evaluate the results. When searching for regions similar to the adenine-binding site of cAMP-dependent protein kinase (1atp), the five top-ranking solutions obtained on our benchmark dataset (see Table 1 ) are within the ten top-ranking solutions obtained on the ASTRAL dataset. The hypothetical protein MJ0577 (1mjh), which is ranked eighth on the benchmark dataset is 263rd on the ASTRAL. In both datasets these ranks are within the 6% of the best solutions †. Hexamerization domain (1nsf) is ranked eighth (best 8%) on the benchmark dataset and its homologue (1d2n) that binds adenine is ranked 111th (best 3%) on the ASTRAL. Two additional examples are oxidoreductases, which are represented by the PDB codes 1b4v and le6w in the benchmark dataset and by 1gos and 1b16 in the ASTRAL. These are ranked 11th and 13th (best 10%) on the benchmark dataset and 214th (best 5%) and 41st (best 1%), respectively, on the ASTRAL. When searching for regions similar to the ATPbinding site of the hypothetical protein MJ0577 (1mjh) the results are similar to the above. The lactate dehydrogenase (9ldt) that is ranked second on the benchmark dataset (see Table 3 ) is represented by li0z in the ASTRAL and is ranked eighth. Another example is the hexamerization domain (1nsf) that is ranked sixth on the benchmark dataset and is within the 5% of the best solutions. In the ASTRAL dataset, the representative structure of the same family (1d2n) is ranked 339th, which is the upper 8% of the best solutions. Another successful example is the members of the nitrogenase iron protein-like family (1a82, represented by lihu in the ASTRAL dataset) that are ranked seventh on both datasets. In general, there is a similarity of the rankings obtained on the two datasets and results that are within the 10% of the best solutions of the benchmark dataset are within the 10% of the best solutions of the ASTRAL dataset. 


Section:evaluation of the results
Section:analysis of the results obtained
Section:comparison of the experimental results