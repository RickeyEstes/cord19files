ORPs reduce error rates and provide benchmarks for quality scores For all five samples, 3 natural viral and 2 plasmid controls, Illumina paired-end sequencing was carried out using relatively short sequencing fragment libraries combined with relatively long reads (112 bp) to generate overlapping read pairs (ORP). The target DNA fragment in the library preparation was 142 bp. The resulting paired-end reads had an average overlap of 88 bp. Figure 1 illustrates the typical overlap of two paired-end reads. Table 1 and Additional file 1: Table S1 summarize the sequencing output and coverage levels for each read typeraw, ORP and singleton ends --for each sample. The long overlapping regions in the read pairs offered several important practical benefits to improving the quality of the reads. First, they served as a mechanism of error checking, as each read pair came from the same template and should therefore be perfectly complementary. Base calls that do not match in the forward and reverse strands are automatically identified as sequencing errors. Second, although the mismatched bases were excluded from data analysis, they provided an empirical estimate for single-read sequencing error rates. Third, it identified "problematic loci" on the genome where large fractions of the ORPs are mismatched. A high fraction of ORP mismatches at a particular locus would indicate that the locus was a site with high probability of erroneous nucleotide incorporation and hence suggest that a more stringent criterion should be considered when making variant calls at the locus. The relationship between quality score -Phred like scores assigned by Illumina sequencers --and the ORP Figure 1 Example of an 82-base overlapping read pair (in red). Read length is 112 and the insert fragment length is 142. Black lines denote the double stranded DNA insert fragment, numbers between the black lines denote positions in the sequence (from 1 to 142). mismatch frequency is illustrated in Figure 2 for the BCV control data. The fraction of mismatched read pairs at each base dramatically decreased with increasing Qscore. The number of positions in the 1 kb genome where no mismatches occurred jumped from 4 at Q10 to 828 at Q30 (Figure 2 left panel). The probability of a mismatched read pair occurring anywhere during the Illumina paired-end sequencing process was estimated from the ratio of number of mismatched ORPs over the total number of ORPs. These average ORP mismatch rates are shown in Table 2 . While mismatches occurred at the approximate rate of~7 per 1000 unfiltered base pairs; with Q30 filtering, the mismatch rate dropped three orders of magnitude to~4 per 1 million base pairs (averaged over 5 samples). Hence the probability of two sequencing errors occurring at the same read pair is extremely small. The Q-score associated with each base-call is derived based on an aggregate of sequencer metrics and sample characteristics measured during each sequencing run. Q-scores of 10, 20, 30 and 35 correspond to error rates of 0.1, 0.01, 0.001, 0.0003, respectively. The mean mismatch rates among the raw, Q10, Q20, Q30 and Q35 ORPs were 6.7×10 -3 , 8.8×10 -4 , 1.2×10 -4 , 4.0×10 -6 , 2.5×10 -7 , respectively (Table 2, average of 5 samples), far lower than what their Illumina Q-scores suggest. However, when the rabies control plasmid was sequenced a second time, the resulting ORP mismatch rate profile was quite different. Though the mismatch rates were comparable to the first run in the raw, unfiltered ORP reads, they were significantly higher in the second run when comparing the same Q thresholds ( Table 2) . At Q30, ORP mismatch rates in the first run were two orders of magnitude lower than the rabies control repeat run. Given the same model of Next Generation Sequencing instrument (Illumina GA IIx) was used in both sequencing runs, the most parsimoneous explanation for the difference in ORP mismatch rates is the difference in the Q-score calibration of the two instruments. This underscores the utility of using ORP to recover an empirical sequencing error rate and minimize technical artifacts introduced by the sequencer. The trade-off for enhanced accuracy is the reduction in coverage. Since the two overlapping reads represent redundant information from the same amplicon, the true depth of coverage is the number of read pairs instead of number of single reads. For example, in the BCV control sample, the Q-score filtering process removes roughly 11%, 22% and 55% of the raw matching ORPs at each base at Q10, Q20 and Q30, respectively (see Additional file 1: Figure S1 ). ORPs help distinguish PCR error rates from sequencing error rates Figure 3 shows the Q-score distributions for all matching ORPs (blue), mismatched ORPs (red) and those matching ORPs that were erroneous (green) in the BCV control data (representative sample). Matching read pairs were labeled erroneous when they disagreed with the consensus nucleotides in the control plasmid. Consistent with Figure 2 , the number of mismatched ORPs decreased with Q-scores while the number of matching ORPs increased with Q-scores. In contrast, the number of erroneous matching ORPs was relatively constant with respect to Q-scores, which suggests that they were dominated by PCR errors and not sequencing errors. Furthermore, Figure 3 shows that at Q ≥ 30, the number of mismatched ORPs (sequencing error) became dramatically lower than the number of erroneous matching ORP (PCR error). This provided an empirical guideline for the selection of Q-score threshold, above which PCR error rate clearly exceeds the sequencing error rate. The two plasmid clones were sequenced at ultra-deep coverage to serve as controls in the study. At a given Table 2 Overall mismatch rates in overlapping paired-end reads for raw read pairs, read pairs that have quality scores Q10, Q≥20, Q≥30 and Q≥35 Average of 5 samples The rabies control plasmid was sequenced a second time using a separate protocol at a different service provider and listed here for comparison. Mismatch rates are 'per base pair' so that they can be compared directly across samples and platforms. Phred error rates for the Q scores are shown in the heading. Figure 3 Q-score distributions for all matching (blue), mismatched (red) and erroneous matching (green) overlapping read pairs in the BCV control sample. Note, the Q-score of 2 is a 'read segment control indictor' in the FASTQ format that tags specific final portion of the read as unreliable and unfit for downstream analyses [41] . That Q=2 reads comprised a disproportionally large fraction of mismatched read pairs (red) is consistent with the fact that mismatched ORPs result from error during sequencing. locus, any polymorphisms in the ORPs that deviated from the known consensus nucleotide are taken as errors introduced either through PCR amplification or sequencing. (Since only matching ORPs are considered here, these polymorphisms are erroneous matching read pairs.) The mean probability of such an error was estimated from the fraction of erroneous calls among all calls made across the control plasmid, which later served as the baseline error rate in our variant detection model. Another useful statistic is the maximum per base-call error ratefrequency of the erroneous base-call with the highest frequency in the control plasmid --which provided an upper bound on the combined PCR and sequencing error that occurred at a single locus. Table 3 summarizes these error rates in the control plasmids at Q10 and Q30 for ORP and the two single reads that make up the read pairs. Notably, the maximum per base-call ORP error at Q10 and Q30 were comparable, which suggests this error was fairly stable and did not improve with Q-score. This result paralleled the finding that the frequency of erroneous matching ORP was relatively constant with Q-scores ( Figure 3 ). Together, they suggest that the maximum per base-call errors observed in matching ORPs was likely produced by PCR. As expected, matching ORPs have reduced error rates compared to the two single reads that make up each read pair. At Q10, this reduction is 3 fold in the mean error rate and one to two orders of magnitude in the maximum error rate (Table 3 ). Figure 4 shows the cumulative distribution of per base-call errors in the matching ORP and single reads thresholded at Q = 10, 20 and 30. The read accuracy improvement of using ORP over single reads, revealed as a gap between their respective error profiles, was most prominent at Q10 and diminished with higher Q-score filtering; the advantage at Q30 was small yet still highly significant (twosample Kolmogorov-Smirnov test p = 5×10 -36 and 2×10 -11 for rabies and BCV control, respectively), as any reduction in error rate can be used to detect viral variants with greater sensitivity. In our data, error rates in Q30 single reads were equivalent with Q20 ORP reads. This equivalence, however, may not be generalizable to other data sets due to variations in Q-score metrics shown earlier ( Table 2) . Our variant detection model uses a position-dependent error rate that takes the mismatch rate found at each base into consideration (Methods). Before applying this model on the natural samples, we applied it to the control data and determined that the false positive rates associated with 3 error rates, 5×10 -5 , 1×10 -4 and 5×10 -4 were 2.45%, 0.75% and 0%, respectively (Additional file 1: Table S2 ). This suggests that the mean Q30 ORP error rate of~5×10 -5 estimated from the control data (Table 3) was not conservative enough to eliminate all false positive variant calls, possibly due to PCR errors. Based on these observations, we made variant calls in the three natural viral samples using both 5×10 -5 and a more conservative error rate of 5×10 -4 , where the former represented the mean overall error rate and the latter approximated the PCR error rate. Rare variants found at 10-13% of the genomes in the natural viral samples Our variant detection model predicted 2133, 1354 and 1596 sub-consensus variants for the BCV, Fox1 and Fox2 natural viral samples, respectively (Table 4) using the error rate 5×10 -5 , and 152, 70 and 88 variants for BCV, Fox1 and Fox2 at the higher error rate of 5×10 -4 . The coverage-adjusted false positive rates for the error rates 5×10 -4 and 5×10 -5 are estimated to be 0% and < 2% (derived from running the model on the plasmid controls, Additional file 1: Table S2 ). Assuming a conservative false positive rate of 2%, then between 300 to 400 of the variants called at 5×10 -5 are false positives, leaving a possibly true viral variant pool of 1724, 1063, 1187 variants for the BCV, Fox1 and Fox2 natural viral samples, respectively. These pools are over one order of magnitude larger than those predicted at the higher error rate of 5×10 -4 and represent point mutations in 10-13% of the genomes. The distributions of the rare variant frequencies provide additional insight to the dramatic difference in the number of variants called at these two error rates. Figure 5A shows that most of the variants detected at 5×10 -5 were far more rare than the least frequent variants detected at 5×10 -4 . This means, the higher error rate of 5×10 -4 was not sensitive enough to detect the Mean and maximum error rates at Q10 and Q30 are listed for matching ORP as well as the forward and reverse reads that make up the read pairs. majority of the mutations detected at the lower error rate of 5×10 -5 , which existed at frequencies below 0.05%. Recovering the bulk of these 'ultra-rare' viral mutations, however, requires considerable extra efforteither through reduced error rate or increased coverage. Since for most viral evolution study designs it may not be practical or necessary to sequence viral samples at the coverage level used in this paper, we estimated the theoretical coverage required to achieve specific variant detection sensitivity under three error rates: 5×10 -5 , 1×10 -4 , and 5×10 -4 . Predictions are based on a binomial error model with a fixed Bonferroni correction factor (assuming 11,000 candidate variants detected in every case) and shown in Figure 5B . For instance, at 20,000x coverage (matching ORP), the maximum sensitivity, or the rarest variants that can be detected at these three error rates have population frequencies of 0.05%, 0.065% and 0.145%, respectively, with the lowest error rate (5×10 -5 ) being the most sensitive and the highest error rate (5×10 -4 ) being the least sensitive. As shown in Figure 4 , accuracy of Q30 single reads is comparable to that of Q20 ORPs. In the scenario of 20,000x ORP coverage, if non-overlapping read pairs had been generated during sequencing, in theory, the number of Q30 single reads could potentially double the coverage to 40,000x. At the error rate of 5×10 -5 , the maximum sensitivity for variant detection in these Q30 single reads would be 0.03% instead of 0.05%. The cost of this increased coverage by generating non-overlapping read pairs is losing the benefit of context-specific error estimation and correction afforded by the overlapping read pairs. The accuracy comparison between Q20 ORPs and Q30 single reads observed in our data set was only established because ORPs were used. Any accuracy equivalence between single reads and ORP has to be carefully re-established for the specific sequencer being used.  


Section:results and discussion