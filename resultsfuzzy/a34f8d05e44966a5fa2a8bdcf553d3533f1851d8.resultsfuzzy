Reconstruction accuracy depending on nt for a variety of networks. Supplementary Figs. 2 and 3 show the success rates of reconstructing a number of model and real networks as a function of the fraction nt of base strings. For all networks studied, high recovery accuracy in a wide range of the values of nt is achieved. However, for nt close to unity, there is a slight decrease in the success rates. This can be attributed to the intrinsic characteristics of the compressed-sensing algorithm. Recall that compressed sensing is developed for solving under-determined systems with many more unknowns than the number of equations [12] . In order to assure a unique solution of the under-determined system, the constraint of sparsity must be imposed. Mathematically, if under such a constraint a unique solution indeed exists, the compressed-sensing framework enables recovery of the solution. For nt = 1, the matrix Φ becomes a square matrix, indicating that the system is no longer under-determined. Although the compressedsensing algorithm is not restricted to under-determined systems, our results demonstrate that it performs better for under-determined systems than for nt = 1, as reflected by the decrease in the success rates when nt approaches to unity. However, since our method would typically be applied with limited data, the reconstruction accuracy can be still assured by using nt < 1 (so that nt = 1 is naturally avoided) in the process of setting up the compressed-sensing equation Y = Φ · X. Minimum length of time series. Figure 4 shows the minimum absolute length t min of time series required for achieving 95% success rate of the geometric averages of SREL and SRNC versus the network size N for SIS and CP dynamics on NW and BA networks. It can be seen that t min increases slightly as N is increased and the slope in a logarithmic plot is much less than 1, indicating low data requirement even for large networks. This can be explained by the fact that different base strings may share some common strings in the reconstruction. The relative minimum length n min t resulting from t min /N is shown in Figs. 3(c,d) in the main text. One can see that n min t is considerably reduced as N is increased. In general, when a sufficient number of base strings are available so that other strings can be chosen using the threshold parameters in time series, our reconstruction method can offer quite high accuracy, nearly regardless of the network size. Success rates affected by average node degree. Supplementary Fig. 5 shows the success rates as a function of the average node degree ⟨k⟩ for SIS and CP dynamics on ER, NW and BA networks. The success rates decrease from 1 slightly as ⟨k⟩ is increased to a large value, e.g., ⟨k⟩ = 18. The slight decrease is due to two factors. First, for high values of ⟨k⟩, the vector X is less sparse, leading to small prediction errors under the compressed-sensing paradigm. Second, for a node with a large number of neighbors, the probability of its being infected at each time is large, insofar as a fraction of its neighbors are in the infected state. In this case, it is difficult to ascertain which neighbor passes the disease to the node. For example, in the extreme case where a node remains infected all the time, it is practically impossible to determine from which of its neighbors the infection comes. The combined effect of the two factors accounts for the small decrease in the success rates with the increase of ⟨k⟩. In scale-free networks, a small fraction of hub nodes are usually more difficult to be reconstructed because of the many neighbors that each hub possesses, leading to slightly lower success rates than those associated with ER and NW networks of similar average degree (e.g., ⟨k⟩ < 14). However, for larger values of the average degree, scale-free networks perform better than the other two types of networks. This can be understood, as follows. In a scale-free network, the heterogeneous degree distribution indicates that most nodes have small degrees. In contrast, in the ER and NW networks, the degree distributions are approximately homogeneous. Thus, for the same value of ⟨k⟩, the degrees of most nodes in scale-free networks are less than those in the ER and NW networks, resulting in slightly larger success rates when reconstructing scale-free networks. In fact, in the presence of high-degree nodes, we can provide a heuristic method to improve the success rates by taking advantage of the "conflicts" arising when matching the neighborhoods of different nodes, since the neighborhood of each node is recovered independently of others. The errors in the reconstruction of the whole network will induce certain inconsistency in predicting the presence/absence of links among nodes. Due to the relatively large reconstruction errors associated with higher-degree nodes, it is reasonable to accept the predicted links centered at smaller-degree nodes rather than that centered at high-degree nodes whenever such a conflict arises. This way the errors associated with high-degree nodes can be considerably reduced. This method can further improve the reconstruction accuracy of scale-free networks or in any networks where a small set of high-degree nodes exist. Reconstruction of vector X in the presence of partially unobservable nodes. Supplementary Fig. 6 shows the element values in the reconstructed vector X when there are missing time series. In principle, the local connection topology of nodes without time series are impossible to be reconstructed. We thus remove these nodes together with their links from the network and reconstruct the rest of network. Interestingly, we find that even when half of nodes' time series are missing, i.e., n m = 0.5, there is still a clear gap between the predicted values of actual links and null connections. This phenomenon suggests that missing time series only affect the width of the gap, but otherwise has little influence on the reconstruction. Indeed, in Figs. 4(c,d) in the main text, the success rates remain close to 1 as n m is increased. We stress that the externally inaccessible nodes are somewhat similar to the hidden source in the sense that their time series are not available. The difference between the hidden source and the unobservable nodes lies in the fact that the source is always infected with relatively higher probability to pass the disease to its neighbors. The absence of connection from the source when establishing the reconstruction form of its immediate neighbors results in the large structural variance that becomes the fingerprint of the immediate neighbors. In contrast, the effect of unobservable nodes is relatively minor as compared to that of the hidden source, so their connections to the other observable nodes are difficult to be inferred. Consequently, in the presence of externally inaccessible nodes, the structural variance still allows us to exclusively locate the hidden source. Robustness with respect to fluctuation in infection rates. We have also investigated robustness of our reconstruction method with respect to errors in specification of the underlying diffusion process. This is of practical importance, since it is not possible to describe any realistic dynamical process by mathematical model with perfect accuracy. To be concrete, we assume that, in the spreading process, the infection rate λ of each node exhibits random fluctuations in a range with probability p λ at each time step. In this case, ideally the standard SIS and CP dynamics are no longer applicable. However, since such fluctuations are not known a priori, we reconstruct the dynamical process as if the infection rates were constant. This way the effect of model errors can be assessed. Supplementary Fig. 7 shows the success rate of network reconstruction as a function of p λ . We see that quite satisfactory reconstruction of the network structure can still be achieved, regardless of the value of p λ . This result holds for both SIS and CP processes on small-world and scale-free networks, suggesting that our reconstruction method is applicable to real propagation processes in spite of model errors. 


Section:supplementary note 5: additional results of network reconstruction