Spreading processes. The SIS model is a classic epidemic model that has been used frequently to study a variety of spreading behaviours in social and computer networks. Each node of the network represents an individual and links are connections along which infection can propagate to others with certain probability. At each time step, a susceptible node i in state 0 is infected with rate l i if it is connected to an infected node in state 1. If i connects to more than one infected neighbour, the infection probability P 01 is given by equation (4) . At the same time, infected nodes are continuously recovered to be susceptible at the rates d i . The CP model has been used extensively to describe, for example, the spreading of infection and competition of animals over a territory, where l i is determined by equation (7). The main difference between SIS and CP dynamics lies in the influence on a node's state from its vicinity. In both SIS and CP dynamics, l i and d i depend on the individuals' immune systems and are selected from a uniform distribution characterizing the natural diversity (see Supplementary Note 7 for details of numerical simulations). Moreover, a hidden source is regarded as infected for all time. Mathematical formulation of reconstruction based on CST. For SIS dynamics, suppose measurements at a sequence of times t ¼ t 1 , t 2 , Á Á Á , t m are available. equation (5) leads to the following matrix form Y m Â 1 ¼ U m Â (N À 1) Á X (N À 1) Â 1 : ; where the vector X (N À 1) Â 1 contains all possible connections between node i and all other nodes, and it is sparse for a general complex network. We see that if the vector Y m Â 1 and the matrix U m Â (N À 1) can be constructed from time series, X (N À 1) Â 1 can then be solved by using CST. The main challenge here is that the infection probabilities P 01 i ðtÞ at different times are not given directly by the time series of the nodal states. To devise a heuristic method to estimate the probabilities, we assume that the neighbouring set G i of the node i is known. The number of such neighbouring nodes is given by k i , the degree of node i and their states at time t can be denoted as S Gi ðtÞ fS 1 ðtÞ; S 2 ðtÞ; Á Á Á ; S ki ðtÞg: ð11Þ To approximate the infection probability, we use S i (t) ¼ 0 so that at t þ 1, the node i can be infected with certain probability. In contrast, if S i (t) ¼ 1, S i (t þ 1) is only related with the recovery probability d i . Hence, we focus on the S i (t) ¼ 0 case to derive P 01 i ðtÞ. If we can find two time instants: t 1 , t 2 AT (T is the length of time series), such that S i (t 1 ) ¼ 0 and S i (t 2 ) ¼ 0, we can then calculate the normalized Hamming distance H½S Gi ðt 1 Þ; S Gi ðt 2 Þ between S Gi ðt 1 Þ and S Gi ðt 2 Þ, where the normalized Hamming distance between two strings of equal length is defined as ratio of the number of positions with different symbols between them and the length of string. If H½S Gi ðt 1 Þ; S Gi ðt 2 Þ ¼ 0, we can regard the states at the next time step, S i (t 1 þ 1) and S i (t 2 þ 1), as i.i.d Bernoulli trials. In this case, using the law of large numbers, we have lim l!1 1 l X l n¼1 S i ðt n þ 1Þ ! P 01 i ðt a Þ; 8 t n ; S i ðt n Þ ¼ 0; H½S Gi ðt a Þ; S Gi ðt n Þ ¼ 0: ð12Þ A more intuitive understanding of (equation (12)) is that if the states of i's neighbours are unchanged, the fraction of times of i being infected by its neighbours over the entire time period will approach the actual infection probability P 01 i . Note, however, that the neighbouring set of i is unknown and to be inferred. A strategy is then to artificially enlarge the neighbouring set S Gi ðtÞ to include all nodes in the network, except i. In particular, we denote S À i ðtÞ fS 1 ðtÞ; S 2 ðtÞ; . . . ; S i À 1 ðtÞ; S i þ 1 ðtÞ; . . . ; S N ðtÞg: If H[S À i (t 1 ), S À i (t 2 )] ¼ 0, the condition H½S Gi ðt 1 Þ; S Gi ðt 2 Þ ¼ 0 will be ensured. Consequently, due to the nature of i.i.d Bernoulli trials, from the law of large numbers, we have S i ðt n þ 1Þ ! P 01 i ðt a Þ; 8 t n ; S i ðt n Þ ¼ 0; H½S À i ðt a Þ; S À i ðt n Þ ¼ 0: Hence, the infection probability P 01 i ðt a Þ of a node att a can be evaluated by averaging over its states associated with zero-normalized Hamming distance between the strings of other nodes at some time associated witht a . In practice, to find two strings with absolute zero-normalized Hamming distance is unlikely. We thus set a threshold D so as to pick the suitable strings to approximate the law of large numbers, that is P 01 i ðt n Þ; 8 t n ; S i ðt n Þ ¼ 0; H½S À i ðt a Þ; S À i ðt n ÞoD; ð14Þ where S À i ðt a Þ serves as a base for comparison with S À i (t) at all other times and 1 l P l ) 1 n¼1 P 01 i ðt n Þ ' P 01 i ðt a Þ. As H½S À i ðt a Þ; S À i ðt n Þ is not exactly zero, there is a small difference between P 01 i ðt a Þ and P 01 i ðt n Þ ðn ¼ 1; Á Á Á ; lÞ. We thus consider the average of P 01 i ðt n Þ for all t n to obtain P 01 i ðt a Þ, leading to the right-hand side of equation (14) . We denote hS i ðt a þ 1Þi ¼ 1 To reduce the error in the estimation, we implement the average on S À i (t) over all selected strings through equation (14) . The averaging process is with respect to the nodal states S j, j,ai (t) on the right-hand side of the modified dynamical equation (5) . Specifically, averaging over time t restricted by equation (14) on both sides of equation (5), we obtain hln½1 À P 01 i ðtÞi ¼ lnð1 À l i Þ P N j¼1;j 6 ¼ i a ij hS j ðtÞi. If l i is small with insignificant fluctuations, we can approximately have ln½1 À hP 01 i ðtÞi ' hln½1 À P 01 i ðtÞi (see Supplementary Fig. 10 and Supplementary Note 8), which leads to ln½1 À hP 01 i ðtÞi ' lnð1 À l i Þ P N j¼1;j 6 ¼ i a ij hS j ðtÞi. Substituting hP 01 i ðt a Þi by hS i ðt a þ 1Þi, we finally get ln½1 À hS i ðt a þ 1Þi ' lnð1 À l i Þ Á X N j¼1;j 6 ¼ i a ij hS j ðt a Þi: ð15Þ Although the above procedure yields an equation that bridges the links of an arbitrary node i with the observable states of the nodes, a single equation does not contain sufficient structural information about the network. Our second step is then to derive a sufficient number of linearly independent equations required by CST to reconstruct the local connection structure. To achieve this, we choose a series of base strings at a number of time instants from a set denoted by T base , in which each pair of strings satisfy wheret a andt b correspond to the time instants of two base strings in the time series and Y is a threshold. For each string, we repeat the process of establishing the relationship between the nodal states and connections, leading to a set of equations at different values oft a in equation (15) , as described in the matrix form (equation (6)). See Supplementary Fig. 11, 12 and Supplementary Note 8 for the dependence of success rate on threshold D and Y for SIS and CP dynamics in combination with four types of networks. Inferring inhomogeneous infection rates. The values of the infection rate l i of nodes can be inferred after the neighbourhood of each node has been successfully reconstructed. The idea roots in the fact that the infection probability of a node approximated by the frequency of being infected calculated from time series is determined both by its infection rate and by the number of infected nodes in its neighbourhood. To provide an intuitive picture, we consider the following simple scenario in which the number of infected neighbours of node i does not change with time. In this case, the probability of i being infected at each time step is fixed. We can thus count the frequency of the 01 and 00 pairs embedded in the time series of i. The ratio of the number of 01 pairs over the total number of 01 and 00 pairs gives approximately the infection probability. The infection rate can then be calculated by using equations (4) and (7) for the SIS and CP dynamics, respectively. In a real-world situation, however, the number of infected neighbours varies with time. The time-varying factor can be taken into account by sorting out the time instants corresponding to different numbers of the infected neighbours, and the infection probability can be obtained at the corresponding time instants, leading to a set of values for the infection rate whose average represents an accurate estimate of the true infection rate for each node. To be concrete, considering all the time instants t n associated with k I infected neighbors, we denote S ðkIÞ i ¼ ð1=lÞ P l n¼1 S i ðt n þ 1Þ, 8 t n , P j2Gi S j ðt n Þ ¼ k I and S i (t n ) ¼ 0, where G i is the neighbouring set of node i, k I is the number of infected neighbours and S  where L i denotes the set of all possible infected neighbours during the epidemic process and N Li denotes the number of different values of k I in the set. Analogously, for CP, we can evaluate l true i from equation (7) by l true i ðCPÞ % hl where k i ¼ P N j¼1 a ij is the node degree of i. Insofar as all the links of i have been successfully reconstructed, S ðkIÞ i can be obtained from the time series in terms of the satisfied S i (t n þ 1), allowing us to infer l true i via equations (17) and (18) . Note that the method is applicable to any type of networks insofar as the network structure has been successfully reconstructed. Networks analysed. Model networks and real networks we used are described in Supplementary Note 10 and Table 1 . 