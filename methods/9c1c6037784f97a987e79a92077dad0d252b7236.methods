Protocols and reaction schemes for the chemical synthesis of compounds 1-21 as well as other methodological information are reported in the Supplementary Methods. For characterization and purity of the compounds in this article, see Supplementary Figs 4-29. Identity and purity (495%) of all compounds were determined by chromatography (silica or RP-18 HPLC), by fully assigned 1 H-and 13 C-NMR spectra and by high-resolution mass spectra. Protein assays were performed with recombinantly expressed viral proteases. Negative control sets (omission of protease), positive control sets (omission of inhibitor), and controls for autofluorescence of substrate or inhibitor were carried out and did not interfere with the assay readout unless noted otherwise. K M -and v max -values were determined by double reciprocal plotting of the measured activity against the concentration of substrate (Lineweaver-Burk). Enzyme kinetics were determined with a Fluorimeter SAFIRE II from Tecan (Crailsheim, Germany). Assays were conducted on polystyrene 384-microtiter plates from Corning (model 3,544). Mass spectrometry of protein-inhibitor samples. High-resolution mass spectra were recorded on a Synapt G2-S HDMS by Waters Co. (Milford, UK) equipped with an Acquity UPLC and a Phenomenex Jupiter C-18 column (3 Â 250 mm, 5 mm, 300 Å). The ionization and transfer parameters of the MS system have been optimized for a standard sample (insulin) and were applied without modification. Deconvolution of measurement results was performed by the MaxEnt1 method of the MassLynx software by Waters Co. The most important source parameters are: capillary voltage: 3.3 kV, sampling cone: 40 V, source offset: 60 V, source temperature: 100°C, desolvation temperature: 250°C, desolvation gas flow: 600 l h À 1 . Chromatographic conditions: start 95% solvent A, within 35 min linear gradient to 1% solvent A, 5 min 1% solvent A, within 4 min back to 95% solvent A. Solvent composition: A-water, 0.1% formic acid; B-acetonitrile, 0.1% formic acid. Flow rate: 0.5 ml min À 1 . For mass spectra of protease-inhibitor complexes in this article, see Supplementary Figs 30-35. Recombinant protein production and purification. The enzymatically active 3C protease of Coxsackie virus B3 consisting of 183 amino-acid residues and carrying an additional C-terminal sixfold histidine tag was expressed from the plasmid pET-23a( þ ) (Novagen). The cDNA of the 3C protease corresponds to GenBank accession no. M88483.1. Protein production and purification followed standard conditions. Briefly, a clone of BL21(DE3) E. coli cells transfected with the coding plasmid was grown in LB medium in the presence of ampicillin (100 mg ml À 1 ) until OD 600nm reached 0.6. Expression was induced by adding IPTG to a final concentration of 1 mM and further incubation was carried out for 4 h at 37°C. Cells were harvested by centrifugation and lysed by ultrasonication in 25 mM Tris-HCl pH 7.5/50 mM NaCl/1% (v/v) Triton X-100/10% (v/v) glycerol/2 mM DTT. The extract was clarified by centrifugation and separated on NiNTA agarose (Qiagen) in 50 mM Tris-HCl pH 8.0/500 mM NaCl applying a step gradient of 50 to 500 mM imidazole. Eluates of highest volume activity were pooled and further separated on a preparative Superdex 75 column (GE Healthcare) equilibrated in 25 mM HEPES-NaOH pH 7.5/50 mM NaCl. The final pool of recombinant protease was adjusted to 20% (v/v) glycerol and frozen in aliquots at À 80°C until use. EV-B93 3C protease expression and purification was conducted as previously described 41 . Other proteases were obtained from the European Virus Archive (http://www.european-virus-archive.com/). Assay for template-assisted assembly of protease inhibitors. The activity of the protease was measured by hydrolysis of the FRET-substrate N-Dabcyl-KTLEALFQkGPPVYE(Edans)-NH 2 . The peptide was purchased from Biosyntan (Berlin, Germany). Samples were irradiated with light with a wavelength of 355 nm and the emitted light at 538 nm was measured in relative fluorescence units (RFUs). An amount of 100 pmol of cleaved substrate equals 5,000 RFU. Assay samples contained 10 ml of a 100 mM HEPES-NaOH buffer solution pH 7.5/1 mM EDTA, 10 ml enzyme solution (2 mM CVB3 3C Pro ), 10 ml of 10 mM substrate solution (both dissolved in the above buffer) and 1 ml Inhibitor and/or fragment dissolved in DMSO. For assay results of a dilution series of a mixture of 1 and 2 and comparison of reaction products in dependence of the assay solvent, see Supplementary Figs 1 and 2 . The screening procedure consisted of the following steps: 10 ml 100 mM HEPES-NaOH buffer solution pH 7.5/1 mM EDTA was placed in a cavity of the 384-well plate (polystyrene, Corning 3544). Then 10 ml of enzyme solution (40 mM CVB3 3C protease in 100 mM HEPES-NaOH buffer solution, pH 7.5/1 mM EDTA) was added and the plate was shaken for 2 min at 1,400 r.p.m. Afterwards, 0.5 ml of a DMSO solution of the electrophilic probe and 0.5 ml of a DMSO solution of the nucleophile was added, followed by 10 ml of substrate solution (10 mM in 100 mM HEPES-NaOH buffer solution, pH 7.5/1 mM EDTA). The plate was shaken again for 2 min at 1,400 r.p.m. and the generated fluorescence signal was measured with a Safire II Fluorimeter from Tecan. The electrophilic probe 1 was used at a concentration of 400 mM for the screening, which lowered the protease activity by 10-20%. Eight-hundred fifty primary amines were tested at a concentration of 320 mM and fragment 2 amplified the inhibitory activity of 1 most potently. Positive control samples contained only DMSO instead of the probe or the nucleophile. Negative control samples contained no active enzyme. An interfering fluorescent effect has not been observed. When determining the inhibitory parameters of an inhibitor, the assay set-up was as mentioned but 1 ml DMSO solution of inhibitor was used instead of probe or nucleophile. Different concentrations of inhibitor were tested at least as duplicates and the pseudo-first-order association kinetics (k obs ) were determined using GraphPad Prism. The slope of a plot of the different k obs values against the inhibitor concentration yielded k inact /K I . In vitro proteolytic activity assay. A volume of 100 ml of reaction mixture containing 1.9 mM 3C protease, 25 mM substrate peptide, 5% DMSO, buffer (30 mM Tris pH 8.0, and 50 mM NaCl or 50 mM HEPES pH 7.4 and 50 mM NaCl) and (optionally) different concentrations of inhibitor was incubated in 37°C during 3 h. The reaction was quenched by addition of 0.5% (final concentration) TFA. Samples were analysed by HPLC on SOURCE 15RPC ST 4.6/100 column using: 2-90% linear gradient of ACN in 0.1% TFA. The 3C protease activity in the absence of inhibitor was defined as 100%. The following peptides (GL Biochem, Shanghai, China) were dissolved in DMSO at a concentration of 5 mM and used for testing 3C proteases activity ( Table 3) . Reaction of EV-B93 3C protease with inhibitor 14. The EV-B93 3C protease was mixed with a 12-fold molar excess of the inhibitor and incubated overnight at 30°C. The complex was purified by gel filtration (Superdex 75 10/300, GE Healthcare) in 10 mM Tris, pH 8.0, 200 mM NaCl, 2 mM DTT. The collected fractions were concentrated to 2.3 mg ml À 1 for crystallization. Crystallization and structure determination. Crystals were grown by the sittingdrop vapour diffusion method at 20°C by mixing equal volumes of protein solution and reservoir solution containing 25% polyethylene glycol 3,350, 0.2 M ammonium acetate, and 0.1 M Bis-Tris, pH 6.5. Crystals were transferred to cryoprotectant solution comprising mother liquor and 25% glycerol for a few seconds and flash-cooled in liquid nitrogen. X-ray diffraction data were collected at beamline XALOC at the ALBA synchrotron (Cerdanyola del Vallès, Barcelona) ( Table 4 ). Diffraction data were indexed and integrated using XDS 42 , and scaled and merged with SCALA 43 . Structure elucidation and refinement were carried out using the CCP4 suite of programs 44 . The initial phases were obtained by molecular replacement using PHASER 45 with the previously solved EV-B93 3C structure as search model (PDB code: 3Q3X) 41 . REFMAC 46 was employed for structure refinement and Coot 47 for interpretation of electron density and model building. Geometry restraint information for 14 was generated with SKETCHER within CCP4. For a stereo image of the electron density map of the binding site of the protease-inhibitor complex see Supplementary Fig. 36 . The crystal structure was validated with MolProbity 48 and showed 98.1% of all residues in Ramachandranfavoured and 100.0% in Ramachandran-allowed regions. Protein ligand docking analysis. Protein Data Bank 49 entry 3ZZA was used as structure for the CVB3 3C protease. For a detailed binding confirmation of inhibitors 12 and 20 by ligand docking, see Supplementary Fig. 3 . Docking was performed using GOLD v 5.0.2 by the Cambridge Crystallographic Data Center (Cambridge, UK, Europe) after protein preparation using MOE version 2,014.09 (ref. 50). The binding site was defined using a radius of 10 Å around the sulfur atom of cysteine 147. Docking was carried out using the PLP scoring function 51 with 25 GA runs per ligand in the most accurate mode without water molecules and default parameter settings. Covalent docking was performed by constraining the sulfur atom in the ligand and cysteine 147 to share the same position coordinates. Docking poses were analysed and prioritized for S1 pocket binding and putative covalent bond formation using 3D pharmacophore models developed in LigandScout version 4.0 (ref. 52) based on crystal structures of the CVB3 3C protease (3ZZ6, 3ZZ7, 3ZZ8, 3ZZ9, 3ZZA, 3ZZB). Graphical representations of selected conformations were generated using the PyMOL Molecular Graphics System, Version 1.7.4 Schrödinger, LLC. Data availability. Data supporting the findings of this study are available within the article and its Supplementary Information files and from the corresponding author upon reasonable request. The crystal structure presented within this article is deposited under PDB code 5IYT. Ac-AKDGGIFAQkSRDRHYLVGTV-NH 2 HRV-A49 3C Ac-RHSVGATLEALFQkGPPVYREIKIS-NH 2 EV-D68 3C Ac-RHSVGATLEALFQkGPPVYREIKIS-NH 2 AiV-1 3C Ac-RHSVGATLEALFQkGPPVYREIKIS-NH 2 PSV-1 3C Ac-RHSVGATLEALFQkGPPVYREIKIS-NH 2 EV-B93 3C Ac-RHSVGATLEALFQkGPPVYREIKIS-NH 2  