Reference profile collection. Resources containing expression profiles of host cellular responses to pathogenic infections were collected by manual searching and expert reviewing of dataset descriptions in the Gene Expression Omnibus database. To limit our analysis to genome-wide gene expression changes, the gene expression profile data were produced with only Affymetrix Human Genome U133A Array and U133 Plus 2.0 Array platforms. Our criteria for project inclusion were threefold: (1) at least one sample of untreated specific pathogen infection with infectious disease state or in vitro infection for at least 1 h; (2) at least one control sample (e.g. uninfected, mock-infected, healthy control or other blank control); (3) data processing methodology clearly defined in series matrix file, data values in series matrix file distributed in a regular fashion (e.g., log-scale distribution for count values processed with MAS5; approximate normal distribution for log-transferred values processed with RMA), and no more than 1% of data values missing. And the original data collected were provided in our lab website(http://biotech. bmi.ac.cn/papers/2015/luhan.html). Generating PRLs. Each pair of samples containing one infection sample and one corresponding control sample was considered an instance. We paired infection samples and control samples in accordance with five principles: (1) Very early infection sample measurements (< 1 h) were not taken. The intersection of probes for each dataset was generated to obtain the final probes shared by all datasets. Sample data values from series matrix files were transformed into count values if they had been log transformed. The probes were ranked according to the expression change produced by comparing corresponding infection and control samples. First, sub threshold instance values were set to a threshold value. The 25 th percentile level of the instance was selected as the corresponding threshold value. Next, probe sets were ranked in descending order of the corresponding perturbation-to-control value ratios. For probe sets with a ratio that equaled one, a lower threshold (the 25 th percentile divided by 10) was applied. Finally, the probe sets were subsorted in descending order of the new ratio calculated. The Figure  S1 ). An iterative process was applied to merge PRLs of the same pathogen by building a minimum spanning tree in accordance with the Kruskal algorithm strategy 50 and merging the PRLs of each pathogen with a minimum spanning tree in accordance with the Borda merging method 12, 13, 51 . In the iterative process, the two PRLs with the closest Spearman's footrule values were combined and replaced by a single PRL. This iterative process was repeated until only one mPRL remained. The Borda merging method is a consensus-based voting algorithm. For PRLs A and B, the ranking of all probe identifiers (P 1 , P 2 , P 3 ,…, P m ) would be A 1 , A 2 , A 3 ,…, A m and B 1 , B 2 , B 3 ,…, B m , respectively. The ranking weight of P i was defined as follows: A new ranked list, the mPRL of all probe identifiers, was obtained by sorting W 1 , W 2 , W 3 ,…, W m in increasing order. PRLs for the same pathogen, across different host cell types and from different labs, were combined into a single PRL in R package GeneExpressionSignature software 22 such that the HTRs of each individual pathogen were combined according to a hierarchical majority-voting scheme as described previously 15, 22 . A single synthetic mPRL was computed by merging all the PRLs referring to the same pathogen, such that genes that were consistently up-or down-regulated across individual PRLs were placed at the top or bottom, respectively, of the mPRL. PRLs of different strains or subtypes of the same pathogen species were computationally merged if their expression profiles from centralized projects were similar to each other. For example, the PRLs of several subtypes of oncogenic human papillomavirus (HPV), including HPV-16, HPV-18, HPV-31, HPV-33, HPV-35, HPV-58, HPV-66, were merged for the HPV infection HTR profile. We calculated Spearman correlation coefficients between the mPRL and individual component PRLs to see if the mPRL captured the infection features of the component PRLs. Theoretically, an mPRL for a specific pathogen should correlate strongly with the component PRLs for the same pathogen, and relatively more weakly with component PRLs for other pathogens. That is, in an ROC depicted with individual component PRLs as benchmarks, the AUC should approach 1. We found that the AUCs for 38/50 component pathogens were 1, and 45/50 were > 0.9, with an average AUC of > 0.97 for all 50 pathogens (Supplementary Figure S5) . Calculating HTR similarities across pathogen pairs. We represented pathogen-to-pathogen HTR relationships as association scores computed with a GSEA-based PRL comparing method 10, 11, 14 . A signature was extracted for each pathogen, where a signature refers to a group of genes that may serve as a synthetic descriptor of a particular biological action (e.g., a disease, cellular drug response, etc.). In our study, each signature was a subset of the most consistently differentially regulated genes in the general cellular responses to pathogen infections. We selected the highest-and lowest-ranked 250 genes from each PRL as a pathogen signature. The GSEA-based PRL comparing method is a parameter-free algorithm, with the exception of signature size (recommended range, 15-500 per gene set, with lower size increasing randomness and large size decreasing specificity). We estimated the size parameter influence by sampling from 50 to 450 in intervals of 50. Pearson correlation coefficients of the association scores between 1,225 pairs of HTR relations indicated that the association scores obtained within this tested signature size range correlated with one another robustly (Supplementary Figure S6) . The strongest correlation (mean coefficient > 0.97) was obtained with a signature size of 250 genes (Supplementary Figure S6) , demonstrating a limited influence of signature size. Therefore, we used a signature size of 250 for further analyses. To evaluate HTR similarities across different pathogens, we used the GSEA 11 method, which is based on the Kolmogorov-Smirnov statistic, to quantify whether signature genes tend to have similar ranks in the PRLs of two compared pathogens (i.e. top or bottom) and presented the outcome as an enrichment score. We used {up A , down A } to represent the signature of pathogen A, and the enrichment score of up A (or down A ) in the PRL for pathogen B, which was represented by ES B up A (or ES B down A ) and would be high if the corresponding genes tended to be placed at the top (or bottom) of the PRL for pathogen B. If the length of PRL is m, and the {up A } contains n probe identifiers ranked R 1 , R 2 , R 3 ,…, R n in PRL B, then ES B u p A could be obtained as follows: The association score was top when > top bottom or bottom otherwise. HTR similarity between pathogens A and B was expressed by an association score between them drawn from the enrichment scores of their signatures in the opposing pathogen's PRL. We defined the association score between HTRs of pathogen A and B as follows: To validate the significance of the association scores, we used the same algorithm to calculate the association score between two random PRLs of the same size as those used in our study (i.e., 22, 160) to obtain a control. We repeated this experiment one million times. We computed a P value for each pairwise pathogen association score by comparing the actual values to the distribution of values obtained for the random data comparison. The P value was estimated as the frequency that random control values exceeded the actual value. FDR values were estimated as described by Benjamini and Hochberg 52 . 