Statistical Tests. Several different statistical tests were used to evaluate the performance of classifiers. (1) When sufficient numbers of samples were available, ROC curve analysis was performed and AUCs were calculated. A resampling method was used to estimate the AUC 95% confidence interval (CI) associated with each ROC curve. Venkatraman's method 73 , as implemented in the pROC package in R, was used to compare the AUC values between different biomarker combinations with p < 0.05 considered statistically significant. (2) For some performance estimates the Mann-Whitney U test was used, which gives an equivalent statistic to AUC 74 . (3) For some analyses with very small sample sizes, Student's t-test was used, following appropriate small-sample guidelines 75 . Discovery of the pan-viral signature. In the discovery phase we searched for RNA transcripts or transcript combinations with expression levels that varied during a host response to viral infection. The initial search was conducted across 13 datasets from human adult and pediatric subjects, plus one set of data from macaques. We expected there to be some variability between datasets in quantification of the levels of particular RNA transcripts because different studies used different sample types, sample collection tubes, experimental platforms (microarrays, RNA-seq), and data reduction/processing methods to estimate gene expression levels. A considerable literature has arisen on comparing gene expression results across platforms [76] [77] [78] [79] and on estimating the biases that may arise specifically within microarray-based approaches 80, 81 and RNA-seq -based approaches [82] [83] [84] . For each GEO dataset, we represented each gene's RNA transcript family by the single microarray probe that gave the maximal average intensity for that gene, across all samples used in the analysis. Probe identities are listed in Supplementary Table S6 . We began the search using four core datasets (GSE40366, GSE51808, GSE52428 and GSE41752). To decrease the dimensionality of the search space and to ensure that only those transcripts with moderate to high expression levels were examined, we applied a mean expression filter that allowed only the top 6,000 RNA transcripts from each of the core datasets to be retained. Regression analysis was then applied across the search space, with RNA transcripts combined in pairs, using a linear objective function with coefficients set to −1 or +1 for the log 2 expression value of each transcript in a pair. In theory, each core dataset produced 36,000,000 transcript pairs to examine (not taking into account reciprocal pairs). Setting the coefficients to −1 or +1 (instead of allowing the coefficients to vary) reduced the computational effort to a manageable level. ROC curve analysis on each transcript pair then allowed the transcript pairs to be ranked by AUC for their ability to separate the case and control groups in each of the core datasets. The RNA transcript pairs were then filtered by the following two-step process: (1) those with average AUC <0.92 across the four core datasets were discarded; and (2) those with average AUC < 0.92 across ten additional viral-based "sensitivity" datasets (Table 1) were discarded. This resulted in a severely reduced pool of transcript pairs (N = 856) with AUC ≥ 0.92. Next, the four "core" and ten "sensitivity" datasets (Table 1) were individually normalized, as follows. (1) The mean expression level of each RNA transcript was calculated across all samples in that dataset. (2) The expression level of this transcript in each sample was then adjusted by subtracting its mean value. (3) All expression values were then scaled to unit variance. This procedure was performed for every transcript in each individual dataset. All 14 viral datasets were then merged into a single expression matrix. Specificity screen with independent GEO datasets. To ensure that candidate transcript pairs were associated uniquely with a viral host response and not a host response due to confounding phenotypes, they were individually assessed against 19 "specificity" datasets. The specificity datasets were derived from bacterial-positive patients, some of whom were classified as septic (GSE3341, GSE16129, GSE40396), patients with SIRS (GSE40012), healthy subjects ranging in age from childhood to nonagenarian (GSE40366), patients with inflammation not associated with positive viral infection (GSE42834, GSE17755, GSE19301, GSE47655, GSE38485, GSE36809, GSE29532, GSE61672), neonatal and pediatric bacterial sepsis patients (GSE25504, GSE30119, GSE6269), patients with anxiety (GSE61672), subjects administered dexamethasone (GSE46743), and healthy subjects displaying demographic confounders such as age, ethnicity and gender (GSE35846). Candidate transcript pairs having AUC >0.80 in more than 3 of the 19 specificity datasets were discarded. A total of 473 candidate transcript pairs remained after this step. Final selection step. Finally, a greedy forward search was performed on the reduced pool of highest-ranked RNA transcript pairs according to previously described methods 41 . The end product of this search was the final pan-viral signature containing two upregulated and two down regulated RNA transcripts as a linear sum (ISG15 + OASL) -(IL16 + ADGRE5). Validation in independent GEO datasets. The pan-viral signature was then tested against 11 independent "validation" datasets (Table 3) . These datasets were derived from six mammalian species (human, macaque, chimpanzee, pig, mouse and rat), all seven Baltimore groups, and various tissue types (blood, liver biopsies, in vitro primary hepatocytes), and included time course and vaccination studies in humans. It should be noted that differences in the y-axis scale (pan-viral signature value) between various studies, as indicated in figures in the text and Supplementary Material, result from differences in the various gene expression measurement platforms across studies. Validation in independent clinical studies. The pan-viral signature received additional validation from two independent clinical studies, FEVER and GAPPSS, which were conducted on adult and pediatric patients respectively. Details of the FEVER study are provided in Supplementary Tables S1 and S2, Figure S6 and Text S1, and details of the GAPPSS study are provided in Supplementary Tables S3 and S4 , Text S2, and the publication by Zimmerman et al. 40 The GAPPSS study was an institutional review board-approved prospective, observational study (Seattle Children's Hospital IRB #14761). Parental informed permission was obtained prior to sample and data collection. All sample and data collection was carried out in accordance with approved protocols and procedures. The FEVER study was also an institutional review board-approved prospective, observational study (UK National Research Ethics services reference number: 09/H0701/103). All participants provided written informed consent, prior to sample and data collection. All sample and data collection was carried out in accordance with approved protocols and procedures. The FEVER study cohort consisted of adult patients presenting with fever to the Emergency Department, and then admitted to hospital. A comparison was made between those retrospectively diagnosed with a viral infection (n = 15), with bacterial sepsis (n = 55) or with infection-negative SI (n = 22). In the FEVER study, testing for viral infections was only performed on those patients suspected of a viral infection, and involved use of one or more single-virus diagnostic tests based on the clinician's judgment and according to hospital procedures 85 (e.g. PCR for influenza, serology for dengue, etc.). The GAPPSS study cohort consisted of pediatric intensive care patients retrospectively diagnosed with a viral infection (n = 5), bacterial sepsis (n = 25), or bacterial sepsis with a viral co-infection (n = 10), as well as infection-negative SI controls undergoing cardio-pulmonary bypass surgery (n = 29). All patients in the GAPPSS study, except for one bacterial sepsis patient who was omitted from the analysis, were tested for the presence of viral nucleic acid sequences in nasal swabs using the Biofire FilmArray Respiratory Panel (Biofire Diagnostics, Utah, USA). Supplementary Tables S3 and S4 present the relative gene  expression values for ISG15, IL16 , OASL, ADGRE5 derived from RNA-seq data for the FEVER and GAPPSS patients, respectively. For each of the two datasets (FEVER or GAPPSS), we represented the expression level of a gene of interest by Fragments Per Kilobase of transcript per Million mapped reads (FPKM) 86 . This measure of gene expression should be independent of whether the data are in the form of single-end reads (FEVER) or paired-end reads (GAPPSS). Combination of SeptiCyte ™ LAB and pan-viral signature. To demonstrate utility of a combined bacterial and viral host response assay, we analysed GEO dataset GSE63990 using an 8-gene classifier consisting of the four pan-viral signature genes (IL16, ISG15, OASL, ADGRE5) combined with the four genes (CEACAM4, LAMP1, PLA2G7, PLAC8) from SeptiCyte TM LAB. The class labels used in GSE63990 were: bacterial infection, viral infection, and non-infectious illness. Line data from GSE63990 are presented in Supplementary Table S5 . To assess whether a significant biological response exists from the eight genes, we performed a permutation test. Under this statistical framework the dependency between the feature space and the response (class labels) is broken thus allowing us to understand the behavior of the model under the null hypothesis that the explanatory variables and response labels are independent. The model, in this case, consisted of a supervised Random Forest analysis 43 constructed from 1000 trees and allowing √f features to be selected randomly at each split, where f = 8 and represents the number of gene targets. The class labels were then randomly permuted 2,000 times which allowed for a 0.05 alpha level with a 0.01 precision 87 . The data were then modeled using Random Forests. For each null model the multiclass log-loss was calculated to construct the null distribution before assessing the true response labels against the final null model. 