The effect of single-step tracing can be measured by the effective reproduction ratio R q , the average number of new infections per infected. Whereas the rate of being traced backwards at time t since infection (due to detection of any infectee) is equal for all infecteds, the rate of being traced forwards (due to detection of the infector) depends on the generation-time distribution, which in turn depends on the number of traceable generations backwards in the transmission tree (traceable ancestors). Hence, infectives need to be typed according to the number of traceable ancestors j, and R q is the largest eigenvalue of the next-generation matrix K with entries k ij being the expected number of type-i infecteds (with i traceable ancestors) produced per type-j infected [15] . Because type-j infecteds only produce type-0 and type-j+1 infecteds, by untraceable and traceable contacts respectively, all entries other than k 0j and k j+1,j are equal to 0. Even though the matrix is infinitely large, we conjecture from all observed numerical calculations that the positive elements k j+1,j converge in the sense that |k j+1,j 2k j+2,j+1 |R0 as jR'. Therefore, for numerical evaluation we 'closed' the matrix to an (n+1) 2 matrix with k nn = k n+1,n . For the four special cases, R q could be calculated numerically in MathematicaH, but for other cases considered, the entries of the matrix had to be determined by numerical simulation. Analysis of single-step tracing with delay could be done by calculating R from the next-generation matrix, as for the model without delay (see Supporting Information for all details). With iterative tracing, isolation of a single infected results in quarantine of a cluster of infecteds, all mutually linked by traceable contacts ( Figure 1B) . By recognizing these clusters of infectives, an epidemic of infected individuals can be regarded as an epidemic of traceable clusters. Each untraceable contact in the transmission tree results in infection of a new cluster index case, so the average number of untraceable contact infections caused by a single cluster, the cluster reproduction ratio R c , determines the effectiveness of iterative contact tracing. If Y(p c ) denotes the expected cumulative infectiousness of a cluster at the time of cluster quarantine, then As with single-step tracing, effectiveness of iterative tracing is determined by considering the critical tracing probability (for achieving R c = 1): If p c = 0, then each infective will be a separate cluster, and R c = Y(0) = R 0 pre by definition. For p c .0 the cluster size will be larger than one, but cluster infectiousness need not be larger, as backwards tracing can reduce the infectious period of superspreaders with large detection time as it does in single-step tracing. For two of the four special cases (a = '), and for the case considered by MÃ¼ller et al [7] (a = 1, t inf = ', t lat = 0), Y(p c ) can be calculated numerically in MathematicaH. For all other cases, including the real infections, stochastic simulations were needed. Incorporating delays into iterative tracing does not generally change the concept of R c , but it makes the calculation of Y(p c ) very complicated, because there is no longer a single time of cluster quarantine. Two complications arise: first, delays may cause contactees in the chain emanating from a symptomatic infected to become symptomatic themselves before the tracing process reaches them. They then initiate a new tracing process of their own within the same cluster. Second, if the infection process is faster than the tracing process, the cluster size grows infinitely large and iterative tracing becomes ineffective. We determined p c * by stochastic simulation of clusters until quarantine of the final infected (see Supporting Information for all details). 