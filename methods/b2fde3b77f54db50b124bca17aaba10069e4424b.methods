We assume a continuous time Markovian model for the dynamics of a disease within a household of size N. We use a general SE(j)I(k)R model, where the exposed and infectious periods are split up into j and k phases so that each has an Erlang distribution with mean exposed and infectious periods 1=s and 1=c, and variances 1=(js 2 ) and 1=(kc 2 ), respectively [22, 23] . Infection is assumed to be frequency dependent (but densitydependent transmission is no obstacle to the methodology we outline, and will be discussed later) with transmission parameter b [15, 24] . The transition rates for this model are given in Table 1 . The model is specified by the matrix Q, which encodes the transition rates between different possible states of the household [6, 18] . For the SE(j)I(k)R model we consider, the total number of possible states is hence this is also the dimension of Q. The element Q m,n is the rate of transition from state m to n for m=n, where m~1, . . . ,Y and n~1, . . . ,Y. Q m,m~{ X n=m Q m,n , is the negative of the total rate at which the system leaves state m. The dynamics of the model are then given by the equation, where p(t) is the probability vector with m th entry the probability of the household being in state m at time t [18] . As we are dealing with household models, the dimension of Q, given by Equation (1), is relatively small, so Equation (2) can be solved efficiently using matrix exponential methods [25] . Hence we can calculate p(t) to an arbitrary precision, side-stepping the need for any type of potentially costly simulation. To calculate the serial interval distribution we need to evaluate the probability of observing a secondary case in a given time Average time taken to compute the likelihood for a household of size n. Other parameters j~k~2, D max~1 0 and as given in Figure 1 . A 2.5 GHz Intel core i5 machine running MATLAB was used for these timings. The Effective Size is the dimension of the Q matrix once the redundant states have been removed. doi:10.1371/journal.pone.0073420.t002 interval, given that we start with an index case at time t~0. To do this we first form the transition rate matrix Q corresponding to the SE(j)I(k)R model for a given household size and set of parameters. We assume that the appearance of symptoms coincides with entering the (first) infectious class [26] ; in the later sections we discuss how Markovian models can be extended to weaken this assumption. The Q matrix is then modified so that states which correspond to a serial interval event -a second individual entering the first infectious class -are made absorbing. If we order the states of the system by V~(E 1 ,E 2 , . . . ,E j ,I 1 ,I 2 , . . . ,I k ,R), then the set of absorbing states are where v k,1 is the set of all vectors of length k, with a 1 in a single position and zeros elsewhere. The set of states B are those corresponding to serial interval events, while the last one is recovery with no further infection. This model explicitly takes into account that the second person to start showing symptoms might not have been the first to be infected, and hence evaluates the probabilities associated with the clinical serial interval. For a household of size N, the initial state of the chain is set as p(0)~(S~N{1,I 1~1 ). In doing this we are implicitly assuming that the first person to show symptoms is also the first person to introduce infection into the household. If we were considering asymptomatic individuals and/or multiple external infections then this might not be true. By numerically solving the dynamics we can then calculate the cumulative distribution function (cdf) of the serial interval, F (t), by computing how much probability has flowed into the absorbing states by a given time. We then condition on the index case having created at least one secondary infection before recovering. The solution of the forward equation giving the probability of being in a given state at time t is Removing parts of the state space which are unreachable due to the new absorbing states can reduce the dimension of the matrix and speed up the evaluation of the matrix exponential. The cdf of the serial interval is then given by, where c is the probability that the index case infects at least one individual before recovering; note c~1{ lim t?? X i[fA\Bg p i (t). The probability 1{c can be calculated simply by considering the sequences of events that would result in the individual going through k stages without infecting anybody. This then gives, The serial interval probability mass function is formed by binning into days, as detailed in the next section. 