We used a metapopulation model that consists of a set of coupled dynamic epidemic transmission models ( Figure 1 ). Each component model represents one city and tracks the progression of individuals through four classes: susceptible to infection (S); exposed to the virus but not yet infectious (E); infectious (I); and recovered and no longer susceptible (R). We assumed that infectiousness coincides with disease onset and that infectious cases do not travel. Previous work has used deterministic approximations to study the evolution of this system [14] [15] [16] [17] [18] [19] . With this approach the first case in each city (except the originating city) was assumed to occur only when the average number of incubating cases arriving from other cities exceeded one, an approximation that will artificially slow the rate of spread between cities. Our stochastic model, which has a similar underlying structure to its deterministic counterpart, avoids this distortion and uses probabilistic transitions to capture the inherent uncertainty in the course of the epidemic. This is more appropriate than the deterministic approaches previously adopted, because chance effects dominate in the early stages of the epidemic in each city and in the seeding of each city's epidemic. As well as providing greater realism, this approach allowed us to quantify the uncertainty in model predictions due to demographic stochasticity. Thus, rather than assuming that each city's epidemic starts at a determined time, we assumed that the initiation of an epidemic depends on the timing of a sequence of chance events: a person incubating the virus must board a plane; that person must infect others in the destination city; some of those others must cause further transmission, and so on. Each time the model is run, even with identical starting conditions and parameter values, a different answer is obtained. This stochastic model was used to estimate key parameters using data from the 1968-1969 (1968/9) influenza pandemic and to evaluate the impact of interventions using contemporary demographic and transport data. Mathematical details of the model are provided in Protocol S1. Coupling between cities was estimated using data from the International Air Transport Association for 2002 that gives the number of seats on flights between 105 cities, including the 100 with the highest number of international scheduled passengers and all 52 used in the 1968/9 data. City sizes were taken from the United Nations urban agglomeration data (available at: http://unstats.un.org/unsd/demographic/ sconcerns/densurb/urban.aspx). When fitting models to 1968/9 data, air transport data, sizes of urban agglomerations, and influenza data were taken from a previous study [14, 15] . To select from variants of the basic model, we compared deterministic and stochastic model fits to data from the 1968/ 9 pandemic by choosing parameters to minimize the sum of squared deviations (SSQ) between times of observed and predicted peaks (this contrasts with previous work that aimed to forecast the pandemic, and therefore based parameter estimates only on data from the first affected city [14] ). A major strength of our approach is that the observed time of an epidemic peak should be unaffected even by large between-country variation in influenza reporting rates. The predicted epidemic peak for a given city was defined as the day on which the highest number of infected people first developed symptoms. When a city had more than one observed peak in the 1968/9 data, only the first peak was used. We used the statistic SSQ(m)/(n Ã€ 2m) to compare model fits [22] , where m is the number of fitted parameters (between one and four), and n the number of fitted data points (the number of cities with observed and predicted epidemic peak times). This formula selects models that are parsimonious and fit the data well. The full stochastic model was then used to estimate parameters for the best-fitting model by choosing parameters that minimised the mean SSQ from ten simulation runs for each combination of parameter values. We evaluated models with sine wave, square wave, and no seasonal variation in transmission parameters for cities outside the tropics. In the sine wave formulation, the peak transmissibility occurred on the shortest day in each hemisphere, while in the square wave formulation, peak transmissibility lasted 6 mo, also centred on the winter solstice. We also considered model formulations where the transmission parameter in the tropics was taken as the maximum, minimum, and mean over 1 y of that outside the tropics. For some parameter values, the model predicted no epidemic peaks in some cities for which an epidemic peak was in fact recorded. When fitting the models we penalized these regions of parameter space by arbitrarily assigning a deviation between model and data of 500 d. 