Compressed sensing. The general problem that CST addresses is to reconstruct a vector XAR N from linear measurements Y about X in the form where YAR M and U is an M Â N matrix. The striking feature of CS is that the number of measurements can be much less than the number of components of the unknown vector, that is, Mo oN, insofar as X is sparse and the number of non-zero components in it is less than M. Accurate reconstruction can be achieved by solving the following convex-optimization problem 35 : where jj X jj 1 ¼ P N i¼1 j X i j is the L 1 norm of X and the matrix U satisfies the restricted isometry property. Solutions to the convex optimization are now standard [35] [36] [37] [38] [39] [40] . (More details of the CST can be found in Supplementary Note 1.) Our goal is to develop a framework to cast the problem of reconstructing propagation networks into form (1). Reconstruction framework. To present our framework in a transparent manner, we first consider the relatively simple case where there is no hidden source. Further, we assume that the disease starts to propagate from a fraction of the infected nodes. As we will see, based on this framework, it is feasible to locate any hidden source based solely on time series after outbreak of infection. The state of an arbitrary node i is denoted as S i , where Owing to the characteristic difference between the SIS dynamics and CP, we treat them separately (see Methods). For the SIS dynamics, the probability P 01 i ðtÞ of an arbitrary node i being infected by its neighbors at time t is where l i is the infection rate of i, a ij stands for the elements of the adjacency matrix (a ij ¼ 1 if i connects to j and a ij ¼ 0 otherwise), S j (t) is the state of node j at t, and the superscript 01 denotes the change from susceptible state (0) to infected state (1). At the same time, the recovery probability of i is P 10 i ðtÞ ¼ d i , where d i is the recovery rate of node i and the superscript 10 denotes the transition from infected state to susceptible state. Equation (4) can be rewritten as If measurements at different times t ¼ t 1 , t 2 , Á Á Á , t m are available, equation (5) can be written in the matrix form where Y contains ln½1 À P 01 i ðtÞ at different t, U is determined by the state S j (t) of nodes except i, and X comprising the links and infection rates of i is sparse for a general network (see Methods). The main challenge here is that the infection probabilities P 01 i ðtÞ at different times are not given directly from the time series of the nodal state. To develop a method to estimate the probability from the nodal states, we set a threshold D pertaining to the normalized Hamming distance between strings composed of S j (t) (jai) at different t to identify a base string att a and a set of strings subject to the base. According to the law of large numbers, the probability P 01 i ðt a Þ can be estimated by the average over the state S i (t þ 1) at all proper time. By setting another threshold Y associated with the normalized Hamming distance, we can identify a set of base strings. This process finally gives rise to a set of reconstruction (a) Fourteen snapshots of data at time instants t 1 À t 14 of eight nodes in a sample network, where S i is the time series of node 2 and S À i denotes the strings of other nodes at different times. The neighbourhood of node 2 is to be reconstructed. Only the pairs 00 and 01 in the time series of S i (i ¼ 2) and the corresponding S À i contain useful information about the network, as marked by different colours. (b) As S i (t þ 1) is determined by the neighbours of i and S À i (t), we sort out S i (t þ 1) and S À i (t) in the coloured sections of the time series in a. According to the threshold parameters D ¼ 3/7 and Y ¼ 3/7, we calculate the normalized Hamming distance between each pair of strings S À i (t), finding two base strings att 1 ¼ t 1 andt 2 ¼ t 11 with H½S À i ðt 1 Þ; S À i ðt 2 Þ4Y. We separate the coloured strings into two groups that are led by the two base strings, respectively. In each group, the normalized Hamming distance H½S À i ðt a Þ; S À i ðt n Þ between the base string and other strings is calculated and the difference from S À i ðt a Þ in each string is marked by red. Using parameter D, in the group led by S À i ðt 1 Þ, S À i (t 5 ) and S i (t 6 ) are preserved, because of H½S À i ðt 1 Þ; S À i ðt 5 ÞoD. In contrast, S À i (t 7 ) and S i (t 8 ) are disregarded because H½S À i ðt 1 Þ; S À i ðt 7 Þ4D. In the group led by S À i ðt 2 Þ, due to H½S À i ðt 2 Þ; S À i ðt 13 ÞoD, the string is preserved. The two sets of remaining strings marked by purple and green can be used to yield the quantities required by the reconstruction formula. (Note that different base strings are allowed to share some strings, but for simplicity, this situation is not illustrated here. See Supplementary Note 3 for a detailed discussion.) (c) The average values hS i ðt a þ 1Þi and hS À i ðt a Þi used to extract the vector Y and the matrix U in the reconstruction formula, where . The vector Y m Â 1 and the matrix U m Â (N À 1) can then be obtained based solely on time series of nodal states and the vector X (N À 1) Â 1 to be reconstructed is sparse, rendering applicable the CS framework. As a result, we can achieve exact reconstruction of all neighbours of node i from relatively small amounts of observation. In a similar manner the neighbouring vectors of all other nodes can be uncovered from time series, enabling a full reconstruction of the whole network by matching the neighboring sets of all nodes. For the CP dynamics, the infection probability of an arbitrary node i is given by where k i is the degree of the node i, and the recovery probability is . In close analogy to the SIS dynamics, we have We then choose a series of base strings using a proper threshold Y to establish a set of equations, expressed in the matrix form where U has the same form as in equation (6), but Y and X are given by Our reconstruction framework based on establishing the vector Y and the matrix U is schematically illustrated in Fig. 1 . It is noteworthy that our framework can be extended to directed networks in a straightforward manner due to the feature that the neighbouring set of each node can be independently reconstructed. For instance, the neighbouring vector X can be defined to represent a unique link direction, for example, incoming links. Inference of the directed links of all nodes yields the full topology of the entire directed network. Reconstructing networks and infection and recovery rates. To quantify the performance of our method in terms of the number of base strings (equations) for a variety of diffusion dynamics and network structures, we study the success rates for existent links (SRELs) and null connections (SRNCs), corresponding to nonzero and zero element values in the adjacency matrix, respectively. We impose the strict criterion that the network is regarded to have been fully reconstructed if and only if both success rates reach 100%. The sparsity of links makes it necessary to define SREL and SRNC separately. As the reconstruction method is implemented for each node in the network, we define SREL and SRNC on the basis of each individual node and the two success rates for the entire network are the respective averaged values over all nodes. We also consider the issue of trade-off in terms of the true positive rate (for correctly inferred links) and the false positive rate (for incorrectly inferred links). Here we assume that there is no hidden source and the spreading process starts from a fraction of infected nodes, and record the binary time series. Figure 2a shows the reconstructed values of the components of the neighbouring vector X of all nodes. Let n^t be the number of base strings normalized by the network size N. For small values of n^t, for example, n^t ¼ 0:1, the values of elements associated with links and that associated with null connections (actual zeros in the adjacency matrix) overlap, leading to ambiguities in the identification of links. In contrast, for larger values of n^t, for example, n^t ¼ 0:4, an apparent gap emerges between the two groups of element values, enabling us to correctly identify all links by simply setting a cut-off within the gap (see Supplementary Fig. 1a and Supplementary Note 4 for a method to set the cut-off). The success rates (SREL and SRNC) as a function of n^t for SIS and CP on both homogeneous and heterogeneous networks are shown in Fig. 2b ,c, where we observe nearly perfect reconstruction of links insofar as n^t exceeds a relatively small value-an advantage of compressed sensing. The exact reconstruction is robust in the sense that a wide range of n^t values can yield nearly 100% success rates. Our reconstruction method is then effective for tackling real networks in the absence of any a priori knowledge about its topology. In particular, the existence of a clear gap in the reconstructed vector X represents a successful reconstruction for a real network. Note that a network is reconstructed through the union of all neighbourhoods, which may encounter 'conflicts' with respect to the presence/absence of a link between two nodes as generated by reconstruction centred at the two nodes. The conflicts would reduce the accuracy in the reconstruction of the entire network. To characterize the effects of edge conflicts, we study the consistency of mutual assessment of the presence or absence of link between each pair of nodes, as shown in Fig. 2b ,c. We see that inconsistency arises for small values of n^t but vanishes completely when the success rates reach 100%, indicating complete consistency among the mutual inferences of nodes and consequently guaranteeing accurate reconstruction of the entire network. Detailed results of success rates and trade-off measures with respect to a variety of model and real networks are displayed in Table 1 , Supplementary Figs 2 and 3 . and Supplementary Note 5. Although the number of base strings is relatively small compared with the network size, we need a set of strings at different time with respect to a base string to formulate the mathematical framework for reconstruction. We study how the length of time series affects the accuracy of reconstruction. Figure 3a,b show the success rate as a function of the relative length n t of time series for SIS and CP dynamics on both homogeneous and heterogeneous networks, where n t is the total length of time series from the beginning of the spreading process divided by the network size N. The results demonstrate that even for very small values of n t , most links can already be identified, as reflected by the high values of the success rate shown. Figure 3c ,d show the minimum length n min t required to achieve at least 95% success rate for different network sizes. For both SIS and CP dynamics on different networks, n min t decreases considerably as N is increased. This seemingly counterintuitive result is due to the fact that different base strings can share strings at different times to enable reconstruction. In general, as N is increased, n^t will increase accordingly. However, a particular string can belong to different base strings with respect to the threshold D, accounting for the slight increase in the absolute length of the time series (see Supplementary Fig. 4 and Supplementary Note 5) and the reduction in n min Table 1 demonstrate the high accuracy and efficiency of our reconstruction method based on small amounts of data. In practice, noise is present and it is also common for time series from certain nodes to be missing, and it is necessary to test the applicability of our method in more realistic situations. Figure 4a ,b show the dependence of the success rate on the fraction n f of states in the time series that flip due to noise for SIS and CP dynamics on two types of networks. We observe that the success rates are hardly affected, providing strong evidence for the applicability of our reconstruction method. For example, even when 25% of the nodal states flip, we can still achieve about 80% success rates for both dynamical processes and different network topologies. Figure 4c ,d present the success rate versus the fraction n m of unobservable nodes, the states of which are externally inaccessible. We find that the high success rate remains mostly unchanged as n m is increased from 0 to 25%, a somewhat counterintuitive but striking result. The high degree of robustness against the limit to accessing nodal states is elaborated further in Supplementary Fig. 6 and Supplementary Note 5. We find that, in general, missing information can affect the reconstruction of the neighbouring vector, as reflected by the reduction of the gap between the reconstructed values associated with actual links and null connections. However, even for high values of n m , for example, n m ¼ 0.3, there is still a clear gap, indicating that a full recovery of all links is achievable. We have also found that our method is robust against inaccurately specified diffusion processes with fluctuation in infection rates (see Supplementary  Fig. 7 and Supplementary Note 5). Taken together, the high accuracy, efficiency and robustness against noise, missing information and inaccurately modelling of real dynamical processes provide strong credence for the validity and power of our framework for binary time-series-based network reconstruction. Having reconstructed the network structure, we can estimate the infection and recovery rates of individuals to uncover their diversity in immunity. This is an essential step to implement target vaccination strategy in a population or on a computer network to effectively suppress/prevent the spreading of virus at low cost, as a large body of literature indicates that knowledge about the network structure and individual characteristics is sufficient for controlling the spreading dynamics 47-50 . Here we offer an effective method to infer the individuals' infection rates l i based solely on the binary time series of the nodal states after an outbreak of contamination. (To our knowledge, there was no prior work addressing this critical issue.) In particular, after all links have been successfully predicted, l i can be deduced from the infection probabilities that can be approximated by the corresponding infection frequencies (see Methods). These probabilities depend on both l i and the number of infected neighbours. The reproduced infection rates l i of individuals for both SIS and CP dynamics on different networks are in quite good agreement with the true values with small prediction errors (see Supplementary Fig. 8 and Supplementary Note 6). Results from a comprehensive error analysis are listed in Table 1 , where the uniformly high accuracy validates our method. The inhomogeneous recovery rates d i of nodes can be predicted from the binary time series in a more straightforward way, because d i do not depend on the nodal connections (see Supplementary Fig. 9 and Supplementary Note 6). Thus, our framework is capable of predicting characteristics of nodal diversity in terms of degrees, and infection and recovery rates based solely on binary time series of nodal states. Locating the hidden source of propagation. We assume that a hidden source exists outside the network but there are connections between it and some nodes in the network. In practice, the source can be modelled as a special node that is always infected. Starting from the neighbourhood of the source, the infection originates from the source and spreads all over the network. We collect a set of time series of the nodal states, except the hidden source (see Methods). The basic idea of ascertaining and locating the hidden source is based on missing information from the hidden source when attempting to reconstruct the network. In particular, to reconstruct the connections belonging to the immediate neighbourhood of the source accurately, time series from the source are needed to generate the matrix U and the vector Y. However, as the source is hidden, no time series from it are available, leading to reconstruction inaccuracy and, consequently, anomalies in the predicted link patterns of the neighbouring nodes. It is then possible to detect the neighbourhood of the hidden source by identifying any abnormal connection patterns 51 , which can be accomplished by using different data segments. If the inferred links of a node are stable with respect to different data segments, the node can be deemed to have no connection with the hidden source; otherwise, if the result of inferring a node's links varies significantly with respect to different data segments, the node is likely to be connected to the hidden source. The s.d. of the predicted results with respect to different data segments can be used as a quantitative criterion for the anomaly. Once the neighbouring set of the source is determined, the source is then precisely located topologically. Figure 5 presents an example, where a hidden source is connected with four nodes in the network (Fig. 5a) , as reflected in the network adjacency matrix (Fig. 5b) . We implement our reconstruction framework on each accessible node by using different sets of data in the time series. For each data set, we predict the neighbours of all nodes and generate an adjacency matrix. Averaging over the elements corresponding to each location in all the reconstructed adjacency matrices, we obtain Fig. 5c , in which each row corresponds to the mean number of links in a node's neighbourhood. The inferred links of the immediate neighbours of the hidden source exhibit anomalies. To quantify the anomalies, we calculate the structural s.d. s from ARTICLE different data segments, where s associated with node i is defined through the ith row in the adjacency matrix as where j denotes the column, a ðkÞ ij represents the element value in the adjacency matrix inferred from the kth group of the data, ha ij i ¼ ð1=gÞ P g k¼1 a k ij is the mean value of a ij and g is the number of data segments. Applying equation (10) to the reconstructed adjacency matrices gives the results in Fig. 5d , where the values of s associated with the immediate neighbouring nodes of the hidden source are much larger than those from others (which are essentially zero). A cut-off value can be set in the distribution of s i to identify the immediate neighbours of the hidden source (see Supplementary Fig. 1b and Supplementary Note 4) . The performance of locating hidden source by means of the trade-off measures (true positive rate versus false positive rate) are displayed in Table 1 . 