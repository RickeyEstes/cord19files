Molecule #46 was ranked number 1 based on the covalent docking score and its interaction model with the binding site was carefully checked as shown in Figure 3 . Although compound #46 has the best covalent docking score, it has the alerting group aldehyde. Considering there is still much space for compound #46 to fill in the S1' subsite and α-ketoamides may be good to fit the oxyanion hole ( Figure 4A ) of 3CL pro , 3 author/funder. All rights reserved. No reuse allowed without permission. The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint we replaced the aldehyde by formamide and also replaced the 1,4 Michael acceptors by alpha-ketoamides. Thus, we optimized compound #46 to compound 46-14-1 ( Figure 4 A and B). Figure 3 . Lead compound #46 generated by AI. A: Non-covalent molecular docking model of SARS-CoV-2 3CL pro (brown surface) with the bound lead compound #46 (magenta sticks). The triazole ring binds to the S1 subsite of the catalytic active center, the covalent fragment of α, βunsaturated aldehyde binds to S1' subsite, β-lactam ring binds to S2 subsite and 5,7-dihydroxy chromone binds to S3 subsite. B: A two-dimensional (2D) view of non-bonding interaction of lead compound #46 in complex with 3CL protease based on non-covalent docking. The triazole ring, i.e., keto-amide, phenolic hydroxy forms hydrogen bond (H-bond) with His163, Glu166, and Thr190, respectively. C: Covalent docking model between compound #46 (green sticks) and 3CL protease (brown surface) exhibits a similar docking model as non-covalent docking. D: A 2D view of ligand author/funder. All rights reserved. No reuse allowed without permission. The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint interaction between compound #46 and protease under covalent docking. The triazole ring forms an H-bond with His163; the fragment of α,β-unsaturated aldehyde forms a covalent bond with Cys145, i.e., the key residue in the catalytic center of the protease, resulting in covalent inhibition; aldehyde carbonyl forms an H-bond with His41; and besides, the hydroxyl of chromone at position 7 forms an H-bond with Thr190. The non-bonding interaction between compound 46-14-1 and SARS-CoV-2 3CL pro is mainly hydrogen bond. The carbonyl group of covalent scaffold α-ketoamide forms Hbonds with Leu141 and Gly143 as a hydrogen acceptor or a hydrogen donor. The hydrogen on the nitrogen atom of the triazole ring forms an H-bond with Glu166, while Glu166 also forms an H-bond with the carbonyl group on the main chain. The oxygen in the β-lactam ring forms an H-bond with His41. In order to enhance the polarity of the compounds, sulfonic groups were introduced to replace the ketone carbonyl groups on the main chain and sulfonamides 46-14-2 were obtained. The covalent docking model of compound 46-14-2 with SARS-CoV-2 3CL pro is shown in Figure 4 C and D. In order to make the compound 46-14-2 fit the active pocket with a higher affinity, we added a carbon atom to the sulfonic acid group of the original molecule, extending the carbon chain to increase the flexibility of the molecule, and obtained another optimized compound 46-14-3. The mode of covalent docking with SARS-CoV-2 3CL pro is shown in Figure 5 . Due to the introduction of carbon atoms and the enhancement of molecular flexibility, the β-lactam ring can be inserted deeper into the S2 pocket and the other fragments of the compound can better adapt to the S1, S1' and S3 subsites. The αcarbonyl carbon on the α-ketoamide of compound 46-14-3 forms a covalent bond with the key residue Cys145 on the protease, but the main non-bond interaction is still hydrogen bond (indicated by a yellow dash). The triazole ring mainly forms H-bonds with Phe140 and Glu166 residues in the S1 pocket; α-ketoamide covalent binding fragment mainly forms H-bonds with key amino acid residues Cys145, Gly143 and Ser144 in the S1' subsite, which forms an oxyanion hole in the red circle in Figure 9 ; the β-lactam side chain mainly forms H-bonds with residues Tyr54 and AsS187 in the author/funder. All rights reserved. No reuse allowed without permission. The copyright holder for this preprint (which was not peer-reviewed) is the . S2 pocket; the chromone scaffold mainly forms H-bonds with key residues Thr190 and Gln192 in the S3 pocket. In addition, the oxygen on the sulfonyl group of the main chain forms an H-bond with Glu166 in the S1 pocket. author/funder. All rights reserved. No reuse allowed without permission. The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint The copyright holder for this preprint (which was not peer-reviewed) is the . https://doi.org/10.1101/2020.03.03.972133 doi: bioRxiv preprint The representatives were selected (46-14-1, 46-14-2 and 46-14-3 as Figure 6 displays), which may be further evaluated by molecular dynamics simulation to get the binding free energy and by quantum chemical calculation to get the reaction energy barrier. Meanwhile, 46-14-1, 46-14-2 and 46-14-3 are chosen as our candidates for chemical synthesis and anti-SARS-CoV-2 activity testing, which is ongoing. The copyright holder for this preprint (which was not peer-reviewed) is the . efficient and effective as ADQN-FBBD is molecular fragment-based growing with the knowledge of chemical reactions, while other models are all atom-based with no rules of chemical reactions at all 34, 38, 39 . 4) ADQN-FBDD is highly flexible and user-friendly for the medicinal chemists, who can easily inject their drug discovery experience into the reward function to guide the novel molecule generation. Our ADQN-FBDD and related pipeline can be used not only for designing anti-COVID-19 drugs but also other structure-based drug discoveries, especially for emerging infetious diseases that require treatments timely. 