The yield of cell harvested for purification of the catalytic domain of SARS-CoV 3CLpro was 2.69 g per 1000 ml of E. coli culture. The amount of purified protein synthesised with no-tag was 16 mg. For storage and assay, the protein solution was concentrated to 16 mg ml Ã€1 . The concentrated solution was diluted to 1 lM when the inhibitory assay was going on. A flavonoid library consisting of 10 different scaffolds was also built (Figure 1 ). It contains five isoflavones, one isoflavane, 17 flavones, 11 flavonols, seven flavanols, seven flavanones, four flavanonol, one prenylflavonoid, nine chalcones and two unclassified flavonoids (Supplementary Table 1 ). We applied the library to assay SARS-CoV 3CLpro. Using 64 flavonoids, an inhibitory effect of each compound at 20 lM was tested. Among them, herbacetin (3,4 0 ,5,7,8-pentahydroxyflavone), rhoifolin (apigenin-7-O-rhamnoglucoside) and pectolinarin (5,7-dihydroxy 4 0 ,6-dimethoxyflavone 7-rutinoside) were found to have prominent inhibitory activity ( Figure 2 ). The binding affinity data were plotted as log inhibitor concentration versus percent fluorescence inhibition (Figure 2 ). The three compounds showed the severely reduced fluorescent intensity and thus represented their SARS-CoV 3CLpro inhibitory activity. The IC 50 values were calculated from the dose-dependent inhibitory curves of herbacetin, rhoifolin and pectolinarin. The measured values were 33.17, 27.45 and 37.78 lM, respectively. Since flavonoids are known to be aggregated through complexity and thus non-specifically inhibit various proteases, the assay in the presence of Triton X-100 was also performed 24 . Before the examination, we tested the effects of Triton X-100 on the catalytic activity of the SARS-CoV 3CLpro. As shown in Supplementary  Figure 1 , only a slight increase in catalyst activity was observed up to 0.1% Triton X-100. Therefore, the assay was performed at a concentration of 0.01% Triton X-100 with no significant interference detected. To independently confirm the inhibitory activity of flavonoids, a general tryptophan-based assay method was employed. Tryptophan was well known to emit its fluorescence. Therefore, if tryptophan is positioned adequately in proteins, the change of fluorescence intensity can reflect the binding state of chemicals and be used to judge interaction between proteins and chemicals. The SARS-CoV 3CLpro contains one tryptophan residue (Trp31) at the catalytic domain. Its backbone lines up at the entrance of the active site. Therefore, its fluorescence change can reflect environmental variation of the active site. The catalytic domain of SARS-CoV 3CLpro used in this study displays a fluorescence peak at 340 nm after the tryptophan excitation wavelength of 290 nm. We monitored the change of the fluorescence intensities depending on the presence or absence of all flavonoids. Since each compound in the flavonoid library was almost non-fluorescent under the experiment condition, a change of fluorescence intensity reflects interactions between the catalytic domain and chemicals. Intriguingly, the three inhibitory compounds obviously reduced the fluorescence intensity of the catalytic domain compared with others ( Figure 3 ). The decreased emission intensity confirmed the complex formation between the catalytic domain and inhibitory compounds. In order to deduce the binding modes of the inhibitory flavonoids in the molecular level, an in-depth theoretical investigation through an induced-fit docking study was carried out. The interactions between SARS-CoV 3CLpro and three inhibitory flavonoids were analysed to predict their binding affinities. Top-ranked structures (according to the glide gscores) from the induced-fit docking results for herbacetin (-9.263), rhoifolin (-9.565) and pectolinarin (-8.054) were selected and hypothesised to be biological complexes. To find reasonable structural factors endowing the good affinity of herbacetin, the poses of kaempferol (-8.526) and morin (-8.930), two closest homologues, were also calculated and compared. The predicted complex structures and 2D schematic representations of them are illustrated in Figure 4 . 