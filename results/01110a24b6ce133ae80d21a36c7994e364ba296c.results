Our goals are two-fold. First, we investigate how well featureselection algorithms such as RFA can reliably classify RNA viruses according to their host species reservoir, thereby giving insight into pathogen evolution, and the frequency of cross-species transition events. Identification of functional polymorphisms is not critical in meeting this goal, though clearly is desirable. Second, we evaluate how well RFA can identify sets of sites that are functionally relevant to the phenotype of interest (in this case host species), in the context of dense RNA virus genomes and their high degree of linkage. We first analyse polymerase gene sequences of RNA viruses to identify the genetic signatures predicting host species. As an example, Figure 1a represents the diversity of Flavivirus polymerase amino acid sequences (Table S2 ). Here we use principal component analysis (PCA) solely to visualise the variation between samples, not as a classification tool. Figure 1b illustrates how feature selection identifies amino acid positions which robustly classify samples by host species, resulting in clustering of samples which infect the same reservoir. The clustering of samples seen in the PCA plot is similar to that seen in the maximum likelihood tree (Figure 1c) , supporting the use of PCA as a useful tool for generating low-dimensional representations of genetic variation. Second, we examine the potential of RFA applied as a phenotypic classifier to give insight into cross-species disease emergence. In this case, analysis of sequences of viruses which have fully adapted to particular host species -as in the Flavivirus example -is insufficient to distinguish between the subset of mutations required to allow cross-species emergence and later non-essential mutations which further increase viral fitness in a new species. We therefore need to examine data collected from zoonotic outbreaks. The 2003 SARS epidemic is a good example of a zoonosis which rapidly developed a high level of transmissibility in humans [3, 18, 19] . The pathogen was rapidly identified [3] and the origin of the virus was initially traced back to palm civets [19] , before bats were identified as the natural reservoirs of SARS-like coronaviruses [20] . We applied the RFA to nucleotide sequences of the spike protein of SARS-like coronaviruses (Table  S3) , recovered from human patients and palm civets from the 2003 and 2004 epidemics and bat sequences available in the Genbank database. Figure 2a illustrates the extent to which bat sequences differ from the human and palm civet sequences recovered in China in 2002-2004, and also highlights the similarity of palm civet and human sequences [19] . Analysis of the variation in the selected host-discriminant viral alleles (highlighted in Figure 3 ) reveals interesting relationships between host reservoirs (Figure 2b) . Firstly, there is noticeable genetic variation in the samples from human SARS patients collected in the early and mid-stages of the 2003 epidemic, compatible with adaptation of the virus to a new host species. The late 2003 samples were less variable, suggesting selective pressures may by then have stabilized [21] . Secondly, human patient samples from a small outbreak in January 2004 are more closely related to palm civet 2004 samples than to any human sample from the previous year, indicating that the 2004 outbreak represented an independent cross species transition [22] . The palm civet samples from 2003 were collected a few months after the human epidemic ended so there might have been an accumulation of mutations responsible for the substantial distance between palm civet 2003 samples and human 2003 samples. However, the close proximity between the bat samples and the first samples from the human 2003 epidemic suggests that the transition from palm civet to human occurred quite rapidly after the transition from bat to palm civet. With respect to our second goal -identifying functional relevant sites -it is notable that 12 of the 15 positions identified by feature selection coded for non-synonymous substitutions (Table  S4) , most of which are mapped onto the surface of the spike protein. It should be noted that of the 15 positions identified in the current study, 13 overlap with those found in [23] . The functional relevance of the two unique positions (239 and 311) found here and that of the 13 unique positions identified in [23] is not clear. When running the RFA for amino acid sequences of the same viruses, we obtain a subset of 12 significant amino acid positions that are coded for by the exact same non-synonymous substitutions highlighted by the RFA conducted on the nucleotide sequences. High mutation rates in RNA viruses facilitate the overcoming of host specific barriers [24] particularly in ecological settings where hosts display high contact rates [8, 22] . However, cross-species transfer seems to be favoured between closely related host species [9, 25, 26, 27] , suggesting that the fitness landscape of host adaptation is shaped by host phylogeny. Streicker and colleagues [26] defined lineages of rabies virus associated to particular bat taxa, identifying 43 cross species transmission events involving 15 bat species. Here we reanalyse the complete nucleoprotein sequences available for five of those bat species (Table S5) . PCA applied to these sequences ( Figure 4a ) shows how viruses collected from 3 of the bats species (L. borealis, L. seminolus, L. cinereus) are extremely similar, with a substantially divergent lineage infecting E. fuscus bats and an isolated small cluster of viruses seen in T. brasiliensis. Applying RFA to predict host species to these sequences allows discrimination of L. cinereus specific traits (Figure 4b ), but does not significantly separate the L. borealis and L. seminolus clusters. This suggests that transmission of rabies virus between these two bat species is much more frequent than between any other pair of species examined. The advantage of RFA compared with phylogenetic methods is that it allows a probability of ''belonging'' to each host bat species to be estimated for each virus sample. Thus we can examine whether a virus isolated in one species is in fact native to a different host species. Figure 4b highlights the 8 outlier sequences (T1-T8) in this dataset -viruses which are closer to rabies viruses native to a different species from that in which they were isolated. For these 8 viruses, Figure 4c gives the RFA classification probabilities of these viruses to the 5 different host species considered. In six cases, the cross-species transitions thus identified agree with those identified in [26] . Five of these 8 transitions occurred between L. borealis and L. seminolus. This, and the relatively poor ability of RFA to choose between these species in classifying viruses (Table S6 ), suggests that phylogenetic closeness between host species ( Figure S4 ) facilitates cross-species transmission. To address our second goal of investigating the functional relevance of identified discriminant features, we applied RFA to a collection of influenza A samples from distinct host species 