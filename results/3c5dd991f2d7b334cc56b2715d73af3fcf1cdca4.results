The Pfam domain content of all 2,255 available Coronaviridae genomes was determined and a variety of distribution patterns were observed, from domains whose frequency across all Coronaviridae was >95 per cent, to rare domains present in only a few known genomes. To illustrate this variety, two genomes examples of Alphacoronavirus, Betacoronavirus, Gammacoronavirus, Deltacoronavirus, Torovirus, and Bafinivirus were selected and all domains encoded by the full genomes were identified and their positions in each virus genome is marked by colored rectangles indicating frequent, moderate, or rare occurrence (Fig. 2) . The domain content is both extensive and varied by genus and this information might be used to identity and classify Coronaviridae sequences. A hierarchical-clustering of domain content of all genomes in each genus showed three distribution patterns (Fig. 3) . Domains present in a high frequency in single genus (upperthird of the cluster map), domains present at high frequency in most or all genera (bottom-third of the cluster map), and domains with low frequency in some genomes or genera (middle of the cluster map). In particular, five domains (AAA_30, Macro, Viral_helicase1, AAA_11, NSP13) were found to be encoded by genomes from all six Coronaviridae genera in >95 per cent of the 2,255 Coronaviridae genomes examined. We define these domains as Coronaviridae Triage Domains (CTDs). Of the five CTDs, three were promiscuous (encoded in all Coronaviridae genomes as well as in other virus families), while two domains appeared specific for Coronaviridae (AAA_11 and NSP13, termed Coronaviridae Absolute Triage Domains (CATD)) and were encoded in all Coronaviridae genomes, but were not found in genomes from forty other common virus families infecting animals (results not shown). The utility of domain content for Coronaviridae classification was first tested by developing a simple triage method to identify potential Coronaviridae sequence contigs. Preliminary work identified four triage conditions as useful for this purpose. These triage conditions were CTD_any (the contig encodes at least one of the five CTDs), CTD_all (the contig encodes all five CTDs), CATD_any (the contig encodes at least one of the two CATDs) CATD_all (the contig encodes both CATDs). The presence of these domains was combined with contig length cutoffs of 500 nt, 3,000 nt, 10,000 nt, and 20,000 nt. The performance of these triage conditions for identifying coronavirus contigs was examined. Using a mock contig set derived from forty-one virus families (see Section 2), the Pfam domain content of each fragment was determined using HMMER3 and used to sort the fragments into Coronaviridae groups based on fragment length plus CTD and CATD domain content. The accuracy of the classification was assessed in comparison to the classification of the original genome annotation in GenBank (Fig. 4) . We ran each classification process five times to control for the random selection of features. The analyses were run with four size cutoff classes and sensitivity/specificity values for correct classification were color and shape coded for Triage method (!500 nt panel A, !3,000 nt panel B, !10,000 nt panel C, and !20,000 nt panel D, Fig. 4) . The highest sensitivity/specificity values were obtained with the CTD_all triage for all four size classes (dark blue triangles, Fig. 4) . Overall performance was observed in the order CTD_any < CATD_any < CATD_all < CTD_all. The combination of triage with either the CTD_all or CATD_all triage, with a 20,000-nt size cutoff and RF classification using all Coronaviridae domains resulted in classification of Coronaviridae sequence fragments with both sensitivity > 0.9 and specificity > 0.975. We next applied this protein domain-based method to classify Coronaviridae genomic sequences generated from next-generation sequencing surveillance data. The NGS data were derived from bat and rat fecal samples collected in the Dong Thap province (Fig. 1) and processed for agnostic, random primed NGS as described in Section 2. All de novo assembled Coronaviridae contigs that passed the quality control and minimum length cutoff were subjected to Pfam domain content identification, triage by CATD content and length and RF classification. This process is summarized in Fig. 5 . The process identified thirty-four potential Coronaviridae genomes from 177 bat fecal samples and 11 Coronaviridae genomes from 391 rat fecal samples. These forty-five genomes were classified to the Coronaviridae genus level using the Coronaviridae classification tool (Fig. 6) . Note that screening using specific PCR targeting the conserved RNA-dependent RNA polymerase (RdRp) gene had previously identified CoV sequences in some of the same samples (29). The RdRp sequences generated in that study were closest to the bat Alphacoronavirus NC_009657 (Scotophilus bat coronavirus 512) and the rat Betacoronaviruses NC_026011 (Betacoronavirus HKU24) or KF294372 (Longquan Rl rat coronavirus). These are likely to be the same viruses described here at the full genome level. Two lineages of Alphacoronavirus were identified in the surveyed bat samples, one group showed some relationship to the Scotophilus bat coronavirus 512 (GenBank NC_009657, Tang et al. 2006) with 96 per cent shared identity across the genome. The other group of Alphacoronavirus was distant from any known Alphacoronavirus strains and may represent new species. Two groups of Betacoronavirus were identified in rat samples, the closest available virus genome in GenBank was the Betacoronavirus_HKU24 (KM349743) and the Longquan mouse coronavirus (KF294357) with 95 and 94 per cent shared identity across the entire genome. The next closest coronaviruses were the human coronavirus OC43 and the porcine hemagglutinating encephalomyelitis virus (PHEV) with $70 per cent shared amino acid identity across the entire genome. The genome organization for the new coronaviruses was similar to the closest reference genomes sharing similar open reading frame organization as well as similar Pfam domains (Fig. 7A) . Furthermore, the expected ribosome slippage sequences between the ORF 1 A and 1AB, as well as the repeat sequences and protease cleavage sites were all present in the new CoVs genomes (results not shown). To examine the relationship between the reported viruses and known Alpha-and Betacoronaviruses, the spike protein encoding regions of these genomes were compared with the spike coding regions from the most closely related coronavirus genomes from GenBank. Consistent with observation at the full genome scale, phylogenetic analyses suggested that the Vietnamese bat Alphacoronaviruses belonged to two lineages; viruses in the one lineage are closely related (sharing 94-96 per cent nt identities) to Scotophilus bat CoVs strains A515 (DQ648719), A527 (DQ648791), CYCU-S1/TW/2013 (KT346372), and 512 (NC_009675), while viruses in the second lineage were more distantly related (sharing 75-76 per cent nt identities) to the four previously mentioned bat CoVs strains (Fig. 7B) . The CoVs identified from Vietnamese rats were classified as Betacoronavirus and belonged to two distinct lineages as shown in phylogenetic tree (Fig. 7B) ; viruses from one lineage closely related to the CoV strain HKU24 from Hongkong (KM349743, Lau et al. 2015) , while viruses in the second lineage are more related to the rat CoV strains Longquan-189 (KF294370) and -370 (KF294371) (Wang et al. 2015) and rat CoVs from China (KY370051, KY370049, KY37048, and KY370043). including 3,316 Coronaviridae fragments) was determined for each fragment. The CTD or CATD domain content plus the contig length (!500 nt, !3,000 nt, !10,000 nt, !20,000 nt) were used as a triage to classify fragments as 'Coronaviridae' or 'not Coronaviridae'. The contigs classified as Coronaviridae for each triage condition were then identified to the genus level using RF classification. The sensitivity (true positive/true positive þ false negative) and specificity (true negative/true negative þ false positive) for each combined triage and classification method were determined based on the original identity of the input genomes. Panel A. RF classification after triage by 500 nt or larger and CTD or CATD content. Panel B. As in A but with 3,000 nt or larger contigs. Panel C. As in A but with 10,000 nt or larger contigs. Panel D. As in A but with 20,000 nt or larger contigs. Each colored node represents the outcome of one complete triage/classification cycle, each combined method was repeated five times. 