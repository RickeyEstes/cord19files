We used a time step in our model of 0.02 days. The two models were tested under different levels of intra-and inter-age group contact heterogeneity in different sizes of epidemics. For ease of illustration, only two age groups in the community are considered (adults and children), although the above equations could easily be generalized to situations where information about more refined age groups is available. With six different known values of R 0 and similar value for λ r , we used computer simulations to generate incidence data for these two age groups under three levels of inter-group and within group heterogeneity in contact patterns. In these simulations we construct contact patterns such that individuals in each age group have uniform degree distributions with a given width. Similar to assumptions in [11] , we defined the value of λ r as 0.25, an arbitrary value for generating synthetic incidence data. Six known values of R 0 (Fig 1A-1F ) are 2.05, 2.58, 3.12 1.51, 1.52 and 1.53, respectively. In Fig 1A, we show that model B with age structure yields a better estimate of R 0 and converges at the true value (R 0 = 2.05) more quickly in the early phase of the epidemic (~day 9 to 15) over non-age-structured model A (day 18 to day 21). Between day 9 and day 15, the estimated R 0 values fluctuate~0.4% around the true value. Between day 0 and day 15, less than 100 cases are required to estimate R 0 . In densely populated area like Hong Kong, the between group and within-group variation in number of contacts is very high. To characterize this feature, we hypothesized 2 scenarios for 2 given values of R 0 as seen in Fig 1A-1C and Fig 1D-1F. Across Fig 1A-1C , we keep the degree distribution of individuals in the first age group unchanged (red bar chart in the sub-diagram) and shift the degree distribution of individuals in the second age group (blue bar chart in the sub-diagram) to the right, thereby increasing the inter-group heterogeneity of contacts. Model B shows a quick convergence to the true value of R 0 , while model A cannot accurately estimate R 0 , especially when inter-group heterogeneity in the contact network is high. This suggests that model B provides a better real-time estimate over model A whenever there is any level of inter-group contact heterogeneity. We also test which model gives a more accurate estimate of R 0 with larger intra-group contact heterogeneity (a wider distribution in each age group). We run the simulations on each age group using three datasets where the contacts are uniformly distributed with a width of 3, 5, and 7 degrees respectively (Fig 1D-1F) . For incidence data with 3 degrees on each group, model B provides more accurate estimates of R 0 between day 30 and day 45 than model A (as in Fig 1D) . Under these conditions, about 50 to 100 cases are required for model B to converge on the true value of R 0 . For incidence data with 5 degrees and 7 degrees on each group, model B also gives an accurate estimate of R 0 as represented in Fig 1E and Fig 1F. In Fig 1F, the distance between degree distributions of the two age groups is shortened compared with Fig 1D. In other words, the inter-group contact heterogeneity in the two age groups decreases across Fig 1D-1F . This explains why the differences between the two estimates from both model A and model B are not significant in Fig 1F. It also reveals that model A is a good choice if contacts are more uniformly distributed across different age groups. We also applied model B to the hospital incidence data extracted from the E-flu system and the overall degree distribution from the contact survey to estimate R 0 for the 2009 outbreak of H1N1pdm in Hong Kong. In total, there were 28,338 laboratory-confirmed cases during the period between 30 th April 2009 and 7 th February 2010. The removal distribution can also be derived using the 24,873 laboratory-confirmed cases with complete information on symptomatic notification date and symptoms onset date (Fig 2A) . The median number of days to be removed is 1 day. Using parameter estimates determined from the natural history of pandemic influenza in 2009 [13] [14] [15] [16] as shown in Table 1 , we re-defined our transmissibility function as follows, where Δl, Δs and Δi represent the average duration of the latent phase of infection, average duration of the asymptomatic phase of infection, and the average duration of the symptomatic phase of infection respectively. We derived the excess degree and degree distribution for each age group from an analysis of the number of close contacts, k, experienced by 770 participants aged 3 to 102 years taken from the interview-led social contact questionnaire in [17] [18] . The subjects in this study were required to record detailed contact histories for one pre-assigned day, providing information on how many contacts they had made, whom they had met, and how long they had met with each contact. Out of 770 subjects, 710 subjects recorded how many close contacts they had made. The rest of the 60 subjects provided a range in the number of close contacts they had experienced, and we defined their number of close contacts as the mid-point of this range. The mean number of close contacts for school-aged children and adults was 9.94 and 4.69 respectively. The degree distribution for individuals aged 2-19 is different from those aged 20 and [13] . Average duration of asymptomatic phase of infection (Δs) (days). 