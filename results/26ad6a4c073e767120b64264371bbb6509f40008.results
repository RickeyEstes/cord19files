Details of patients and controls from the fi rst phase of the study are given in tables 1 and 2. Most patients had advanced pulmonary disease, presenting with cough, fever, and weight loss, and the majority had smear positive cavitary disease. To generate diagnostic classifi ers for tuberculosis, we fi rst profi led 349 serum samples on weak cation exchange (CM10) protein chip arrays by SELDI-ToF MS, 6,28 and identifi ed 219 peak clusters from m/z spectra in the range 2000-100 000. The choice of chip surface was based on our previous observation that the CM10 surface-chemistry yields particularly rich spectra from serum. 11 Spectra were assigned randomly to a training and testing set and we then used supervised machine learning classifi cation methods (table 3, webappendix) to discriminate the proteomic spectra of patients with tuberculosis from the controls using the training and testing set approach (table 2). The ability of a classifi er to discriminate data correctly in the testing set is known as its generalisation performance. 18, 29 We compared the generalisation performance of a range of classifi ers by plotting their performance on the testing set in ROC space (fi gure 1A). A Gaussian kernel SVM 16, 29, 30 (table 3 and fi gure 1A, red square) was the best discriminator between tuberculosis and control groups, with a sensitivity of 93·5% and specifi city of 94·9% (overall accuracy 94·2%). This SVM classifi er defi nes the convex hull of the ROC space (fi gure 1A, red line), achieving the best accuracy. Samples from fi ve patients with tuberculosis and four controls in the testing set were misclassifi ed (webtable 1). Notably, 21 of the 24 control patients with respiratory infection in the test set were correctly classifi ed by the SVM, as were all seven patients with sarcoidosis. None of the African control patients with sleeping sickness or malaria were misclassifi ed. Only one of the 11 smear-negative cases of tuberculosis was missed. We applied a further test of generalisation performance of the SVM by ten-fold crossvalidation on the entire set of spectra (both training and testing), obtaining accuracy of 93·1% (SD 3·8), sensitivity of 94·4% (4·5), and specifi city of 91·8% (8·8) when optimised for accuracy (fi gure 1B). We also evaluated the generalisation performance of the SVM by re-randomising the allocation of spectra to new training and testing sets, and varying the proportions of training to testing cases from 90:10 to 50:50. For 80:20 sets, we obtained values for accuracy, sensitivity, and specifi city exceeding 90% (data not shown). The robustness of the SVM was further confi rmed by its mean performance on 100 randomly generated 80:20 sets as shown in the ROC curve (fi gure 1C, webfi gure 1), with an area under the curve of 0·96. Coeffi cients of variation for peak intensity for spectra, derived from a single sample, run 25 times (six assays), were 15·6% (intra-assay) and 24·4% (interassay). These data were obtained by averaging values for nine of the highest amplitude peaks at the following m/z values: 5648, 6203, 6449, 6647, 8907, 9213, 9310, 9370, and 9419. As a further measure of reproducibility, 28 universal control spectra run at diff erent times over a 6-month period were correctly classifi ed as controls by the SVM classifi er obtained in the ten-fold cross-validation. We selected a subset of informative peak clusters for further evaluation by applying a correlation fi lter method to detect independently informative peaks. 31 We ranked ten mass clusters with the highest positive, and ten with the highest negative, Pearson correlation coeffi cients. To study the discriminatory power of the selected 20 mass clusters we fi rst paired each mass with every other (400 pairs) and trained SVM classifi ers to diagnose tuberculosis cases. We ranked generalisation performance by accuracy and showed that 20 pairs (5%) of selected mass clusters gave accuracies greater than 80% and 17 of these combined negatively and positively correlated mass clusters (webfi gure 2). No mass cluster pair achieved sensitivity of greater than 95% and specifi city of greater 21 AdaBoost=adaptive boosting. 23 SLP=single layer perceptron. 19 MLP=multi layered perceptron. 20 HL=hidden layers. N=neurons. 