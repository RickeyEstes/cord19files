As a heritable sequence-specific adaptive immune system, CRISPR-Cas is a powerful force shaping strain diversity in host-virus systems. While the diversity of CRISPR alleles has been explored, the associated structure and dynamics of host-virus interactions has not. We develop theory on the role of CRISPR immunity in mediating the interplay between host-virus interaction structure and eco-evolutionary dynamics in a computational model and three natural systems. We show that the structures of networks describing who infects whom and who is protected from whom are modular and weighted-nested, respectively. The dynamic interplay between these networks influences transitions between dynamical regimes of virus diversification and host control,leading to eventual virus extinction. The three empirical systems exhibit weighted nestedness, a pattern our theory shows is indicative of viral control by hosts. Previously missing from studies of microbial host-pathogen systems, the protection network plays a key role in the coevolutionary dynamics. The structure of complex ecological communities is clearly non-random. It is generally argued that interaction structure affects the stability of communities to perturbations [1-3] and arises from coevolutionary dynamics between interacting partners [4] [5] [6] [7] , yet the structure-dynamics nexus remains a long-standing central question in community and network ecology. Host-parasite infection networks, in which interaction structure represents 'who infects whom', have been typically described as modular, nested, or both [8, 9] . Modularity concerns patterns of specificity, in which the network is partitioned into modules of hosts and parasites that interact densely with each other but sparsely with those outside the group. Nestedness concerns instead patterns of specialization, and describes a network structure in which specialist hosts are infected by subsets of parasites that in turn also infect the more generalist hosts [8, 9] . Common to all host-parasite network studies is a dominant focus on patterns of infection. Infection structure should critically depend however on the genetic basis of resistance of hosts to pathogens [10] . The emergence of network structure from immune selection has been shown in pathogens of humans such as Plasmodium falciparum [11, 12]. In particular, strain theory developed for pathogens with multilocus encoding of antigens posits that negative frequency dependent selection, mediated by competition for hosts through cross-immunity, can structure pathogen populations into clusters of strains with limited overlap of antigenic repertoires [11] [12] [13] [14] [15] . Parasites with 2 . CC-BY-NC-ND 4.0 International license is made available under a resistance by surface mutation can arise quickly to take over CRISPR or restriction-modification systems in providing immunity. This experimental and theoretical evidence for advantages of surface modification may entail strong fitness costs under natural conditions because mutations in surface receptors such as those in flagella or pili can be detrimental for microbial movement and biofilm formation [21] . Investigations of natural populations have indeed shown that surface resistance is costly in the wild [27, 28] . These observations underlie the need for complementing experimental approaches by developing theory on the kinds of 'macroscopic', whole system, diversity patterns expected under 'microscopic' CRISPR-induced coevolutionary processes. These patterns can serve as signatures in both nature and experiments for inferring whether specific underlying processes of resistance are at play. Resistance mechanisms can operate alone or in tandem to affect the diversification of microbes and phages. Nonetheless, not all of these are relevant for linking between host/phage genotypes and immune phenotype as observed in the structure of immunity and infection networks. Surface modification, for instance, is a result of mutation and selection that will provide advantage to one or few mutated strains periodically sweeping through the population. Restriction-modification systems, being unspecific to viral genetic sequence, also do not provide such link because they do not result in the creation of new strains. In contrast, CRISPR is a heritable adaptive immune system conferring sequence-specific protection against viruses, plasmids, and other mobile elements [23, 29] . As such, it not only provides a direct sequence-based link, but also allows consideration of concomitant structures for both infection and immunity, and from both host and parasite perspectives. The diversity of CRISPR alleles in natural, experimental and simulated populations has been explored [30] [31] [32] [33] [34] . It has been shown, for example, that increased strain diversity of Pseudomonas aeruginosa (with strains being clones with different spacer compositions) promotes the ability of the bacterium to control the DMS3vir virus [32] . Nevertheless, how such strain diversity evolves, the emergence of structure of host-virus interaction networks, and how they are assembled and disassembled remain unexplored. Advancing this predictive framework for CRISPR-Cas in microbial populations provides a basis for further study of the relative importance and interactions of different resistance mechanisms, and is essential for effective experimental manipulation of microbial systems, including applications to health and engineering [35, 36] . It can open new frontiers in studies of immune diversity and, more generally, contribute to tighten the connection between microbiology and evolutionary biology [37] . 