Transmission between hosts is a critical part of the viral lifecycle. Recent studies of viral transmission have 9 used genome sequence data to evaluate the number of particles transmitted between hosts, and the role 10 of selection as it operates during the transmission process. However, the interpretation of sequence data 11 describing transmission events is a challenging task. We here present a novel and comprehensive frame-12 work for using short-read sequence data to understand viral transmission events. Our model describes 13 transmission as an event involving whole viruses, rather than independent alleles. We demonstrate how 14 selection and noisy sequence data may each affect inferences of the population bottleneck, and identify 15 circumstances in which selection for increased viral transmission may or may not be identified. Applying 16 our model to data from a previous experimental transmission study, we show that our approach grants a 17 more quantitative insight into viral transmission, inferring that between 2 to 6 viruses initiated infection, 18 and allowing for a more informed interpretation of transmission events. While our model is here applied 19 to influenza transmission, the framework we present is highly generalisable to other systems. Our work 20 provides new opportunities for studying viral transmission. 21 Introduction Understanding viral transmission is a key task for viral epidemiology. The extent to which a virus is able 23 to transmit between hosts determines whether it is likely to cause sporadic, local outbreaks, or spread 24 to cause a global pandemic [1, 2]. In a transmission event, the transmission bottleneck, which specifies 25 the number of viral particles founding a new infection, influences the amount of genetic diversity that is 26 retained upon transmission, with important consequences for the evolutionary dynamics of the virus [3,4]. Recent studies have used genome sequencing approaches to study transmission bottlenecks in influenza 29 populations. In small animal studies, the use of neutral genetic markers has shown that the transmission 30 bottleneck is dependent upon the route of transmission, whether by contact or aerosol transmission [5,6]. 31 In natural human influenza populations, where modification of the virus is not possible, population genetic 32 methods have been used to analyse bottleneck sizes. Analyses of transmission have employed different 33 approaches, exploiting the observation or non-observation of variant alleles [7] or using changes in allele 34 frequencies to characterise the bottleneck under a model of genetic drift [8-11]. A recent publication 35 improved this latter model, incorporating the uncertainty imposed upon allele frequencies by the process 36 of within-host growth [12]. Two studies of within-household influenza transmission have provided strik-37 ingly different outcomes in the number of viruses involved in transmission, with estimates of 1-2 [13] and 38 100-200 [14] respectively. 39 40 Another focus of research has been the role of selection during a transmission event; this is important 41 in the context of the potential for new influenza strains to become transmissible between mammalian 42 hosts [15, 16]. Studies examining transmissibility have assessed the potential for different strains of in-43 fluenza to achieve droplet transmission between ferrets under laboratory conditions [17-20]; ferrets provide 44 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint a useful, if imperfect, model for transmission between humans [21, 22]. The application of bioinformatic 45 techniques to data from these experiments has identified 'selective bottlenecks' in the experimental evolu-46 tion of these viruses [23, 24], whereby some genetic variants appear to be more transmissible than others. In these studies, selection has been considered in terms of the population diversity statistic π; changes 48 in π N /π S , the ratio between non-synonymous and synonymous diversity, have been used to evaluate 49 patterns of selection across different viral segments. 50 51 We here note the need for a greater clarity of thinking in the analysis of viral transmission events. For 52 example, analysis of genetic variants in viral populations shows that synonymous and non-synonymous 53 mutations both have fitness consequences for viruses [25, 26]; the use of synonymous variants as a neu-54 tral reference set may not hold. More fundamentally, in an event where the effective population size is 55 small, the influences of selection and genetic drift may be of similar magnitude [27]. However selection 56 is assessed, this implies a need to separate stochastic changes in a population from selection, especially 57 where a transmission bottleneck may include only a small number of viruses [5, 13, 28]. The attribution 58 of a change in diversity to the action of selection or the attribution of changes in allele frequencies to 59 genetic drift could both potentially be flawed. Given the increasing availability of sequence data, more 60 sophisticated tools for the analysis of viral transmission are required. 61 62 Here we note three challenges in the analysis of data from viral transmission events. Firstly, selection 63 can produce changes in a population equivalent to those arising through a neutral population bottle-64 neck [29] (Figure 1A), making it necessary to distinguish between the two scenarios. A broad literature 65 has considered the simultaneous inference of the magnitude of selection acting upon a variant along with 66 an effective population size [30-35]. However, such approaches rely on the observation of an allele fre-67 quency at more than two time points so as to distinguish a deterministic model of selection (with an 68 implied infinite effective population size) from a combined model of selection with genetic drift; such 69 approaches cannot be directly applied to the analysis of viral transmission. 70 71 Secondly, inferences of transmission events need to account for the haplotype structure of viral pop-72 ulations, whereby whole viruses, rather than sets of independent alleles, are transmitted (Figure 1B). 73 The low rate of homologous recombination in segments of the influenza virus [36, 37] implies that viral 74 evolution proceeds at the haplotype level [38]; competition occurs between collections of linked alleles, or 75 segments, rather than the individual alleles themselves. Under such circumstances, fitter variants do not 76 always increase in frequency within a population [39-41]. Calculations of genetic drift, which are often 77 derived from the evolution of independent variants [42], need to be adjusted to account for this more 78 complex dynamics. 79 80 Thirdly, noise in the measurement of a population may influence the inferred size of a transmission 81 bottleneck (Figure 1C). A broad range of studies have examined the effect of noise in variant calling 82 and genome sequence analysis [43-50]; more recently formulae have been proposed to measure the preci-83 sion with which allele frequencies can be defined given samples from a population [51-53]. Where small 84 changes in allele frequencies are used to assess a population bottleneck, it is important to separate the 85 effects of noise in the measurement of populations from genuine changes in a population. 86 87 We here describe a novel method for the inference of population bottlenecks which resolves the above 88 issues. Our approach correctly evaluates changes in a population even where the data describing that 89 change is affected by noise. It explicitly accounts for the haplotype structure of a population, utilising the 90 data present within short sequence reads. Further, where these factors can be discriminated, our method 91 distinguishes between the influences on the population of selection and the transmission bottleneck. 92 Studies of viral evolution have highlighted the potential for payoffs between within-host viral growth and 93 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/302331 doi: bioRxiv preprint transmissibility [54]; given sufficient data we can evaluate how selection operates upon each of these two 94 phenotypes. Our model extends previous population genetic work on bottleneck inference to provide a 95 generalised model for the analysis of data spanning viral transmission events. 96 Results 97 Model outline 98 In the recent literature, the term 'bottleneck' has been applied to describe a reduction in the genetic 99 diversity of a population (e.g. [55]), whether arising from selection or a numerical reduction in the size of 100 a population. Here, we define a 'bottleneck' more strictly as a neutral process whereby a finite number 101 of viral particles from one population found a subsequent generation of the population, either within the 102 same host, or across a transmission event from host to recipient. Selection then constitutes a modification 103 to this process whereby some viruses, because of their genotype, have a higher or lower probability of 104 making it through the bottleneck to found the next generation. We applied a population genetic method to make a joint inference of the bottleneck size and the 107 extent of selection acting during a transmission event. We consider a scenario in which a viral population 108 is transmitted from one host to another, with samples being collected before and after the transmission 109 event (Figure 2A ). In our model viruses are categorised as haplotypes, that is, according to the variants 110 they contain at a subset of positions in their genome. As such, the viral population is represented as 111 a vector of haplotype frequencies; the population before transmission is represented by the vector q B . 112 During transmission, a random sample of N T viruses are passed on to the second host to give the founder 113 population q F . Selection for transmissibility, whereby genetic variants cause some viruses to be more 114 transmissible than others, is described by the function S T . The potentially small size of the founder pop-115 ulation means that the population evolves within the host under the influence of genetic drift to create 116 the large post-transmission population q A ; this process is approximated in our model by a population 117 bottleneck of effective size N G . Selection acting for within-host growth may further alter the genetic 118 composition of the population; this effect is described by the function S G . Our method thus allows for a 119 discrimination to be made between selection for increased within-host replication and for increased viral 120 transmissibility. Observations of the population are collected before and after transmission via a noisy 121 sequencing process to give the datasets x A and x B . The extent of noise in the sampling and sequencing is 122 characterised by the parameter C; a value of C = 0 would indicate that samples contain no information, 123 while a large C corresponds to noiseless sampling, as in a binomial model. 124 125 To summarise our approach, we note that both the transmission and within-host growth events can 126 be represented as sampling processes, which may each be biased by the effect of selection. As such, given 127 an estimate of the noise inherent to the sequencing process, and externally-derived estimates for N G and 128 S G , we can calculate an approximate likelihood for the parameters N T and S T given the observations 129 x B and x A . Maximising this likelihood gives an estimate for the size of the transmission bottleneck 130 and the extent to which specific genetic variants within the pre-transmission population confer increased 131 transmissibility upon viruses. 132 133 In our model we discriminate between changes in a population arising from selection and those aris-134 ing due to the population bottleneck. This is achieved by considering regions of the genome between 135 which recombination or reassortment has removed linkage disequilibrium between alleles ( Figure 2B ). As 136 transmission involves whole viruses, the bottleneck N T is preserved between regions. Meanwhile, in the 137 absence of epistasis, selection acting upon one region of the virus does not influence the composition of the 138 population in other parts of the genome. As such, a cross-region calculation estimates both N T and the 139 . doi: bioRxiv preprint 157 involving the absolute number of reads of a genome position, which specifies the depth of noise-free reads 158 that would produce the same degree of certainty in an allele frequency. This statistic is dominated by the 159 smaller of C and the absolute read depth; for large C this statistic is close to the absolute read depth, 160 while as the number of reads describing a variant frequency becomes large, the effective depth tends to 161 C + 1. Inferences of bottleneck sizes showed a limit on the inferred bottleneck size governed by noise in se- 