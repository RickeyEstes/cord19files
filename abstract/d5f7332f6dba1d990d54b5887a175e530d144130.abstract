The effective reproduction number, Rt, is an important prognostic for 2 infectious disease epidemics. Significant changes in Rt can forewarn about 3 new transmissions or predict the efficacy of interventions. The renewal 4 model infers Rt from incidence data and has been applied to Ebola virus 5 disease and pandemic influenza outbreaks, among others. This model 6 estimates Rt using a sliding window of length k. While this facilitates 7 real-time detection of statistically significant Rt fluctuations, inference is 8 highly k -sensitive. Models with too large or small k might ignore meaning-9 ful changes or over-interpret noise-induced ones. No principled k -selection 10 scheme exists. We develop a practical yet rigorous scheme using the ac-11 cumulated prediction error (APE) metric from information theory. We 12 derive exact incidence prediction distributions and integrate these within 13 an APE framework to identify the k best supported by available data. We 14 find that this k optimises short-term prediction accuracy and expose how 15 common, heuristic k -choices, which seem sensible, could be misleading. 16 18 fectious disease epidemic is known as an incidence curve or epi-curve [1]. At 19 the population level, these curves offer prospective insight into the spread of a 20 disease by informing on the effective reproduction number, which defines the 21 average number of secondary infections induced by a primary one [2]. This 22 reproduction number, denoted R t at time t, is an important prognostic of the 23 behaviour of an epidemic. If R t > 1, for example, we can expect and hence 24 prepare for an exponentially increasing incidence, whereas if R t < 1, we can be 25 1 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint reasonably confident that the epidemic has been arrested [2]. Reliably estimat-26 ing meaningful changes in R t is an important problem in epidemiology, since 27 it can forewarn about the growth rate of an outbreak and signify the level of 28 control effort that must be initiated or sustained [3] [4]. 29 The renewal model [5] is a popular approach for inferring salient fluctuations 30 in R t and has been used to predict Ebola virus disease case counts and assess the 31 transmission potential of pandemic influenza and Zika virus, among others [6] [7] 32 [3]. The renewal model may be applied retrospectively to understand the past 33 behaviour of an epidemic or prospectively to gain real-time insight into ongoing 34 outbreak dynamics [8] [5]. We only consider the latter here. Model selection 35 metrics for the former application were investigated in [9]. The prospective ap-36 proach approximates R t with a piecewise-constant function i.e. R t is considered 37 constant or stable over some sliding window of k time units (e.g. days or weeks) 38 into the past, beyond which a discontinuous change is assumed [8]. 39 This formulation models the non-stationary nature of epidemics, capturing 40 the idea that different dynamics are expected during distinct phases (e.g. onset, 41 growth, control) of the epidemic lifetime. The window length, k, is effectively a 42 hypothesis about the stability of R t underpinning the observed epi-curve and is 43 critical to reliably characterising the epidemic because it controls the time-scale 44 over which R t fluctuations are deemed significant. Too large or small a k-value 45 can respectively lead to over-smoothing (which ignores important changes) or 46 to random noise being misinterpreted as meaningful. Inferring under the wrong 47 k can appreciably affect our understanding of an epidemic, as observed in [5], 48 where case reproduction numbers (a common k-grouping of R t ) were found to 49 over-smooth significant changes in HIV transmission, for example. 50 Surprisingly, no principled method for optimally selecting k exists. Current 51 best practice either relies on heuristic choices (including visual trial and error) [6] 52 or provides implicit, minimum thresholds for k [8]. Here we adapt metrics from 53 information theory to develop a simple yet rigorous framework for optimising k. 54 Specifically, we analytically derive the posterior predictive incidence distribution 55 of the renewal model and then minimise its accumulated prediction error (APE) 56 [10] over the space of possible k, to obtain k * . The APE is a formal, data-57 driven, model selection strategy that identifies the k * most justified by the 58 available incidence data by optimising for short-term predictive accuracy [11] . The renewal model with this k * best explains the observed epi-curve. The APE metric is valid for all sample sizes, is easily computed for models of 61 arbitrary dimension and is strongly linked to Bayesian model selection (BMS), 62 cross validation and minimum description length (MDL) [12] [13]. Unlike many 63 standard model selection approaches, the APE accounts for parametric com-64 plexity, which describes how functional dependencies among parameters matter 65 [14]. Ignoring parametric complexity is known to promote suboptimal renewal 66 model selection performance [9]. The APE metric deems the model that best 67 predicts unseen data from the same underlying process, and not the one that 68 best fits existing data, as optimal and of justified complexity [15]. Our APE-based approach should therefore pinpoint and characterise only 70 those reproduction number fluctuations that are key to achieving reliable short- The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint term incidence predictions. The performance, speed and computational ease of 72 our approach makes it suitable for real-time forecasting and model selection. It could serve as a stand-alone computational tool or be integrated within ex-74 isting real-time frameworks, such as in [4], to provide emerging insights into 75 infectious transmission dynamics, or to assess the prospective efficacy of im-76 plemented interventions (e.g. vaccination or quarantine). Public health policy 77 decisions or preparedness plans based on improperly specified k-windows could 78 be misinformed or overconfident. Our approach will hopefully limit these risks. 79 Results 80 Problem Definition 81 Let the incidence or number of infected cases in an epidemic at present time t, 82 be I t . The incidence curve is a historical record of these case counts from the 83 start of the outbreak [1], and is summarised as I t 1 = {I s : 1 ≤ s ≤ t}, with s as a 84 time-indexing variable. For convenience, we assume that incidence is available 85 on a daily scale so that I t 1 is a vector of t daily counts (though in general weeks 86 or months could be used instead). The associated effective reproduction number 87 and total infectiousness of the epidemic are denoted R t and Λ t , respectively. 88 Here R t is the number of secondary cases that are induced, on average, by 89 a single primary case at t [2], while Λ t measures the cumulative impact of past 90 cases, from the epidemic origin at s = 1, on the present. The generation time 91 distribution of the epidemic, which describes the elapsed time between a primary 92 and secondary case, controls Λ t (see Methods). In the problems we consider, I t 1 93 and Λ t 1 form our data, the generation time distribution is assumed known, and 94 R t 1 or some grouping of this vector are the parameters to be inferred. 95 The renewal model [5] [6] derives from the classic renewal epidemic trans-96 mission equation [26], and defines the Poisson distributed (Poiss) relationship 97 I t ∼ Poiss (R t Λ t ). This means that P(x) = 1 /x! e −RtΛt (R t Λ t ) x , with x in-98 dexing possible I t values. This formulation assumes maximum epidemic non-99 stationarity (i.e. that transmission statistics change every time unit) and hence 100 only uses the most recent data (I t , Λ t ) to infer the current R t . While this max-101 imises the fitting flexibility of the renewal model, it often results in noisy and 102 unreliable estimates that possess many spurious reproduction number changes 103 [6]. Consequently, grouping is employed. This hypothesises that the repro-104 duction number is constant over a k-day window into the past and leads to a 105 piecewise-constant function that separates salient fluctuations (change-points) 106 from negligible ones (the constant segments) [8] [9]. 107 We use R τ (t) to indicate that the present reproduction number to be inferred 108 is stationary (constant) over the last k points of the incidence curve i.e. the time 109 window τ (t) := {t, t − 1, . . . , t − k + 1}. The data used to estimate R τ (t) is 110 then (I t t−k+1 , Λ t t−k+1 ). This construction allows us to filter noise and increase 111 estimate reliability but elevates bias. In the Methods we show precisely how 112 grouping achieves this bias-variance trade-off. Choosing k therefore amounts to 113 3 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint selecting a belief about the scale over which the epidemic statistics are meaning-114 fully varying and can significantly influence our understanding of the dynamics 115 of the outbreak. Thus, it is necessary to find a principled method for balancing 116 k. Ultimately, we want to find a k, denoted k * , that (i) is best supported by 117 the epi-curve and (ii) maximises our confidence in making real-time, short-term 118 predictions that can inform prospective epidemic responses. 119 This is no trivial task as k * would be sensitive to both the specifically ob-120 served stochastic incidence of an epidemic and to how past infections propagate 121 forward in time. We solve (i)-(ii) by applying the accumulated prediction error 122 (APE) metric from information theory [10], which values models on their capac-123 ity to predict unseen data from the generating process instead of their ability to 124 fit existing data [11]. The properties and mathematical definition of the APE 125 355 cept I s+1 are included [21]. Comparing this to Eq. (9) (see Methods) we see 356 that APE is a modified CV that is explicitly specialised for non-stationary, 357 accumulating time-series. (c) Lack of a 'true model'. It is highly unlikely that the underlying R t is truly 359 described by one of the piecewise-constant functions assumed within renewal 360 models. Unlike many model selection criteria, the APE does not require a true 361 model to exist within the set being evaluated [14]. It is only interested in finding 362 the model that best predicts the data and so emphasises accurate forecasting 363 and data-justified complexity. However, should a true model exist, the APE is 364 statistically consistent i.e. as data accumulate it will select the data-generating 365 model with probability 1 [14]. 366 We tested our metric on both simulated and empirical datasets. We started 367 by examining various distinct, time-varying reproduction number profiles in 368 Fig. 2 , for which no true model existed. By comparing the APE-optimised 369 k * against long and short window sizes, we found that not only does APE 370 meaningfully balance R t estimates to achieve good prediction capacity, but also 371 that getting k wrong could promote strikingly different conclusions from the 372 same dataset. This behaviour held consistent for outbreaks with both small 373 and large numbers of infecteds. 374 We then investigated several step-changing reproduction number examples 375 in Fig. 4 to better expose the underlying mechanics of our approach, and to 376 showcase its performance on epidemics with strong non-stationary transmission. These examples featured rapid changes, also known as events in information 378 theory, caused by effective and ineffective countermeasures [4]. In all cases, our 379 metric responded rapidly whilst maintaining reliable incidence predictions in 380 real-time. Such rapid, event-triggered responses (as in Fig. 5) are known to 381 be time-efficient [22]. A key objective of short-term forecasting is the speedy 382 diagnosis of intervention efficacy. Fig. 4 confirmed the practical value of our 383 method towards this objective. 384 While our metric is promising, we caution that much work remains to be 385 done. Standard Poisson renewal models, such as those we have considered here, 386 make several limiting assumptions including that (i) all cases are detected (i.e. 387 there is no significant sampling bias), (ii) the serial interval and generation time 388 distribution coincide and do not change over the epidemic lifetime and (iii) that 389 heterogeneities in transmission within the infected population have negligible 390 effect [8]. Our analysis of H1N1 influenza (1918) and SARS (2003) flagged 391 some of these concerns. Comparing the k * to previously recommended weekly 392 windows led to some interesting revelations. The APE approach selected a notably shorter window (k * = 2 days) for both 394 datasets. While this produced noisy R s estimates that seemed less reliable than 395 those obtained with weekly windows, the predicted incidence values were central 396 to understanding this discrepancy. The weekly windows were considerably worse 397 at forecasting the observed epi-curve, often systematically biased around the 398 peak of the epidemic and sometimes predicting multi-modal curves that were 399 not reflected by the existing data. From a model selection perspective, the 400 shorter windows are therefore justified. 401 However, the noisy R t estimates are still undesirable. Both datasets are 402 known to potentially contain super-spreading heterogeneities and other biases 403 that may lead to outliers [17] [8]. Moving-average filters were applied in [17] 404 15 . CC-BY-NC-ND 4.0 International license is made available under a The copyright holder for this preprint (which was not peer-reviewed) is the author/funder. It . https://doi.org/10.1101/835181 doi: bioRxiv preprint to remove these artefacts from the H1N1 data. We used the same technique 405 to regularise both datasets and then re-applied the APE. Results remained 406 consistent, providing evidence for the use of more flexible negative binomial 407 renewal models, which can better handle these biases. In an upcoming study 408 we will adapt the APE for these more general renewal methods. 409 Real-time, model-based epidemic forecasts are quickly becoming an inte-410 gral prognostic for resource allocation and strategic intervention planning [23]. 411 As global infectious disease threats elevate, model-supported predictions, which 412 can inform decision making, have become imperative. However, much is still un-413 known about the fundamentals of epidemic prediction and this uncertainty has 414 inspired some reluctance in public health applications [23]. As a result, recent 415 studies have called for careful evaluation of the predictive capacity of models, 416 and demonstrated the importance of having standard metrics to compare models 417 and qualify their uncertainties [24] [25]. 418 Here we have presented one such metric. Short-term forecasts aid immedi-419 ate decision making and are more actionable than long-term ones (reliability 420 decreases sharply with prediction horizon) [24] [23]. While we focussed on re-421 newal models, the general APE metric of Eq. (9) can select among diverse types 422 of models, facilitating comparative evaluation of their short-term predictive ca-423 pacity and reliability. Its direct use of posterior predictive distributions within 424 an honest, causal framework allows proper and problem-specific inclusion of 425 uncertainty [11]. Common metrics such as the mean absolute error lack this 426 adaptation [24]. Given its information-theoretic links and demonstrated perfor-427 mance we hope that our APE-based method can serve as a rigorous benchmark 428 [9] K. Parag and C. Donnelly, "Adaptive estimation for epidemic renewal and 561 phylogenetic skyline models," BioRxiv, 2019. 